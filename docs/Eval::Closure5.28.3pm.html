<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Eval::Closure(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Eval::Closure(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Eval::Closure(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Eval::Closure - safely and cleanly create closures via string eval
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
version 0.14
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
  use Eval::Closure;

  my $code = eval_closure(
      source      =&gt; 'sub { $foo++ }',
      environment =&gt; {
          '$foo' =&gt; \1,
      },
  );

  warn $code-&gt;(); # 1
  warn $code-&gt;(); # 2

  my $code2 = eval_closure(
      source =&gt; 'sub { $code-&gt;() }',
  ); # dies, $code isn't in scope
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
String eval is often used for dynamic code generation. For instance,
  <span class="Li">&quot;Moose&quot;</span> uses it heavily, to generate inlined
  versions of accessors and constructors, which speeds code up at runtime by a
  significant amount. String eval is not without its issues however - it's
  difficult to control the scope it's used in (which determines which variables
  are in scope inside the eval), and it's easy to miss compilation errors, since
  eval catches them and sticks them in $@ instead.
<p class="Pp">This module attempts to solve these problems. It provides an
    <span class="Li">&quot;eval_closure&quot;</span> function, which evals a
    string in a clean environment, other than a fixed list of specified
    variables. Compilation errors are rethrown automatically.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<section class="Ss">
<h2 class="Ss" id="eval_closure(_args)"><a class="permalink" href="#eval_closure(_args)">eval_closure(%args)</a></h2>
This function provides the main functionality of this module. It is exported by
  default. It takes a hash of parameters, with these keys being valid:
<dl class="Bl-tag">
  <dt>source</dt>
  <dd>The string to be evaled. It should end by returning a code reference. It
      can access any variable declared in the
      <span class="Li">&quot;environment&quot;</span> parameter (and only those
      variables). It can be either a string, or an arrayref of lines (which will
      be joined with newlines to produce the string).</dd>
  <dt>environment</dt>
  <dd>The environment to provide to the eval. This should be a hashref, mapping
      variable names (including sigils) to references of the appropriate type.
      For instance, a valid value for environment would be
      <span class="Li">&quot;{ '@foo' =&gt; [] }&quot;</span> (which would allow
      the generated function to use an array named
      <span class="Li">@foo</span>). Generally, this is used to allow the
      generated function to access externally defined variables (so you would
      pass in a reference to a variable that already exists).
    <p class="Pp">In perl 5.18 and greater, the environment hash can contain
        variables with a sigil of <span class="Li">&quot;&amp;&quot;</span>.
        This will create a lexical sub in the evaluated code (see &quot;The
        'lexical_subs' feature&quot; in feature). Using a
        <span class="Li">&quot;&amp;&quot;</span> sigil on perl versions before
        lexical subs were available will throw an error.</p>
  </dd>
  <dt>alias</dt>
  <dd>If set to true, the coderef returned closes over the variables referenced
      in the environment hashref. (This feature requires Devel::LexAlias.) If
      set to false, the coderef closes over a <i>shallow copy</i> of the
      variables.
    <p class="Pp">If this argument is omitted, Eval::Closure will currently
        assume false, but this assumption may change in a future version.</p>
  </dd>
  <dt>description</dt>
  <dd>This lets you provide a bit more information in backtraces. Normally, when
      a function that was generated through string eval is called, that stack
      frame will show up as &quot;(eval n)&quot;, where 'n' is a sequential
      identifier for every string eval that has happened so far in the program.
      Passing a <span class="Li">&quot;description&quot;</span> parameter lets
      you override that to something more useful (for instance, Moose overrides
      the description for accessors to something like &quot;accessor foo at
      MyClass.pm, line 123&quot;).</dd>
  <dt>line</dt>
  <dd>This lets you override the particular line number that appears in
      backtraces, much like the <span class="Li">&quot;description&quot;</span>
      option. The default is 1.</dd>
  <dt>terse_error</dt>
  <dd>Normally, this function appends the source code that failed to compile,
      and prepends some explanatory text. Setting this option to true suppresses
      that behavior so you get only the compilation error that Perl actually
      reported.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
No known bugs.
<p class="Pp">Please report any bugs to GitHub Issues at
    &lt;https://github.com/doy/eval-closure/issues&gt;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Class::MOP::Method::Accessor
    <p class="Pp">This module is a factoring out of code that used to live
      here</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
You can find this documentation for this module with the perldoc command.
<p class="Pp"><span class="Li"></span></p>
<pre>
    perldoc Eval::Closure
</pre>
<p class="Pp">You can also look for information at:</p>
<ul class="Bl-bullet">
  <li>MetaCPAN
    <p class="Pp">&lt;https://metacpan.org/release/Eval-Closure&gt;</p>
  </li>
  <li>Github
    <p class="Pp">&lt;https://github.com/doy/eval-closure&gt;</p>
  </li>
  <li>RT: CPAN's request tracker
    <p class="Pp">&lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=Eval-Closure&gt;</p>
  </li>
  <li>CPAN Ratings
    <p class="Pp">&lt;http://cpanratings.perl.org/d/Eval-Closure&gt;</p>
  </li>
</ul>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
Based on code from Class::MOP::Method::Accessor, by Stevan Little and the Moose
  Cabal.
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Jesse Luehrs &lt;doy@tozt.net&gt;
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
This software is copyright (c) 2016 by Jesse Luehrs.
<p class="Pp">This is free software; you can redistribute it and/or modify it
    under the same terms as the Perl 5 programming language system itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-05-29</td>
    <td class="foot-os">perl v5.28.2</td>
  </tr>
</table>
</body>
</html>
