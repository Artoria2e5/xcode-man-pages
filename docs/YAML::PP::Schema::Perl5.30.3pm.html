<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>YAML::PP::Schema::Perl(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">YAML::PP::Schema::Perl(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">YAML::PP::Schema::Perl(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
YAML::PP::Schema::Perl - Schema for serializing perl objects and special types
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use YAML::PP;
    # This can be dangerous when loading untrusted YAML!
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ + Perl /] );
    # or
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ Core Perl /] );
    my $yaml = $yp-&gt;dump_string(sub { return 23 });

    # loading code references
    # This is very dangerous when loading untrusted YAML!!
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ + Perl +loadcode /] );
    my $code = $yp-&gt;load_string(&lt;&lt;'EOM');
    --- !perl/code |
        {
            use 5.010;
            my ($name) = @_;
            say &quot;Hello $name!&quot;;
        }
    EOM
    $code-&gt;(&quot;Ingy&quot;);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This schema allows you to load and dump perl objects and special types.
<p class="Pp">Please note that loading objects of arbitrary classes can be
    dangerous in Perl. You have to load the modules yourself, but if an
    exploitable module is loaded and an object is created, its
    <span class="Li">&quot;DESTROY&quot;</span> method will be called when the
    object falls out of scope. File::Temp is an example that can be exploitable
    and might remove arbitrary files.</p>
<p class="Pp">Dumping code references is on by default, but not loading (because
    that is easily exploitable since it's using string
    <span class="Li">&quot;eval&quot;</span>).</p>
<section class="Ss">
<h2 class="Ss" id="Tag_Styles"><a class="permalink" href="#Tag_Styles">Tag
  Styles</a></h2>
You can define the style of tags you want to support:
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $yp_perl_two_one = YAML::PP-&gt;new(
        schema =&gt; [qw/ + Perl tags=!!perl+!perl /],
    );
</pre>
<dl class="Bl-tag">
  <dt>&quot;!perl&quot; (default)</dt>
  <dd>Only <span class="Li">&quot;!perl/type&quot;</span> tags are
    supported.</dd>
  <dt>&quot;!!perl&quot;</dt>
  <dd>Only <span class="Li">&quot;!!perl/type&quot;</span> tags are
    supported.</dd>
  <dt>&quot;!perl+!!perl&quot;</dt>
  <dd>Both <span class="Li">&quot;!perl/type&quot;</span> and
      <span class="Li">&quot;!!perl/tag&quot;</span> are supported when loading.
      When dumping, <span class="Li">&quot;!perl/type&quot;</span> is used.</dd>
  <dt>&quot;!!perl+!perl&quot;</dt>
  <dd>Both <span class="Li">&quot;!perl/type&quot;</span> and
      <span class="Li">&quot;!!perl/tag&quot;</span> are supported when loading.
      When dumping, <span class="Li">&quot;!!perl/type&quot;</span> is
    used.</dd>
</dl>
<p class="Pp">YAML.pm, YAML::Syck and YAML::XS are using
    <span class="Li">&quot;!!perl/type&quot;</span> when dumping.</p>
<p class="Pp">YAML.pm and YAML::Syck are supporting both
    <span class="Li">&quot;!perl/type&quot;</span> and
    <span class="Li">&quot;!!perl/type&quot;</span> when loading. YAML::XS
    currently only supports the latter.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Allow_only_certain_classes"><a class="permalink" href="#Allow_only_certain_classes">Allow
  only certain classes</a></h2>
Since v0.017
<p class="Pp">Blessing arbitrary objects can be dangerous. Maybe you want to
    allow blessing only specific classes and ignore others. For this you have to
    instantiate a Perl Schema object first and use the
    <span class="Li">&quot;classes&quot;</span> option.</p>
<p class="Pp">Currently it only allows a list of strings:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $perl = YAML::PP::Schema::Perl-&gt;new(
        classes =&gt; ['Foo', 'Bar'],
    );
    my $yp = YAML::PP::Perl-&gt;new(
        schema =&gt; [qw/ + /, $perl],
    );
</pre>
<p class="Pp">Allowed classes will be loaded and dumped as usual. The others
    will be ignored.</p>
<p class="Pp">If you want to allow no objects at all, pass an empty array
  ref.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_s-1EXAMPLES_s0"><a class="permalink" href="#_s-1EXAMPLES_s0">EXAMPLES</a></h2>
This is a list of the currently supported types and how they are dumped into
  YAML:
<dl class="Bl-tag">
  <dt>array</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        [
            qw/ one two three four /
        ]


        # YAML
        ---
        - one
        - two
        - three
        - four
    </pre>
  </dd>
  <dt>array_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        bless [
            qw/ one two three four /
        ], &quot;Just::An::Arrayref&quot;


        # YAML
        --- !perl/array:Just::An::Arrayref
        - one
        - two
        - three
        - four
    </pre>
  </dd>
  <dt>circular</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $circle = bless [ 1, 2 ], 'Circle';
        push @$circle, $circle;
        $circle;


        # YAML
        --- &amp;1 !perl/array:Circle
        - 1
        - 2
        - *1
    </pre>
  </dd>
  <dt>coderef</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        sub {
            my (%args) = @_;
            return $args{x} + $args{y};
        }


        # YAML
        --- !perl/code |-
          {
              use warnings;
              use strict;
              (my(%args) = @_);
              (return ($args{'x'} + $args{'y'}));
          }
    </pre>
  </dd>
  <dt>coderef_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        bless sub {
            my (%args) = @_;
            return $args{x} - $args{y};
        }, &quot;I::Am::Code&quot;


        # YAML
        --- !perl/code:I::Am::Code |-
          {
              use warnings;
              use strict;
              (my(%args) = @_);
              (return ($args{'x'} - $args{'y'}));
          }
    </pre>
  </dd>
  <dt>hash</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        {
            U =&gt; 2,
            B =&gt; 52,
        }


        # YAML
        ---
        B: 52
        U: 2
    </pre>
  </dd>
  <dt>hash_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        bless {
            U =&gt; 2,
            B =&gt; 52,
        }, 'A::Very::Exclusive::Class'


        # YAML
        --- !perl/hash:A::Very::Exclusive::Class
        B: 52
        U: 2
    </pre>
  </dd>
  <dt>refref</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $ref = { a =&gt; 'hash' };
        my $refref = \$ref;
        $refref;


        # YAML
        --- !perl/ref
        =:
          a: hash
    </pre>
  </dd>
  <dt>refref_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $ref = { a =&gt; 'hash' };
        my $refref = bless \$ref, 'Foo';
        $refref;


        # YAML
        --- !perl/ref:Foo
        =:
          a: hash
    </pre>
  </dd>
  <dt>regexp</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $string = 'unblessed';
        qr{$string}


        # YAML
        --- !perl/regexp unblessed
    </pre>
  </dd>
  <dt>regexp_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $string = 'blessed';
        bless qr{$string}, &quot;Foo&quot;


        # YAML
        --- !perl/regexp:Foo blessed
    </pre>
  </dd>
  <dt>scalarref</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $scalar = &quot;some string&quot;;
        my $scalarref = \$scalar;
        $scalarref;


        # YAML
        --- !perl/scalar
        =: some string
    </pre>
  </dd>
  <dt>scalarref_blessed</dt>
  <dd><span class="Li"></span>
    <pre>
        # Code
        my $scalar = &quot;some other string&quot;;
        my $scalarref = bless \$scalar, 'Foo';
        $scalarref;


        # YAML
        --- !perl/scalar:Foo
        =: some other string
    </pre>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_s-1METHODS_s0"><a class="permalink" href="#_s-1METHODS_s0">METHODS</a></h2>
<dl class="Bl-tag">
  <dt>new</dt>
  <dd><span class="Li"></span>
    <pre>
    my $perl = YAML::PP::Schema::Perl-&gt;new(
        tags =&gt; &quot;!perl&quot;,
        classes =&gt; ['MyClass'],
        loadcode =&gt; 1,
    );
    </pre>
    <p class="Pp">The constructor recognizes the following options:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>tags</dt>
  <dd>Default: '<span class="Li">&quot;!perl&quot;</span>'
    <p class="Pp">See &quot;Tag Styles&quot;</p>
  </dd>
  <dt>classes</dt>
  <dd>Default: <span class="Li">&quot;undef&quot;</span>
    <p class="Pp">Since: v0.017</p>
    <p class="Pp">Accepts an array ref of class names</p>
  </dd>
  <dt>loadcode</dt>
  <dd>Default: 0</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>register</dt>
  <dd>A class method called by YAML::PP::Schema</dd>
  <dt>construct_ref, represent_ref</dt>
  <dd>Perl variables of the type <span class="Li">&quot;REF&quot;</span> are
      represented in yaml like this:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    --- !perl/ref
    =:
      a: 1
    </pre>
    <p class="Pp"><span class="Li">&quot;construct_ref&quot;</span> returns the
        perl data:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $data = YAML::PP::Schema::Perl-&gt;construct_ref([ '=', { some =&gt; 'data' } );
    my $data = \{ a =&gt; 1 };
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_ref&quot;</span> turns a
        <span class="Li">&quot;REF&quot;</span> variable into a YAML
      mapping:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $data = YAML::PP::Schema::Perl-&gt;represent_ref(\{ a =&gt; 1 });
    my $data = { '=' =&gt; { a =&gt; 1 } };
    </pre>
  </dd>
  <dt>construct_scalar, represent_scalar</dt>
  <dd>Perl variables of the type <span class="Li">&quot;SCALAR&quot;</span> are
      represented in yaml like this:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    --- !perl/scalar
    =: string
    </pre>
    <p class="Pp"><span class="Li">&quot;construct_scalar&quot;</span> returns
        the perl data:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $data = YAML::PP::Schema::Perl-&gt;construct_ref([ '=', 'string' );
    my $data = \'string';
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_scalar&quot;</span> turns a
        <span class="Li">&quot;SCALAR&quot;</span> variable into a YAML
      mapping:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $data = YAML::PP::Schema::Perl-&gt;represent_scalar(\'string');
    my $data = { '=' =&gt; 'string' };
    </pre>
  </dd>
  <dt>construct_regex, represent_regex</dt>
  <dd><span class="Li">&quot;construct_regex&quot;</span> returns a
      <span class="Li">&quot;qr{}&quot;</span> object from the YAML string:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $qr = YAML::PP::Schema::Perl-&gt;construct_regex('foo.*');
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_regex&quot;</span> returns a
        string representing the regex object:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $string = YAML::PP::Schema::Perl-&gt;represent_regex(qr{...});
    </pre>
  </dd>
  <dt>evaluate_code, represent_code</dt>
  <dd><span class="Li">&quot;evaluate_code&quot;</span> returns a code reference
      from a string. The string must start with a
      <span class="Li">&quot;{&quot;</span> and end with a
      <span class="Li">&quot;}&quot;</span>.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $code = YAML::PP::Schema::Perl-&gt;evaluate_code('{ return 23 }');
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_code&quot;</span> returns a
        string representation of the code reference with the help of
      B::Deparse:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $string = YAML::PP::Schema::Perl-&gt;represent_code(sub { return 23 });
    </pre>
  </dd>
  <dt>construct_glob, represent_glob</dt>
  <dd><span class="Li">&quot;construct_glob&quot;</span> returns a glob from a
      hash.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $glob = YAML::PP::Schema::Perl-&gt;construct_glob($hash);
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_glob&quot;</span> returns a
        hash representation of the glob.</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $hash = YAML::PP::Schema::Perl-&gt;represent_glob($glob);
    </pre>
  </dd>
  <dt>object</dt>
  <dd>Does the same as <span class="Li">&quot;bless&quot;</span>:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    my $object = YAML::PP::Schema::Perl-&gt;object($data, $class);
    </pre>
  </dd>
</dl>
</section>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-09-10</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
