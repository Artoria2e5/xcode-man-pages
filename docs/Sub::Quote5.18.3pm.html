<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Sub::Quote(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Sub::Quote(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Sub::Quote(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Sub::Quote - efficient generation of subroutines via string eval
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
 package Silly;

 use Sub::Quote qw(quote_sub unquote_sub quoted_from_sub);

 quote_sub 'Silly::kitty', q{ print &quot;meow&quot; };

 quote_sub 'Silly::doggy', q{ print &quot;woof&quot; };

 my $sound = 0;

 quote_sub 'Silly::dagron',
   q{ print ++$sound % 2 ? 'burninate' : 'roar' },
   { '$sound' =&gt; \$sound };
</pre>
<p class="Pp">And elsewhere:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
 Silly-&gt;kitty;  # meow
 Silly-&gt;doggy;  # woof
 Silly-&gt;dagron; # burninate
 Silly-&gt;dagron; # roar
 Silly-&gt;dagron; # burninate
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This package provides performant ways to generate subroutines from strings.
</section>
<section class="Sh">
<h1 class="Sh" id="SUBROUTINES"><a class="permalink" href="#SUBROUTINES">SUBROUTINES</a></h1>
<section class="Ss">
<h2 class="Ss" id="quote_sub"><a class="permalink" href="#quote_sub">quote_sub</a></h2>
<span class="Li"></span>
<pre>
 my $coderef = quote_sub 'Foo::bar', q{ print $x++ . &quot;\n&quot; }, { '$x' =&gt; \0 };
</pre>
<p class="Pp">Arguments: ?$name, <span class="Li">$code</span>, ?\%captures,
    ?\%options</p>
<p class="Pp"><span class="Li">$name</span> is the subroutine where the coderef
    will be installed.</p>
<p class="Pp"><span class="Li">$code</span> is a string that will be turned into
    code.</p>
<p class="Pp"><span class="Li">&quot;\%captures&quot;</span> is a hashref of
    variables that will be made available to the code. The keys should be the
    full name of the variable to be made available, including the sigil. The
    values should be references to the values. The variables will contain copies
    of the values. See the &quot;SYNOPSIS&quot;'s
    <span class="Li">&quot;Silly::dagron&quot;</span> for an example using
    captures.</p>
<p class="Pp"><i>options</i></p>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>no_install
    <p class="Pp"><b>Boolean</b>. Set this option to not install the generated
        coderef into the passed subroutine name on undefer.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="unquote_sub"><a class="permalink" href="#unquote_sub">unquote_sub</a></h2>
<span class="Li"></span>
<pre>
 my $coderef = unquote_sub $sub;
</pre>
<p class="Pp">Forcibly replace subroutine with actual code.</p>
<p class="Pp">If <span class="Li">$sub</span> is not a quoted sub, this is a
    no-op.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="quoted_from_sub"><a class="permalink" href="#quoted_from_sub">quoted_from_sub</a></h2>
<span class="Li"></span>
<pre>
 my $data = quoted_from_sub $sub;

 my ($name, $code, $captures, $compiled_sub) = @$data;
</pre>
<p class="Pp">Returns original arguments to quote_sub, plus the compiled version
    if this sub has already been unquoted.</p>
<p class="Pp">Note that <span class="Li">$sub</span> can be either the original
    quoted version or the compiled version for convenience.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="inlinify"><a class="permalink" href="#inlinify">inlinify</a></h2>
<span class="Li"></span>
<pre>
 my $prelude = capture_unroll '$captures', {
   '$x' =&gt; 1,
   '$y' =&gt; 2,
 };

 my $inlined_code = inlinify q{
   my ($x, $y) = @_;

   print $x + $y . &quot;\n&quot;;
 }, '$x, $y', $prelude;
</pre>
<p class="Pp">Takes a string of code, a string of arguments, a string of code
    which acts as a &quot;prelude&quot;, and a <b>Boolean</b> representing
    whether or not to localize the arguments.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="capture_unroll"><a class="permalink" href="#capture_unroll">capture_unroll</a></h2>
<span class="Li"></span>
<pre>
 my $prelude = capture_unroll '$captures', {
   '$x' =&gt; 1,
   '$y' =&gt; 2,
 }, 4;
</pre>
<p class="Pp">Arguments: <span class="Li">$from</span>, \%captures,
    <span class="Li">$indent</span></p>
<p class="Pp">Generates a snippet of code which is suitable to be used as a
    prelude for &quot;inlinify&quot;. <span class="Li">$from</span> is a string
    will be used as a hashref in the resulting code. The keys of
    <span class="Li">%captures</span> are the names of the variables and the
    values are ignored. <span class="Li">$indent</span> is the number of spaces
    to indent the result by.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
Much of this is just string-based code-generation, and as a result, a few
  caveats apply.
<section class="Ss">
<h2 class="Ss" id="return"><a class="permalink" href="#return">return</a></h2>
Calling <span class="Li">&quot;return&quot;</span> from a quote_sub'ed sub will
  not likely do what you intend. Instead of returning from the code you defined
  in <span class="Li">&quot;quote_sub&quot;</span>, it will return from the
  overall function it is composited into.
<p class="Pp">So when you pass in:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
   quote_sub q{  return 1 if $condition; $morecode }
</pre>
<p class="Pp">It might turn up in the intended context as follows:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  sub foo {

    &lt;important code a&gt;
    do {
      return 1 if $condition;
      $morecode
    };
    &lt;important code b&gt;

  }
</pre>
<p class="Pp">Which will obviously return from foo, when all you meant to do was
    return from the code context in quote_sub and proceed with running important
    code b.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="pragmas"><a class="permalink" href="#pragmas">pragmas</a></h2>
<span class="Li">&quot;Sub::Quote&quot;</span> preserves the environment of the
  code creating the quoted subs. This includes the package, strict, warnings,
  and any other lexical pragmas. This is done by prefixing the code with a block
  that sets up a matching environment. When inlining
  <span class="Li">&quot;Sub::Quote&quot;</span> subs, care should be taken that
  user pragmas won't effect the rest of the code.
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
See Moo for support and contact information.
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
See Moo for authors.
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
See Moo for the copyright and license.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-12-31</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
