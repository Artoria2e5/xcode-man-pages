<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>CPAN::Mirrors(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CPAN::Mirrors(3pm)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">CPAN::Mirrors(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
CPAN::Mirrors - Get CPAN mirror information and select a fast one
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use CPAN::Mirrors;

    my $mirrors = CPAN::Mirrors-&gt;new( $mirrored_by_file );

    my $seen = {};

    my $best_continent = $mirrors-&gt;find_best_continents( { seen =&gt; $seen } );
    my @mirrors        = $mirrors-&gt;get_mirrors_by_continents( $best_continent );

    my $callback = sub {
        my( $m ) = @_;
        printf &quot;%s = %s\n&quot;, $m-&gt;hostname, $m-&gt;rtt
        };
    $mirrors-&gt;get_mirrors_timings( \@mirrors, $seen, $callback );

    @mirrors = sort { $a-&gt;rtt &lt;=&gt; $b-&gt;rtt } @mirrors;

    print &quot;Best mirrors are &quot;, map( { $_-&gt;rtt } @mirrors[0..3] ), &quot;\n&quot;;
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<dl class="Bl-tag">
  <dt>new( LOCAL_FILE_NAME )</dt>
  <dd>Create a new CPAN::Mirrors object from LOCAL_FILE_NAME. This file should
      look like that in http://www.cpan.org/MIRRORED.BY .</dd>
  <dt><b>continents()</b></dt>
  <dd>Return a list of continents based on those defined in
    <i>MIRRORED.BY</i>.</dd>
  <dt>countries( [CONTINENTS] )</dt>
  <dd>Return a list of countries based on those defined in <i>MIRRORED.BY</i>.
      It only returns countries for the continents you specify (as defined in
      <span class="Li">&quot;continents&quot;</span>). If you don't specify any
      continents, it returns all of the countries listed in
    <i>MIRRORED.BY</i>.</dd>
  <dt>mirrors( [COUNTRIES] )</dt>
  <dd>Return a list of mirrors based on those defined in <i>MIRRORED.BY</i>. It
      only returns mirrors for the countries you specify (as defined in
      <span class="Li">&quot;countries&quot;</span>). If you don't specify any
      countries, it returns all of the mirrors listed in
    <i>MIRRORED.BY</i>.</dd>
  <dt>get_mirrors_by_countries( [COUNTRIES] )</dt>
  <dd>A more sensible synonym for mirrors.</dd>
  <dt>get_mirrors_by_continents( [CONTINENTS] )</dt>
  <dd>Return a list of mirrors for all of continents you specify. If you don't
      specify any continents, it returns all of the mirrors.
    <p class="Pp">You can specify a single continent or an array reference of
        continents.</p>
  </dd>
  <dt>get_countries_by_continents( [CONTINENTS] )</dt>
  <dd>A more sensible synonym for countries.</dd>
  <dt>default_mirror</dt>
  <dd>Returns the default mirror, http://www.cpan.org/ . This mirror uses
      dynamic DNS to give a close mirror.</dd>
  <dt>best_mirrors</dt>
  <dd><span class="Li">&quot;best_mirrors&quot;</span> checks for the best
      mirrors based on the list of continents you pass, or, without that, all
      continents, as defined by
      <span class="Li">&quot;CPAN::Mirrored::By&quot;</span>. It pings each
      mirror, up to the value of <span class="Li">&quot;how_many&quot;</span>.
      In list context, it returns up to
      <span class="Li">&quot;how_many&quot;</span> mirror. In scalar context, it
      returns the single best mirror.
    <p class="Pp">Arguments</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    how_many   - the number of mirrors to return. Default: 1
    callback   - a callback for find_best_continents
    verbose    - true or false on all the whining and moaning. Default: false
    continents - an array ref of the continents to check
    </pre>
    <p class="Pp">If you don't specify the continents,
        <span class="Li">&quot;best_mirrors&quot;</span> calls
        <span class="Li">&quot;find_best_continents&quot;</span> to get the list
        of continents to check.</p>
    <p class="Pp">If you don't have Net::Ping v2.13 or later, needed for
        timings, this returns the default mirror.</p>
  </dd>
  <dt>get_n_random_mirrors_by_continents( N, [CONTINENTS] )</dt>
  <dd>Returns up to N random mirrors for the specified continents. Specify the
      continents as an array reference.</dd>
  <dt>get_mirrors_timings( MIRROR_LIST, SEEN, CALLBACK );</dt>
  <dd>Pings the listed mirrors and returns a list of mirrors sorted in ascending
      ping times.
    <p class="Pp"><span class="Li">&quot;MIRROR_LIST&quot;</span> is an
        anonymous array of
        <span class="Li">&quot;CPAN::Mirrored::By&quot;</span> objects to
      ping.</p>
    <p class="Pp">The optional argument <span class="Li">&quot;SEEN&quot;</span>
        is a hash reference used to track the mirrors you've already pinged.</p>
    <p class="Pp">The optional argument
        <span class="Li">&quot;CALLBACK&quot;</span> is a subroutine reference
        to call after each ping. It gets the
        <span class="Li">&quot;CPAN::Mirrored::By&quot;</span> object after each
        ping.</p>
  </dd>
  <dt>find_best_continents( HASH_REF );</dt>
  <dd><span class="Li">&quot;find_best_continents&quot;</span> goes through each
      continent and pings <span class="Li">&quot;N&quot;</span> random mirrors
      on that continent. It then orders the continents by ascending median ping
      time. In list context, it returns the ordered list of continent. In scalar
      context, it returns the same list as an anonymous array.
    <p class="Pp">Arguments:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    n        - the number of hosts to ping for each continent. Default: 3
    seen     - a hashref of cached hostname ping times
    verbose  - true or false for noisy or quiet. Default: false
    callback - a subroutine to run after each ping.
    ping_cache_limit - how long, in seconds, to reuse previous ping times.
        Default: 1 day
    </pre>
    <p class="Pp">The <span class="Li">&quot;seen&quot;</span> hash has
        hostnames as keys and anonymous arrays as values. The anonymous array is
        a triplet of a <span class="Li">&quot;CPAN::Mirrored::By&quot;</span>
        object, a ping time, and the epoch time for the measurement.</p>
    <p class="Pp">The callback subroutine gets the
        <span class="Li">&quot;CPAN::Mirrored::By&quot;</span> object, the ping
        time, and measurement time (the same things in the
        <span class="Li">&quot;seen&quot;</span> hashref) as arguments.
        <span class="Li">&quot;find_best_continents&quot;</span> doesn't care
        what the callback does and ignores the return value.</p>
    <p class="Pp">With a low value for <span class="Li">&quot;N&quot;</span>, a
        single mirror might skew the results enough to choose a worse continent.
        If you have that problem, try a larger value.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Andreas Koenig <span class="Li">&quot;&lt;andk@cpan.org&gt;&quot;</span>, David
  Golden <span class="Li">&quot;&lt;dagolden@cpan.org&gt;&quot;</span>, brian d
  foy <span class="Li">&quot;&lt;bdfoy@cpan.org&gt;&quot;</span>
</section>
<section class="Sh">
<h1 class="Sh" id="LICENSE"><a class="permalink" href="#LICENSE">LICENSE</a></h1>
This program is free software; you can redistribute it and/or modify it under
  the same terms as Perl itself.
<p class="Pp">See &lt;http://www.perl.com/perl/misc/Artistic.html&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2018-11-01</td>
    <td class="foot-os">perl v5.28.2</td>
  </tr>
</table>
</body>
</html>
