<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Generated from file '/System/Volumes/Data/SWE/macOS/BuildRoots/0ed32b12e4/Library/Caches/com.apple.xbs/Sources/tcl/tcl-134/tcl_ext/tcllib/tcllib/modules/ncgi/ncgi.man' by tcllib/doctools with format 'nroff'
  
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
  	# Start an argument description
  .b
  	# define tabbing values for .AP
  
  	# BS - start boxed text
  	# ^y = starting y location
  	# ^b = 1
  	# BE - end boxed text (draw box now)
  	Draw four-sided box normally, but don't draw top of
  	box if the box started on an earlier page.
  	# VS - start vertical sidebar
  	# ^Y = starting y location
  	# ^v = 1 (for troff;  for nroff this doesn't matter)
  	# VE - end of vertical sidebar
  	# Special macro to handle page bottom:  finish off current
  	# box/sidebar if in box/sidebar mode, then invoked standard
  	# page bottom macro.
  	Draw three-sided box if this is the box's first page,
  	draw two sides but no top otherwise.
  	# DS - begin display
  	# DE - end display
  	# SO - start of list of standard options
  	# SE - end of list of standard options
  	# OP - start of full description for a single option
  	# CS - begin code excerpt
  	# CE - end code excerpt
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>ncgi(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ncgi(n)</td>
    <td class="head-vol">CGI Support</td>
    <td class="head-rtitle">ncgi(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>

</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
ncgi - Procedures to manipulate CGI values.
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
package require <b>Tcl 8.2</b>
<p class="Pp">package require <b>ncgi ?1.3?</b></p>
<p class="Pp"><b>::ncgi::cookie</b> <i>cookie</i></p>
<p class="Pp"><b>::ncgi::decode</b> <i>str</i></p>
<p class="Pp"><b>::ncgi::empty</b> <i>name</i></p>
<p class="Pp"><b>::ncgi::exists</b> <i>name</i></p>
<p class="Pp"><b>::ncgi::encode</b> <i>string</i></p>
<p class="Pp"><b>::ncgi::header</b> ?<i>type</i>? <i>args</i></p>
<p class="Pp"><b>::ncgi::import</b> <i>cginame</i> ?<i>tclname</i>?</p>
<p class="Pp"><b>::ncgi::importAll</b> <i>args</i></p>
<p class="Pp"><b>::ncgi::importFile</b> <i>cmd</i> <i>cginame</i>
    ?<i>filename</i>?</p>
<p class="Pp"><b>::ncgi::input</b> ?<i>fakeinput</i>? ?<i>fakecookie</i>?</p>
<p class="Pp"><b>::ncgi::multipart</b> <i>type query</i></p>
<p class="Pp"><b>::ncgi::nvlist</b></p>
<p class="Pp"><b>::ncgi::names</b></p>
<p class="Pp"><b>::ncgi::parse</b></p>
<p class="Pp"><b>::ncgi::parseMimeValue</b> <i>value</i></p>
<p class="Pp"><b>::ncgi::query</b></p>
<p class="Pp"><b>::ncgi::redirect</b> <i>url</i></p>
<p class="Pp"><b>::ncgi::reset</b> <i>query type</i></p>
<p class="Pp"><b>::ncgi::setCookie</b> <i>args</i></p>
<p class="Pp"><b>::ncgi::setDefaultValue</b> <i>key defvalue</i></p>
<p class="Pp"><b>::ncgi::setDefaultValueList</b> <i>key defvaluelist</i></p>
<p class="Pp"><b>::ncgi::setValue</b> <i>key value</i></p>
<p class="Pp"><b>::ncgi::setValueList</b> <i>key valuelist</i></p>
<p class="Pp"><b>::ncgi::type</b></p>
<p class="Pp"><b>::ncgi::urlStub</b> ?<i>url</i>?</p>
<p class="Pp"><b>::ncgi::value</b> <i>key</i> ?<i>default</i>?</p>
<p class="Pp"><b>::ncgi::valueList</b> <i>key</i> ?<i>default</i>?</p>
<p class="Pp"></p>
<pre>

</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>ncgi</b> package provides commands that manipulate CGI values. These are
  values that come from Web forms and are processed either by CGI scripts or web
  pages with embedded Tcl code. Use the <b>ncgi</b> package to query these
  values, set and get cookies, and encode and decode www-url-encoded values.
<p class="Pp">In the simplest case, a CGI script first calls
    <b>::ncgi::parse</b> and then calls <b>::ncgi::value</b> to get different
    form values. If a CGI value is repeated, you should use
    <b>::ncgi::valueList</b> to get back the complete list of values.</p>
<p class="Pp">An alternative to <b>::ncgi::parse</b> is <b>::ncgi::input</b>,
    which has semantics similar to Don Libes' <b>cgi_input</b> procedure.
    <b>::ncgi::input</b> restricts repeated CGI values to have names that end
    with &quot;List&quot;. In this case, <b>::ncgi::value</b> will return the
    complete list of values, and <b>::ncgi::input</b> will raise errors if it
    find repeated form elements without the right name.</p>
<p class="Pp">The <b>::ncgi::reset</b> procedure can be used in test suites and
    Web servers to initialize the source of the CGI values. Otherwise the values
    are read in from the CGI environment.</p>
<p class="Pp">The complete set of procedures is described below.</p>
<dl class="Bl-tag">
  <dt><b>::ncgi::cookie</b> <i>cookie</i></dt>
  <dd>Return a list of values for <i>cookie</i>, if any. It is possible that
      more than one cookie with the same name can be present, so this procedure
      returns a list.</dd>
  <dt><b>::ncgi::decode</b> <i>str</i></dt>
  <dd>Decode strings in www-url-encoding, which represents special characters
      with a %xx sequence, where xx is the character code in hex.</dd>
  <dt><b>::ncgi::empty</b> <i>name</i></dt>
  <dd>Returns 1 if the CGI variable <i>name</i> is not present or has the empty
      string as its value.</dd>
  <dt><b>::ncgi::exists</b> <i>name</i></dt>
  <dd>The return value is a boolean. It returns <b>0</b> if the CGI variable
      <i>name</i> is not present, and <b>1</b> otherwise.</dd>
  <dt><b>::ncgi::encode</b> <i>string</i></dt>
  <dd>Encode <i>string</i> into www-url-encoded format.</dd>
  <dt><b>::ncgi::header</b> ?<i>type</i>? <i>args</i></dt>
  <dd>Output the CGI header to standard output. This emits a Content-Type:
      header and additional headers based on <i>args</i>, which is a list of
      header names and header values. The <i>type</i> defaults to
      &quot;text/html&quot;.</dd>
  <dt><b>::ncgi::import</b> <i>cginame</i> ?<i>tclname</i>?</dt>
  <dd>This creates a variable in the current scope with the value of the CGI
      variable <i>cginame</i>. The name of the variable is <i>tclname</i>, or
      <i>cginame</i> if <i>tclname</i> is empty (default).</dd>
  <dt><b>::ncgi::importAll</b> <i>args</i></dt>
  <dd>This imports several CGI variables as Tcl variables. If <i>args</i> is
      empty, then every CGI value is imported. Otherwise each CGI variable
      listed in <i>args</i> is imported.</dd>
  <dt><b>::ncgi::importFile</b> <i>cmd</i> <i>cginame</i> ?<i>filename</i>?</dt>
  <dd>This provides information about an uploaded file from a form input field
      of type <b>file</b> with name <i>cginame</i>. <i>cmd</i> can be one of
      <b>-server</b> <b>-client</b>, <b>-type</b> or <b>-data</b>.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>-client</b> <i>cginame</i></dt>
  <dd>returns the filename as sent by the client.</dd>
  <dt><b>-type</b> <i>cginame</i></dt>
  <dd>returns the mime type of the uploaded file.</dd>
  <dt><b>-data</b> <i>cginame</i></dt>
  <dd>returns the contents of the file.</dd>
  <dt><b>-server</b> <i>cginame</i> <i>filename</i></dt>
  <dd>writes the file contents to a local temporary file (or <i>filename</i> if
      supplied) and returns the name of the file. The caller is responsible for
      deleting this file after use.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt><b>::ncgi::input</b> ?<i>fakeinput</i>? ?<i>fakecookie</i>?</dt>
  <dd>This reads and decodes the CGI values from the environment. It restricts
      repeated form values to have a trailing &quot;List&quot; in their name.
      The CGI values are obtained later with the <b>::ncgi::value</b>
    procedure.</dd>
  <dt><b>::ncgi::multipart</b> <i>type query</i></dt>
  <dd>This procedure parses a multipart/form-data <i>query</i>. This is used by
      <b>::ncgi::nvlist</b> and not normally called directly. It returns an
      alternating list of names and structured values. Each structure value is
      in turn a list of two elements. The first element is meta-data from the
      multipart/form-data structure. The second element is the form value. If
      you use <b>::ncgi::value</b> you just get the form value. If you use
      <b>::ncgi::valueList</b> you get the structured value with meta data and
      the value.
    <p class="Pp">The <i>type</i> is the whole Content-Type, including the
        parameters like <i>boundary</i>. This returns a list of names and values
        that describe the multipart data. The values are a nested list structure
        that has some descriptive information first, and the actual form value
        second. The descriptive information is list of header names and values
        that describe the content.</p>
  </dd>
  <dt><b>::ncgi::nvlist</b></dt>
  <dd>This returns all the query data as a name, value list. In the case of
      multipart/form-data, the values are structured as described in
      <b>::ncgi::multipart</b>.</dd>
  <dt><b>::ncgi::names</b></dt>
  <dd>This returns all names found in the query data, as a list.
      <b>::ncgi::multipart</b>.</dd>
  <dt><b>::ncgi::parse</b></dt>
  <dd>This reads and decodes the CGI values from the environment. The CGI values
      are obtained later with the <b>::ncgi::value</b> procedure. IF a CGI value
      is repeated, then you should use <b>::ncgi::valueList</b> to get the
      complete list of values.</dd>
  <dt><b>::ncgi::parseMimeValue</b> <i>value</i></dt>
  <dd>This decodes the Content-Type and other MIME headers that have the form of
      &quot;primary value; param=val; p2=v2&quot; It returns a list, where the
      first element is the primary value, and the second element is a list of
      parameter names and values.</dd>
  <dt><b>::ncgi::query</b></dt>
  <dd>This returns the raw query data.</dd>
  <dt><b>::ncgi::redirect</b> <i>url</i></dt>
  <dd>Generate a response that causes a 302 redirect by the Web server. The
      <i>url</i> is the new URL that is the target of the redirect. The URL will
      be qualified with the current server and current directory, if necessary,
      to convert it into a full URL.</dd>
  <dt><b>::ncgi::reset</b> <i>query type</i></dt>
  <dd>Set the query data and Content-Type for the current CGI session. This is
      used by the test suite and by Web servers to initialize the ncgi module so
      it does not try to read standard input or use environment variables to get
      its data. If neither <i>query</i> or <i>type</i> are specified, then the
      <b>ncgi</b> module will look in the standard CGI environment for its
    data.</dd>
  <dt><b>::ncgi::setCookie</b> <i>args</i></dt>
  <dd>Set a cookie value that will be returned as part of the reply. This must
      be done before <b>::ncgi::header</b> or <b>::ncgi::redirect</b> is called
      in order for the cookie to be returned properly. The <i>args</i> are a set
      of flags and values:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>-name</b> <i>name</i></dt>
  <dd></dd>
  <dt><b>-value</b> <i>value</i></dt>
  <dd></dd>
  <dt><b>-expires</b> <i>date</i></dt>
  <dd></dd>
  <dt><b>-path</b> <i>path restriction</i></dt>
  <dd></dd>
  <dt><b>-domain</b> <i>domain restriction</i></dt>
  <dd></dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt><b>::ncgi::setDefaultValue</b> <i>key defvalue</i></dt>
  <dd>Set a CGI value if it does not already exists. This affects future calls
      to <b>::ncgi::value</b> (but not future calls to <b>::ncgi::nvlist</b>).
      If the CGI value already is present, then this procedure has no side
      effects.</dd>
  <dt><b>::ncgi::setDefaultValueList</b> <i>key defvaluelist</i></dt>
  <dd>Like <b>::ncgi::setDefaultValue</b> except that the value already has list
      structure to represent multiple checkboxes or a multi-selection.</dd>
  <dt><b>::ncgi::setValue</b> <i>key value</i></dt>
  <dd>Set a CGI value, overriding whatever was present in the CGI environment
      already. This affects future calls to <b>::ncgi::value</b> (but not future
      calls to <b>::ncgi::nvlist</b>).</dd>
  <dt><b>::ncgi::setValueList</b> <i>key valuelist</i></dt>
  <dd>Like <b>::ncgi::setValue</b> except that the value already has list
      structure to represent multiple checkboxes or a multi-selection.</dd>
  <dt><b>::ncgi::type</b></dt>
  <dd>Returns the Content-Type of the current CGI values.</dd>
  <dt><b>::ncgi::urlStub</b> ?<i>url</i>?</dt>
  <dd>Returns the current URL, but without the protocol, server, and port. If
      <i>url</i> is specified, then it defines the URL for the current session.
      That value will be returned by future calls to <b>::ncgi::urlStub</b></dd>
  <dt><b>::ncgi::value</b> <i>key</i> ?<i>default</i>?</dt>
  <dd>Return the CGI value identified by <i>key</i>. If the CGI value is not
      present, then the <i>default</i> value is returned instead. This value
      defaults to the empty string.
    <p class="Pp">If the form value <i>key</i> is repeated, then there are two
        cases: if <b>::ncgi::parse</b> was called, then <b>::ncgi::value</b>
        only returns the first value associated with <i>key</i>. If
        <b>::ncgi::input</b> was called, then <b>::ncgi::value</b> returns a Tcl
        list value and <i>key</i> must end in &quot;List&quot; (e.g.,
        &quot;skuList&quot;). In the case of multipart/form-data, this procedure
        just returns the value of the form element. If you want the meta-data
        associated with each form value, then use <b>::ncgi::valueList</b>.</p>
  </dd>
  <dt><b>::ncgi::valueList</b> <i>key</i> ?<i>default</i>?</dt>
  <dd>Like <b>::ncgi::value</b>, but this always returns a list of values (even
      if there is only one value). In the case of multipart/form-data, this
      procedure returns a list of two elements. The first element is meta-data
      in the form of a parameter, value list. The second element is the form
      value.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
Uploading a file
<pre>
HTML:
&lt;html&gt;
&lt;form action=&quot;/cgi-bin/upload.cgi&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
Path: &lt;input type=&quot;file&quot; name=&quot;filedata&quot;&gt;&lt;br&gt;
Name: &lt;input type=&quot;text&quot; name=&quot;filedesc&quot;&gt;&lt;br&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
&lt;/html&gt;
TCL: upload.cgi
#!/usr/local/bin/tclsh
::ncgi::parse
set filedata [::ncgi::value filedata]
set filedesc [::ncgi::value filedesc]
puts &quot;&lt;html&gt; File uploaded at &lt;a href=\&quot;/images/$filedesc\&quot;&gt;$filedesc&lt;/a&gt; &lt;/html&gt;&quot;
set filename /www/images/$filedesc
set fh [open $filename w]
puts -nonewline $fh $filedata
close $fh
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
This document, and the package it describes, will undoubtedly contain bugs and
  other problems. Please report such in the category <i>ncgi</i> of the
  <i>Tcllib SF Trackers</i> [http://sourceforge.net/tracker/?group_id=12883].
  Please also report any ideas for enhancements you may have for either package
  and/or documentation.
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
html
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
CGI, cookie, form, html
</section>
<section class="Sh">
<h1 class="Sh" id="CATEGORY"><a class="permalink" href="#CATEGORY">CATEGORY</a></h1>
CGI programming
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1.3</td>
    <td class="foot-os">ncgi</td>
  </tr>
</table>
</body>
</html>
