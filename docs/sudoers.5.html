<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   DO NOT EDIT THIS FILE, IT IS NOT THE MASTER!
   IT IS GENERATED AUTOMATICALLY FROM sudoers.mdoc.in
  
   Copyright (c) 1994-1996, 1998-2005, 2007-2016
  	Todd C. Miller <Todd.Miller@courtesan.com>
  
   Permission to use, copy, modify, and distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.
  
   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
   ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  
   Sponsored in part by the Defense Advanced Research Projects
   Agency (DARPA) and Air Force Research Laboratory, Air Force
   Materiel Command, USAF, under agreement number F39502-99-1-0512.
   -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>SUDOERS(5)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SUDOERS(5)</td>
    <td class="head-vol">File Formats Manual</td>
    <td class="head-rtitle">SUDOERS(5)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<b>sudoers</b> - default sudo security policy plugin
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>sudoers</b> policy plugin determines a user's <b>sudo</b> privileges. It
  is the default <b>sudo</b> policy plugin. The policy is driven by the
  <i>/private/etc/sudoers</i> file or, optionally in LDAP. The policy format is
  described in detail in the <i>SUDOERS FILE FORMAT</i> section. For information
  on storing <b>sudoers</b> policy information in LDAP, please see
  sudoers.ldap(5).
<section class="Ss">
<h2 class="Ss" id="Configuring_sudo.conf_for_sudoers"><a class="permalink" href="#Configuring_sudo.conf_for_sudoers">Configuring
  sudo.conf for sudoers</a></h2>
<b>sudo</b> consults the sudo.conf(5) file to determine which policy and and I/O
  logging plugins to load. If no sudo.conf(5) file is present, or if it contains
  no Plugin lines, <b>sudoers</b> will be used for policy decisions and I/O
  logging. To explicitly configure sudo.conf(5) to use the <b>sudoers</b>
  plugin, the following configuration can be used.
<pre>

</pre>
<div class="Bd-indent">
<pre>
Plugin sudoers_policy sudoers.so
Plugin sudoers_io sudoers.so
</pre>
</div>
<pre>
</pre>
<p class="Pp">Starting with <b>sudo</b> 1.8.5, it is possible to specify
    optional arguments to the <b>sudoers</b> plugin in the sudo.conf(5) file.
    These arguments, if present, should be listed after the path to the plugin
    (i.e. after <i>sudoers.so</i>). Multiple arguments may be specified,
    separated by white space. For example:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Plugin sudoers_policy sudoers.so sudoers_mode=0400
</pre>
</div>
<pre>
</pre>
<p class="Pp">The following plugin arguments are supported:</p>
<dl class="Bl-tag">
  <dt>ldap_conf=pathname</dt>
  <dd>The <i>ldap_conf</i> argument can be used to override the default path to
      the <i>ldap.conf</i> file.</dd>
  <dt>ldap_secret=pathname</dt>
  <dd>The <i>ldap_secret</i> argument can be used to override the default path
      to the <i>ldap.secret</i> file.</dd>
  <dt>sudoers_file=pathname</dt>
  <dd>The <i>sudoers_file</i> argument can be used to override the default path
      to the <i>sudoers</i> file.</dd>
  <dt>sudoers_uid=uid</dt>
  <dd>The <i>sudoers_uid</i> argument can be used to override the default owner
      of the sudoers file. It should be specified as a numeric user ID.</dd>
  <dt>sudoers_gid=gid</dt>
  <dd>The <i>sudoers_gid</i> argument can be used to override the default group
      of the sudoers file. It must be specified as a numeric group ID (not a
      group name).</dd>
  <dt>sudoers_mode=mode</dt>
  <dd>The <i>sudoers_mode</i> argument can be used to override the default file
      mode for the sudoers file. It should be specified as an octal value.</dd>
</dl>
<p class="Pp">For more information on configuring sudo.conf(5), please refer to
    its manual.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User_Authentication"><a class="permalink" href="#User_Authentication">User
  Authentication</a></h2>
The <b>sudoers</b> security policy requires that most users authenticate
  themselves before they can use <b>sudo</b>. A password is not required if the
  invoking user is root, if the target user is the same as the invoking user, or
  if the policy has disabled authentication for the user or command. Unlike
  su(1), when <b>sudoers</b> requires authentication, it validates the invoking
  user's credentials, not the target user's (or root's) credentials. This can be
  changed via the <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags,
  described later.
<p class="Pp">If a user who is not listed in the policy tries to run a command
    via <b>sudo</b>, mail is sent to the proper authorities. The address used
    for such mail is configurable via the <i>mailto</i> Defaults entry
    (described later) and defaults to root.</p>
<p class="Pp">Note that no mail will be sent if an unauthorized user tries to
    run <b>sudo</b> with the <b>-l</b> or <b>-v</b> option unless there is an
    authentication error and either the <i>mail_always</i> or
    <i>mail_badpass</i> flags are enabled. This allows users to determine for
    themselves whether or not they are allowed to use <b>sudo</b>. All attempts
    to run <b>sudo</b> (successful or not) will be logged, regardless of whether
    or not mail is sent.</p>
<p class="Pp">If <b>sudo</b> is run by root and the SUDO_USER environment
    variable is set, the <b>sudoers</b> policy will use this value to determine
    who the actual user is. This can be used by a user to log commands through
    sudo even when a root shell has been invoked. It also allows the <b>-e</b>
    option to remain useful even when invoked via a sudo-run script or program.
    Note, however, that the <i>sudoers</i> file lookup is still done for root,
    not the user specified by SUDO_USER.</p>
<p class="Pp"><b>sudoers</b> uses per-user time stamp files for credential
    caching. Once a user has been authenticated, a record is written containing
    the uid that was used to authenticate, the terminal session ID, and a time
    stamp (using a monotonic clock if one is available). The user may then use
    <b>sudo</b> without a password for a short period of time (5 minutes unless
    overridden by the <i>timeout</i> option) . By default, <b>sudoers</b> uses a
    separate record for each tty, which means that a user's login sessions are
    authenticated separately. The <i>tty_tickets</i> option can be disabled to
    force the use of a single time stamp for all of a user's sessions.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Logging"><a class="permalink" href="#Logging">Logging</a></h2>
<b>sudoers</b> can log both successful and unsuccessful attempts (as well as
  errors) to syslog(3), a log file, or both. By default, <b>sudoers</b> will log
  via syslog(3) but this is changeable via the <i>syslog</i> and <i>logfile</i>
  Defaults settings. See <i>LOG FORMAT</i> for a description of the log file
  format.
<p class="Pp"><b>sudoers</b> is also capable of running a command in a
    pseudo-tty and logging all input and/or output. The standard input, standard
    output and standard error can be logged even when not associated with a
    terminal. I/O logging is not on by default but can be enabled using the
    <i>log_input</i> and <i>log_output</i> options as well as the LOG_INPUT and
    LOG_OUTPUT command tags. See <i>I/O LOG FILES</i> for details on how I/O log
    files are stored.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Command_environment"><a class="permalink" href="#Command_environment">Command
  environment</a></h2>
Since environment variables can influence program behavior, <b>sudoers</b>
  provides a means to restrict which variables from the user's environment are
  inherited by the command to be run. There are two distinct ways <b>sudoers</b>
  can deal with environment variables.
<p class="Pp">By default, the <i>env_reset</i> option is enabled. This causes
    commands to be executed with a new, minimal environment. On AIX (and Linux
    systems without PAM), the environment is initialized with the contents of
    the <i>/etc/environment</i> file. The new environment contains the TERM,
    PATH, HOME, MAIL, SHELL, LOGNAME, USER, USERNAME and SUDO_* variables in
    addition to variables from the invoking process permitted by the
    <i>env_check</i> and <i>env_keep</i> options. This is effectively a
    whitelist for environment variables. Environment variables with a value
    beginning with () are removed unless both the name and value parts are
    matched by <i>env_keep</i> or <i>env_check</i>, as they will be interpreted
    as functions by older versions of the <b>bash</b> shell. Prior to version
    1.8.11, such variables were always removed.</p>
<p class="Pp">If, however, the <i>env_reset</i> option is disabled, any
    variables not explicitly denied by the <i>env_check</i> and
    <i>env_delete</i> options are inherited from the invoking process. In this
    case, <i>env_check</i> and <i>env_delete</i> behave like a blacklist.
    Environment variables with a value beginning with () are always removed,
    even if they do not match one of the blacklists. Since it is not possible to
    blacklist all potentially dangerous environment variables, use of the
    default <i>env_reset</i> behavior is encouraged.</p>
<p class="Pp">By default, environment variables are matched by name. However, if
    the pattern includes an equal sign (&#x2018;=&#x2019;), both the variables
    name and value must match. For example, an old-style (pre-shellshock)
    <b>bash</b> shell function could be matched as follows:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
env_keep += &quot;my_func=()*&quot;
</pre>
</div>
<pre>
</pre>
<p class="Pp">Without the &#x201C;=()*&#x201D; suffix, this would not match, as
    old-style <b>bash</b> shell functions are not preserved by default.</p>
<p class="Pp">The complete list of environment variables that <b>sudo</b> allows
    or denies is contained in the output of &#x201C;sudo -V&#x201D; when run as
    root. Please note that this list varies based on the operating system
    <b>sudo</b> is running on.</p>
<p class="Pp">On systems that support PAM where the <b>pam_env</b> module is
    enabled for <b>sudo</b>, variables in the PAM environment may be merged in
    to the environment. If a variable in the PAM environment is already present
    in the user's environment, the value will only be overridden if the variable
    was not preserved by <b>sudoers</b>. When <i>env_reset</i> is enabled,
    variables preserved from the invoking user's environment by the
    <i>env_keep</i> list take precedence over those in the PAM environment. When
    <i>env_reset</i> is disabled, variables present the invoking user's
    environment take precedence over those in the PAM environment unless they
    match a pattern in the <i>env_delete</i> list.</p>
<p class="Pp">Note that the dynamic linker on most operating systems will remove
    variables that can control dynamic linking from the environment of setuid
    executables, including <b>sudo</b>. Depending on the operating system this
    may include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and others.
    These type of variables are removed from the environment before <b>sudo</b>
    even begins execution and, as such, it is not possible for <b>sudo</b> to
    preserve them.</p>
<p class="Pp">As a special case, if <b>sudo</b>'s <b>-i</b> option (initial
    login) is specified, <b>sudoers</b> will initialize the environment
    regardless of the value of <i>env_reset</i>. The DISPLAY, PATH and TERM
    variables remain unchanged; HOME, MAIL, SHELL, USER, and LOGNAME are set
    based on the target user. On AIX (and Linux systems without PAM), the
    contents of <i>/etc/environment</i> are also included. All other environment
    variables are removed.</p>
<p class="Pp">Finally, if the <i>env_file</i> option is defined, any variables
    present in that file will be set to their specified values as long as they
    would not conflict with an existing environment variable.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUDOERS_FILE_FORMAT"><a class="permalink" href="#SUDOERS_FILE_FORMAT">SUDOERS
  FILE FORMAT</a></h1>
The <i>sudoers</i> file is composed of two types of entries: aliases (basically
  variables) and user specifications (which specify who may run what).
<p class="Pp">When multiple entries match for a user, they are applied in order.
    Where there are multiple matches, the last match is used (which is not
    necessarily the most specific match).</p>
<p class="Pp">The <i>sudoers</i> file grammar will be described below in
    Extended Backus-Naur Form (EBNF). Don't despair if you are unfamiliar with
    EBNF; it is fairly simple, and the definitions below are annotated.</p>
<section class="Ss">
<h2 class="Ss" id="Quick_guide_to_EBNF"><a class="permalink" href="#Quick_guide_to_EBNF">Quick
  guide to EBNF</a></h2>
EBNF is a concise and exact way of describing the grammar of a language. Each
  EBNF definition is made up of <i>production rules</i>. E.g.,
<p class="Pp">symbol ::= definition | alternate1 | alternate2 ...</p>
<p class="Pp">Each <i>production rule</i> references others and thus makes up a
    grammar for the language. EBNF also contains the following operators, which
    many readers will recognize from regular expressions. Do not, however,
    confuse them with &#x201C;wildcard&#x201D; characters, which have different
    meanings.</p>
<dl class="Bl-tag">
  <dt>?</dt>
  <dd>Means that the preceding symbol (or group of symbols) is optional. That
      is, it may appear once or not at all.</dd>
  <dt>*</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear zero or
      more times.</dd>
  <dt>+</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear one or
      more times.</dd>
</dl>
<p class="Pp">Parentheses may be used to group symbols together. For clarity, we
    will use single quotes ('') to designate what is a verbatim character string
    (as opposed to a symbol name).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Aliases"><a class="permalink" href="#Aliases">Aliases</a></h2>
There are four kinds of aliases: User_Alias, Runas_Alias, Host_Alias and
  Cmnd_Alias.
<pre>

</pre>
<div class="Bd-indent">
<pre>
Alias ::= 'User_Alias'  User_Alias (':' User_Alias)* |
          'Runas_Alias' Runas_Alias (':' Runas_Alias)* |
          'Host_Alias'  Host_Alias (':' Host_Alias)* |
          'Cmnd_Alias'  Cmnd_Alias (':' Cmnd_Alias)*
User_Alias ::= NAME '=' User_List
Runas_Alias ::= NAME '=' Runas_List
Host_Alias ::= NAME '=' Host_List
Cmnd_Alias ::= NAME '=' Cmnd_List
NAME ::= [A-Z]([A-Z][0-9]_)*
</pre>
</div>
<pre>
</pre>
<p class="Pp">Each <i>alias</i> definition is of the form</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Alias_Type NAME = item1, item2, ...
</pre>
</div>
<pre>
</pre>
<p class="Pp">where <i>Alias_Type</i> is one of User_Alias, Runas_Alias,
    Host_Alias, or Cmnd_Alias. A NAME is a string of uppercase letters, numbers,
    and underscore characters (&#x2018;_&#x2019;). A NAME <b>must</b> start with
    an uppercase letter. It is possible to put several alias definitions of the
    same type on a single line, joined by a colon (&#x2018;:&#x2019;). E.g.,</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Alias_Type NAME = item1, item2, item3 : NAME = item4, item5
</pre>
</div>
<pre>
</pre>
<p class="Pp">It is a syntax error to redefine an existing <i>alias</i>. It is
    possible to use the same name for <i>aliases</i> of different types, but
    this is not recommended.</p>
<p class="Pp">The definitions of what constitutes a valid <i>alias</i> member
    follow.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
User_List ::= User |
              User ',' User_List
User ::= '!'* user name |
         '!'* #uid |
         '!'* %group |
         '!'* %#gid |
         '!'* +netgroup |
         '!'* %:nonunix_group |
         '!'* %:#nonunix_gid |
         '!'* User_Alias
</pre>
</div>
<pre>
</pre>
<p class="Pp">A User_List is made up of one or more user names, user IDs
    (prefixed with &#x2018;#&#x2019;), system group names and IDs (prefixed with
    &#x2018;%&#x2019; and &#x2018;%#&#x2019; respectively), netgroups (prefixed
    with &#x2018;+&#x2019;), non-Unix group names and IDs (prefixed with
    &#x2018;%:&#x2019; and &#x2018;%:#&#x2019; respectively) and User_Aliases.
    Each list item may be prefixed with zero or more &#x2018;!&#x2019;
    operators. An odd number of &#x2018;!&#x2019; operators negate the value of
    the item; an even number just cancel each other out. User netgroups are
    matched using the user and domain members only; the host member is not used
    when matching.</p>
<p class="Pp">A user name, uid, group, gid, netgroup, nonunix_group or
    nonunix_gid may be enclosed in double quotes to avoid the need for escaping
    special characters. Alternately, special characters may be specified in
    escaped hex mode, e.g. \x20 for space. When using double quotes, any prefix
    characters must be included inside the quotes.</p>
<p class="Pp">The actual nonunix_group and nonunix_gid syntax depends on the
    underlying group provider plugin. For instance, the QAS AD plugin supports
    the following formats:</p>
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd>Group in the same domain: &quot;%:Group Name&quot;</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>Group in any domain: &quot;%:Group Name@FULLY.QUALIFIED.DOMAIN&quot;</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>Group SID:
    &quot;%:S-1-2-34-5678901234-5678901234-5678901234-567&quot;</dd>
</dl>
<p class="Pp">See <i>GROUP PROVIDER PLUGINS</i> for more information.</p>
<p class="Pp">Note that quotes around group names are optional. Unquoted strings
    must use a backslash (&#x2018;\&#x2019;) to escape spaces and special
    characters. See <i>Other special characters and reserved words</i> for a
    list of characters that need to be escaped.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Runas_List ::= Runas_Member |
               Runas_Member ',' Runas_List
Runas_Member ::= '!'* user name |
                 '!'* #uid |
                 '!'* %group |
                 '!'* %#gid |
                 '!'* %:nonunix_group |
                 '!'* %:#nonunix_gid |
                 '!'* +netgroup |
                 '!'* Runas_Alias
</pre>
</div>
<pre>
</pre>
<p class="Pp">A Runas_List is similar to a User_List except that instead of
    User_Aliases it can contain Runas_Aliases. Note that user names and groups
    are matched as strings. In other words, two users (groups) with the same uid
    (gid) are considered to be distinct. If you wish to match all user names
    with the same uid (e.g. root and toor), you can use a uid instead (#0 in the
    example given).</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Host_List ::= Host |
              Host ',' Host_List
Host ::= '!'* host name |
         '!'* ip_addr |
         '!'* network(/netmask)? |
         '!'* +netgroup |
         '!'* Host_Alias
</pre>
</div>
<pre>
</pre>
<p class="Pp">A Host_List is made up of one or more host names, IP addresses,
    network numbers, netgroups (prefixed with &#x2018;+&#x2019;) and other
    aliases. Again, the value of an item may be negated with the
    &#x2018;!&#x2019; operator. Host netgroups are matched using the host (both
    qualified and unqualified) and domain members only; the user member is not
    used when matching. If you specify a network number without a netmask,
    <b>sudo</b> will query each of the local host's network interfaces and, if
    the network number corresponds to one of the hosts's network interfaces,
    will use the netmask of that interface. The netmask may be specified either
    in standard IP address notation (e.g. 255.255.255.0 or
    ffff:ffff:ffff:ffff::), or CIDR notation (number of bits, e.g. 24 or 64). A
    host name may include shell-style wildcards (see the <i>Wildcards</i>
    section below), but unless the host name command on your machine returns the
    fully qualified host name, you'll need to use the <i>fqdn</i> option for
    wildcards to be useful. Note that <b>sudo</b> only inspects actual network
    interfaces; this means that IP address 127.0.0.1 (localhost) will never
    match. Also, the host name &#x201C;localhost&#x201D; will only match if that
    is the actual host name, which is usually only the case for non-networked
    systems.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
digest ::= [A-Fa-f0-9]+ |
	   [[A-Za-z0-9+/=]+
Digest_Spec ::= &quot;sha224&quot; ':' digest |
		&quot;sha256&quot; ':' digest |
		&quot;sha384&quot; ':' digest |
		&quot;sha512&quot; ':' digest
Cmnd_List ::= Cmnd |
              Cmnd ',' Cmnd_List
command name ::= file name |
                 file name args |
                 file name '&quot;&quot;'
Cmnd ::= Digest_Spec? '!'* command name |
         '!'* directory |
         '!'* &quot;sudoedit&quot; |
         '!'* Cmnd_Alias
</pre>
</div>
<pre>
</pre>
<p class="Pp">A Cmnd_List is a list of one or more command names, directories,
    and other aliases. A command name is a fully qualified file name which may
    include shell-style wildcards (see the <i>Wildcards</i> section below). A
    simple file name allows the user to run the command with any arguments
    he/she wishes. However, you may also specify command line arguments
    (including wildcards). Alternately, you can specify &quot;&quot; to indicate
    that the command may only be run <b>without</b> command line arguments. A
    directory is a fully qualified path name ending in a &#x2018;/&#x2019;. When
    you specify a directory in a Cmnd_List, the user will be able to run any
    file within that directory (but not in any sub-directories therein).</p>
<p class="Pp">If a Cmnd has associated command line arguments, then the
    arguments in the Cmnd must match exactly those given by the user on the
    command line (or match the wildcards if there are any). Note that the
    following characters must be escaped with a &#x2018;\&#x2019; if they are
    used in command arguments: &#x2018;,&#x2019;, &#x2018;:&#x2019;,
    &#x2018;=&#x2019;, &#x2018;\&#x2019;. The built-in command
    &#x201C;sudoedit&#x201D; is used to permit a user to run <b>sudo</b> with
    the <b>-e</b> option (or as <b>sudoedit</b>). It may take command line
    arguments just as a normal command does. Note that &#x201C;sudoedit&#x201D;
    is a command built into <b>sudo</b> itself and must be specified in the
    <i>sudoers</i> file without a leading path.</p>
<p class="Pp">If a command name is prefixed with a Digest_Spec, the command will
    only match successfully if it can be verified using the specified SHA-2
    digest. The following digest formats are supported: sha224, sha256, sha384
    and sha512. The string may be specified in either hex or base64 format
    (base64 is more compact). There are several utilities capable of generating
    SHA-2 digests in hex format such as openssl, shasum, sha224sum, sha256sum,
    sha384sum, sha512sum.</p>
<p class="Pp">For example, using openssl:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ openssl dgst -sha224 /bin/ls
SHA224(/bin/ls)= 118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25
</pre>
</div>
<pre>
</pre>
<p class="Pp">It is also possible to use openssl to generate base64 output:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ openssl dgst -binary -sha224 /bin/ls | openssl base64
EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==
</pre>
</div>
<pre>
</pre>
<p class="Pp">Warning, if the user has write access to the command itself
    (directly or via a <b>sudo</b> command), it may be possible for the user to
    replace the command after the digest check has been performed but before the
    command is executed. A similar race condition exists on systems that lack
    the fexecve(2) system call when the directory in which the command is
    located is writable by the user.</p>
<p class="Pp">Command digests are only supported by version 1.8.7 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Defaults"><a class="permalink" href="#Defaults">Defaults</a></h2>
Certain configuration options may be changed from their default values at
  run-time via one or more Default_Entry lines. These may affect all users on
  any host, all users on a specific host, a specific user, a specific command,
  or commands being run as a specific user. Note that per-command entries may
  not include command line arguments. If you need to specify arguments, define a
  Cmnd_Alias and reference that instead.
<pre>

</pre>
<div class="Bd-indent">
<pre>
Default_Type ::= 'Defaults' |
                 'Defaults' '@' Host_List |
                 'Defaults' ':' User_List |
                 'Defaults' '!' Cmnd_List |
                 'Defaults' '&gt;' Runas_List
Default_Entry ::= Default_Type Parameter_List
Parameter_List ::= Parameter |
                   Parameter ',' Parameter_List
Parameter ::= Parameter '=' Value |
              Parameter '+=' Value |
              Parameter '-=' Value |
              '!'* Parameter
</pre>
</div>
<pre>
</pre>
<p class="Pp">Parameters may be <b>flags</b>, <b>integer</b> values,
    <b>strings</b>, or <b>lists</b>. Flags are implicitly boolean and can be
    turned off via the &#x2018;!&#x2019; operator. Some integer, string and list
    parameters may also be used in a boolean context to disable them. Values may
    be enclosed in double quotes (&quot;&quot;) when they contain multiple
    words. Special characters may be escaped with a backslash
    (&#x2018;\&#x2019;).</p>
<p class="Pp">Lists have two additional assignment operators, += and -=. These
    operators are used to add to and delete from a list respectively. It is not
    an error to use the -= operator to remove an element that does not exist in
    a list.</p>
<p class="Pp">Defaults entries are parsed in the following order: generic, host
    and user Defaults first, then runas Defaults and finally command
  defaults.</p>
<p class="Pp">See <i>SUDOERS OPTIONS</i> for a list of supported Defaults
    parameters.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User_specification"><a class="permalink" href="#User_specification">User
  specification</a></h2>
<div class="Bd-indent">
<pre>
User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
              (':' Host_List '=' Cmnd_Spec_List)*
Cmnd_Spec_List ::= Cmnd_Spec |
                   Cmnd_Spec ',' Cmnd_Spec_List
Cmnd_Spec ::= Runas_Spec? Tag_Spec* Cmnd
Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'
Tag_Spec ::= ('EXEC:' | 'NOEXEC:' | 'FOLLOW:' | 'NOFOLLOW' |
              'LOG_INPUT:' | 'NOLOG_INPUT:' | 'LOG_OUTPUT:' |
              'NOLOG_OUTPUT:' | 'MAIL:' | 'NOMAIL:' | 'PASSWD:' |
              'NOPASSWD:' | 'SETENV:' | 'NOSETENV:')
</pre>
</div>
<pre>
</pre>
<p class="Pp">A <b>user specification</b> determines which commands a user may
    run (and as what user) on specified hosts. By default, commands are run as
    <b>root</b>, but this can be changed on a per-command basis.</p>
<p class="Pp">The basic structure of a user specification is &#x201C;who where =
    (as_whom) what&#x201D;. Let's break that down into its constituent
  parts:</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Runas_Spec"><a class="permalink" href="#Runas_Spec">Runas_Spec</a></h2>
A Runas_Spec determines the user and/or the group that a command may be run as.
  A fully-specified Runas_Spec consists of two Runas_Lists (as defined above)
  separated by a colon (&#x2018;:&#x2019;) and enclosed in a set of parentheses.
  The first Runas_List indicates which users the command may be run as via
  <b>sudo</b>'s <b>-u</b> option. The second defines a list of groups that can
  be specified via <b>sudo</b>'s <b>-g</b> option. If both Runas_Lists are
  specified, the command may be run with any combination of users and groups
  listed in their respective Runas_Lists. If only the first is specified, the
  command may be run as any user in the list but no <b>-g</b> option may be
  specified. If the first Runas_List is empty but the second is specified, the
  command may be run as the invoking user with the group set to any listed in
  the Runas_List. If both Runas_Lists are empty, the command may only be run as
  the invoking user. If no Runas_Spec is specified the command may be run as
  <b>root</b> and no group may be specified.
<p class="Pp">A Runas_Spec sets the default for the commands that follow it.
    What this means is that for the entry:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
dgb	boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>dgb</b> may run <i>/bin/ls</i>, <i>/bin/kill</i>, and
    <i>/usr/bin/lprm</i>&#x2014;but only as <b>operator</b>. E.g.,</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudo -u operator /bin/ls
</pre>
</div>
<pre>
</pre>
<p class="Pp">It is also possible to override a Runas_Spec later on in an entry.
    If we modify the entry like so:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
dgb	boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm
</pre>
</div>
<pre>
</pre>
<p class="Pp">Then user <b>dgb</b> is now allowed to run <i>/bin/ls</i> as
    <b>operator</b>, but <i>/bin/kill</i> and <i>/usr/bin/lprm</i> as
    <b>root</b>.</p>
<p class="Pp">We can extend this to allow <b>dgb</b> to run /bin/ls with either
    the user or group set to <b>operator</b>:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
dgb	boulder = (operator : operator) /bin/ls, (root) /bin/kill,\
	/usr/bin/lprm
</pre>
</div>
<pre>
</pre>
<p class="Pp">Note that while the group portion of the Runas_Spec permits the
    user to run as command with that group, it does not force the user to do so.
    If no group is specified on the command line, the command will run with the
    group listed in the target user's password database entry. The following
    would all be permitted by the sudoers entry above:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudo -u operator /bin/ls
$ sudo -u operator -g operator /bin/ls
$ sudo -g operator /bin/ls
</pre>
</div>
<pre>
</pre>
<p class="Pp">In the following example, user <b>tcm</b> may run commands that
    access a modem device file with the dialer group.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
tcm	boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\
	/usr/local/bin/minicom
</pre>
</div>
<pre>
</pre>
<p class="Pp">Note that in this example only the group will be set, the command
    still runs as user <b>tcm</b>. E.g.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudo -g dialer /usr/bin/cu
</pre>
</div>
<pre>
</pre>
<p class="Pp">Multiple users and groups may be present in a Runas_Spec, in which
    case the user may select any combination of users and groups via the
    <b>-u</b> and <b>-g</b> options. In this example:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
alan	ALL = (root, bin : operator, system) ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">user <b>alan</b> may run any command as either user root or bin,
    optionally setting the group to operator or system.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Tag_Spec"><a class="permalink" href="#Tag_Spec">Tag_Spec</a></h2>
A command may have zero or more tags associated with it. There are ten possible
  tag values: EXEC, NOEXEC, FOLLOW, NOFOLLOW, LOG_INPUT, NOLOG_INPUT,
  LOG_OUTPUT, NOLOG_OUTPUT, MAIL, NOMAIL, PASSWD, NOPASSWD, SETENV, and
  NOSETENV. Once a tag is set on a Cmnd, subsequent Cmnds in the Cmnd_Spec_List,
  inherit the tag unless it is overridden by the opposite tag (in other words,
  PASSWD overrides NOPASSWD and NOEXEC overrides EXEC).
<dl class="Bl-tag">
  <dt><i>EXEC</i> and <i>NOEXEC</i></dt>
  <dd>
    <p class="Pp">If <b>sudo</b> has been compiled with <i>noexec</i> support
        and the underlying operating system supports it, the NOEXEC tag can be
        used to prevent a dynamically-linked executable from running further
        commands itself.</p>
    <p class="Pp">In the following example, user <b>aaron</b> may run
        <i>/usr/bin/more</i> and <i>/usr/bin/vi</i> but shell escapes will be
        disabled.</p>
    <pre>

    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>
aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi
</pre>
</div>
<pre>
</pre>
<div class="Bd-indent">
<p class="Pp">See the <i>Preventing shell escapes</i> section below for more
    details on how NOEXEC works and whether or not it will work on your
  system.</p>
</div>
<dl class="Bl-tag">
  <dt><i>FOLLOW</i> and <i>NOFOLLOW</i></dt>
  <dd>Starting with version 1.8.15, <b>sudoedit</b> will not open a file that is
      a symbolic link unless the <i>sudoedit_follow</i> option is enabled. The
      <i>FOLLOW</i> and <i>NOFOLLOW</i> tags override the value of
      <i>sudoedit_follow</i> and can be used to permit (or deny) the editing of
      symbolic links on a per-command basis. These tags are only effective for
      the <i>sudoedit</i> command and are ignored for all other commands.</dd>
  <dt><i>LOG_INPUT</i> and <i>NOLOG_INPUT</i></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>log_input</i> option
        on a per-command basis. For more information, see the description of
        <i>log_input</i> in the <i>SUDOERS OPTIONS</i> section below.</p>
  </dd>
  <dt><i>LOG_OUTPUT</i> and <i>NOLOG_OUTPUT</i></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>log_output</i> option
        on a per-command basis. For more information, see the description of
        <i>log_output</i> in the <i>SUDOERS OPTIONS</i> section below.</p>
  </dd>
  <dt><i>MAIL</i> and <i>NOMAIL</i></dt>
  <dd>
    <p class="Pp">These tags provide fine-grained control over whether mail will
        be sent when a user runs a command by overriding the value of the
        <i>mail_all_cmnds</i> option on a per-command basis. They have no effect
        when <b>sudo</b> is run with the <b>-l</b> or <b>-v</b> options. A
        <i>NOMAIL</i> tag will also override the <i>mail_always</i> and
        <i>mail_no_perms</i> options. For more information, see the descriptions
        of <i>mail_all_cmnds</i>, <i>mail_always</i>, and <i>mail_no_perms</i>
        in the <i>SUDOERS OPTIONS</i> section below.</p>
  </dd>
  <dt><i>PASSWD</i> and <i>NOPASSWD</i></dt>
  <dd>
    <p class="Pp">By default, <b>sudo</b> requires that a user authenticate him
        or herself before running a command. This behavior can be modified via
        the NOPASSWD tag. Like a Runas_Spec, the NOPASSWD tag sets a default for
        the commands that follow it in the Cmnd_Spec_List. Conversely, the
        PASSWD tag can be used to reverse things. For example:</p>
    <pre>

    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>
ray	rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm
</pre>
</div>
<pre>
</pre>
<div class="Bd-indent">
<p class="Pp">would allow the user <b>ray</b> to run <i>/bin/kill</i>,
    <i>/bin/ls</i>, and <i>/usr/bin/lprm</i> as <b>root</b> on the machine
    rushmore without authenticating himself. If we only want <b>ray</b> to be
    able to run <i>/bin/kill</i> without a password the entry would be:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
ray	rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm
</pre>
</div>
<pre>
</pre>
<p class="Pp">Note, however, that the PASSWD tag has no effect on users who are
    in the group specified by the <i>exempt_group</i> option.</p>
<p class="Pp">By default, if the NOPASSWD tag is applied to any of the entries
    for a user on the current host, he or she will be able to run &#x201C;sudo
    -l&#x201D; without a password. Additionally, a user may only run
    &#x201C;sudo -v&#x201D; without a password if the NOPASSWD tag is present
    for all a user's entries that pertain to the current host. This behavior may
    be overridden via the <i>verifypw</i> and <i>listpw</i> options.</p>
</div>
<dl class="Bl-tag">
  <dt><i>SETENV</i> and <i>NOSETENV</i></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>setenv</i> option on a
        per-command basis. Note that if SETENV has been set for a command, the
        user may disable the <i>env_reset</i> option from the command line via
        the <b>-E</b> option. Additionally, environment variables set on the
        command line are not subject to the restrictions imposed by
        <i>env_check</i>, <i>env_delete</i>, or <i>env_keep</i>. As such, only
        trusted users should be allowed to set variables in this manner. If the
        command matched is <b>ALL</b>, the SETENV tag is implied for that
        command; this default may be overridden by use of the NOSETENV tag.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Wildcards"><a class="permalink" href="#Wildcards">Wildcards</a></h2>
<b>sudo</b> allows shell-style <i>wildcards</i> (aka meta or glob characters) to
  be used in host names, path names and command line arguments in the
  <i>sudoers</i> file. Wildcard matching is done via the glob(3) and fnmatch(3)
  functions as specified by IEEE Std 1003.1 (&#x201C;POSIX.1&#x201D;).
<dl class="Bl-tag">
  <dt>*</dt>
  <dd>Matches any set of zero or more characters (including white space).</dd>
  <dt>?</dt>
  <dd>Matches any single character (including white space).</dd>
  <dt>[...]</dt>
  <dd>Matches any character in the specified range.</dd>
  <dt>[!...]</dt>
  <dd>Matches any character <i>not</i> in the specified range.</dd>
  <dt>\x</dt>
  <dd>For any character &#x2018;x&#x2019;, evaluates to &#x2018;x&#x2019;. This
      is used to escape special characters such as: &#x2018;*&#x2019;,
      &#x2018;?&#x2019;, &#x2018;[&#x2019;, and &#x2018;]&#x2019;.</dd>
</dl>
<p class="Pp"><b>Note that these are not regular expressions.</b> Unlike a
    regular expression there is no way to match one or more characters within a
    range.</p>
<p class="Pp">Character classes may be used if your system's glob(3) and
    fnmatch(3) functions support them. However, because the &#x2018;:&#x2019;
    character has special meaning in <i>sudoers</i>, it must be escaped. For
    example:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
/bin/ls [[\:alpha\:]]*
</pre>
</div>
<pre>
</pre>
<p class="Pp">Would match any file name beginning with a letter.</p>
<p class="Pp">Note that a forward slash (&#x2018;/&#x2019;) will <i>not</i> be
    matched by wildcards used in the file name portion of the command. This is
    to make a path like:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
/usr/bin/*
</pre>
</div>
<pre>
</pre>
<p class="Pp">match <i>/usr/bin/who</i> but not <i>/usr/bin/X11/xterm</i>.</p>
<p class="Pp">When matching the command line arguments, however, a slash
    <i>does</i> get matched by wildcards since command line arguments may
    contain arbitrary strings and not just path names.</p>
<p class="Pp"><b>Wildcards in command line arguments should be used with
    care.</b>
  <br/>
  Command line arguments are matched as a single, concatenated string. This mean
    a wildcard character such as &#x2018;?&#x2019; or &#x2018;*&#x2019; will
    match across word boundaries, which may be unexpected. For example, while a
    sudoers entry like:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
%operator ALL = /bin/cat /var/log/messages*
</pre>
</div>
<pre>
</pre>
<p class="Pp">will allow command like:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudo cat /var/log/messages.1
</pre>
</div>
<pre>
</pre>
<p class="Pp">It will also allow:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudo cat /var/log/messages /etc/shadow
</pre>
</div>
<pre>
</pre>
<p class="Pp">which is probably not what was intended. In most cases it is
    better to do command line processing outside of the <i>sudoers</i> file in a
    scripting language.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Exceptions_to_wildcard_rules"><a class="permalink" href="#Exceptions_to_wildcard_rules">Exceptions
  to wildcard rules</a></h2>
The following exceptions apply to the above rules:
<dl class="Bl-tag">
  <dt>&quot;&quot;</dt>
  <dd>If the empty string &quot;&quot; is the only command line argument in the
      <i>sudoers</i> file entry it means that command is not allowed to be run
      with <i>any</i> arguments.</dd>
  <dt>sudoedit</dt>
  <dd>Command line arguments to the <i>sudoedit</i> built-in command should
      always be path names, so a forward slash (&#x2018;/&#x2019;) will not be
      matched by a wildcard.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Including_other_files_from_within_sudoers"><a class="permalink" href="#Including_other_files_from_within_sudoers">Including
  other files from within sudoers</a></h2>
It is possible to include other <i>sudoers</i> files from within the
  <i>sudoers</i> file currently being parsed using the #include and #includedir
  directives.
<p class="Pp">This can be used, for example, to keep a site-wide <i>sudoers</i>
    file in addition to a local, per-machine file. For the sake of this example
    the site-wide <i>sudoers</i> file will be <i>/etc/sudoers</i> and the
    per-machine one will be <i>/etc/sudoers.local</i>. To include
    <i>/etc/sudoers.local</i> from within <i>/etc/sudoers</i> we would use the
    following line in <i>/etc/sudoers</i>:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
#include /etc/sudoers.local
</pre>
</div>
<pre>
</pre>
<p class="Pp">When <b>sudo</b> reaches this line it will suspend processing of
    the current file (<i>/etc/sudoers</i>) and switch to
    <i>/etc/sudoers.local</i>. Upon reaching the end of
    <i>/etc/sudoers.local</i>, the rest of <i>/etc/sudoers</i> will be
    processed. Files that are included may themselves include other files. A
    hard limit of 128 nested include files is enforced to prevent include file
    loops.</p>
<p class="Pp">If the path to the include file is not fully-qualified (does not
    begin with a &#x2018;/&#x2019;, it must be located in the same directory as
    the sudoers file it was included from. For example, if <i>/etc/sudoers</i>
    contains the line:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
#include sudoers.local
</pre>
</div>
<pre>
</pre>
<p class="Pp">the file that will be included is <i>/etc/sudoers.local</i>.</p>
<p class="Pp">The file name may also include the %h escape, signifying the short
    form of the host name. In other words, if the machine's host name is
    &#x201C;xerxes&#x201D;, then</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
#include /etc/sudoers.%h
</pre>
</div>
<pre>
</pre>
<p class="Pp">will cause <b>sudo</b> to include the file
    <i>/etc/sudoers.xerxes</i>.</p>
<p class="Pp">The #includedir directive can be used to create a <i>sudoers.d</i>
    directory that the system package manager can drop <i>sudoers</i> file rules
    into as part of package installation. For example, given:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
#includedir /etc/sudoers.d
</pre>
</div>
<pre>
</pre>
<p class="Pp"><b>sudo</b> will read each file in <i>/etc/sudoers.d</i>, skipping
    file names that end in &#x2018;~&#x2019; or contain a &#x2018;.&#x2019;
    character to avoid causing problems with package manager or editor
    temporary/backup files. Files are parsed in sorted lexical order. That is,
    <i>/etc/sudoers.d/01_first</i> will be parsed before
    <i>/etc/sudoers.d/10_second</i>. Be aware that because the sorting is
    lexical, not numeric, <i>/etc/sudoers.d/1_whoops</i> would be loaded
    <i>after</i> <i>/etc/sudoers.d/10_second</i>. Using a consistent number of
    leading zeroes in the file names can be used to avoid such problems.</p>
<p class="Pp">Note that unlike files included via #include, <b>visudo</b> will
    not edit the files in a #includedir directory unless one of them contains a
    syntax error. It is still possible to run <b>visudo</b> with the <b>-f</b>
    flag to edit the files directly, but this will not catch the redefinition of
    an <i>alias</i> that is also present in a different file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Other_special_characters_and_reserved_words"><a class="permalink" href="#Other_special_characters_and_reserved_words">Other
  special characters and reserved words</a></h2>
The pound sign (&#x2018;#&#x2019;) is used to indicate a comment (unless it is
  part of a #include directive or unless it occurs in the context of a user name
  and is followed by one or more digits, in which case it is treated as a uid).
  Both the comment character and any text after it, up to the end of the line,
  are ignored.
<p class="Pp">The reserved word <b>ALL</b> is a built-in <i>alias</i> that
    always causes a match to succeed. It can be used wherever one might
    otherwise use a Cmnd_Alias, User_Alias, Runas_Alias, or Host_Alias. You
    should not try to define your own <i>alias</i> called <b>ALL</b> as the
    built-in alias will be used in preference to your own. Please note that
    using <b>ALL</b> can be dangerous since in a command context, it allows the
    user to run <i>any</i> command on the system.</p>
<p class="Pp">An exclamation point (&#x2018;!&#x2019;) can be used as a logical
    <i>not</i> operator in a list or <i>alias</i> as well as in front of a Cmnd.
    This allows one to exclude certain values. For the &#x2018;!&#x2019;
    operator to be effective, there must be something for it to exclude. For
    example, to match all users except for root one would use:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
ALL,!root
</pre>
</div>
<pre>
</pre>
<p class="Pp">If the <b>ALL</b>, is omitted, as in:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
!root
</pre>
</div>
<pre>
</pre>
<p class="Pp">it would explicitly deny root but not match any other users. This
    is different from a true &#x201C;negation&#x201D; operator.</p>
<p class="Pp">Note, however, that using a &#x2018;!&#x2019; in conjunction with
    the built-in <b>ALL</b> alias to allow a user to run &#x201C;all but a
    few&#x201D; commands rarely works as intended (see <i>SECURITY NOTES</i>
    below).</p>
<p class="Pp">Long lines can be continued with a backslash (&#x2018;\&#x2019;)
    as the last character on the line.</p>
<p class="Pp">White space between elements in a list as well as special
    syntactic characters in a <i>User Specification</i> (&#x2018;=&#x2019;,
    &#x2018;:&#x2019;, &#x2018;(&#x2019;, &#x2018;)&#x2019;) is optional.</p>
<p class="Pp">The following characters must be escaped with a backslash
    (&#x2018;\&#x2019;) when used as part of a word (e.g. a user name or host
    name): &#x2018;!&#x2019;, &#x2018;=&#x2019;, &#x2018;:&#x2019;,
    &#x2018;,&#x2019;, &#x2018;(&#x2019;, &#x2018;)&#x2019;,
  &#x2018;\&#x2019;.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUDOERS_OPTIONS"><a class="permalink" href="#SUDOERS_OPTIONS">SUDOERS
  OPTIONS</a></h1>
<b>sudo</b>'s behavior can be modified by Default_Entry lines, as explained
  earlier. A list of all supported Defaults parameters, grouped by type, are
  listed below.
<p class="Pp"><b>Boolean Flags</b>:</p>
<dl class="Bl-tag">
  <dt>always_query_group_plugin</dt>
  <dd>If a <i>group_plugin</i> is configured, use it to resolve groups of the
      form %group as long as there is not also a system group of the same name.
      Normally, only groups of the form %:group are passed to the
      <i>group_plugin</i>. This flag is <i>off</i> by default.</dd>
  <dt>always_set_home</dt>
  <dd>If enabled, <b>sudo</b> will set the HOME environment variable to the home
      directory of the target user (which is root unless the <b>-u</b> option is
      used). This effectively means that the <b>-H</b> option is always implied.
      Note that by default, HOME will be set to the home directory of the target
      user when the <i>env_reset</i> option is enabled, so
      <i>always_set_home</i> only has an effect for configurations where either
      <i>env_reset</i> is disabled or HOME is present in the <i>env_keep</i>
      list. This flag is <i>off</i> by default.</dd>
  <dt>authenticate</dt>
  <dd>If set, users must authenticate themselves via a password (or other means
      of authentication) before they may run commands. This default may be
      overridden via the PASSWD and NOPASSWD tags. This flag is <i>on</i> by
      default.</dd>
  <dt>closefrom_override</dt>
  <dd>If set, the user may use <b>sudo</b>'s <b>-C</b> option which overrides
      the default starting point at which <b>sudo</b> begins closing open file
      descriptors. This flag is <i>off</i> by default.</dd>
  <dt>compress_io</dt>
  <dd>If set, and <b>sudo</b> is configured to log a command's input or output,
      the I/O logs will be compressed using <b>zlib</b>. This flag is <i>on</i>
      by default when <b>sudo</b> is compiled with <b>zlib</b> support.</dd>
  <dt>exec_background</dt>
  <dd>By default, <b>sudo</b> runs a command as the foreground process as long
      as <b>sudo</b> itself is running in the foreground. When the
      <i>exec_background</i> flag is enabled and the command is being run in a
      pty (due to I/O logging or the <i>use_pty</i> flag), the command will be
      run as a background process. Attempts to read from the controlling
      terminal (or to change terminal settings) will result in the command being
      suspended with the SIGTTIN signal (or SIGTTOU in the case of terminal
      settings). If this happens when <b>sudo</b> is a foreground process, the
      command will be granted the controlling terminal and resumed in the
      foreground with no user intervention required. The advantage of initially
      running the command in the background is that <b>sudo</b> need not read
      from the terminal unless the command explicitly requests it. Otherwise,
      any terminal input must be passed to the command, whether it has required
      it or not (the kernel buffers terminals so it is not possible to tell
      whether the command really wants the input). This is different from
      historic <i>sudo</i> behavior or when the command is not being run in a
      pty.
    <p class="Pp">For this to work seamlessly, the operating system must support
        the automatic restarting of system calls. Unfortunately, not all
        operating systems do this by default, and even those that do may have
        bugs. For example, Mac OS X fails to restart the <b>tcgetattr</b>() and
        <b>tcsetattr</b>() system calls (this is a bug in Mac OS X).
        Furthermore, because this behavior depends on the command stopping with
        the SIGTTIN or SIGTTOU signals, programs that catch these signals and
        suspend themselves with a different signal (usually SIGTOP) will not be
        automatically foregrounded. Some versions of the linux su(1) command
        behave this way. This flag is <i>off</i> by default.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher. It
        has no effect unless I/O logging is enabled or the <i>use_pty</i> flag
        is enabled.</p>
  </dd>
  <dt>env_editor</dt>
  <dd>If set, <b>visudo</b> will use the value of the EDITOR or VISUAL
      environment variables before falling back on the default editor list. Note
      that this may create a security hole as it allows the user to run any
      arbitrary command as root without logging. A safer alternative is to place
      a colon-separated list of editors in the editor variable. <b>visudo</b>
      will then only use the EDITOR or VISUAL if they match a value specified in
      editor. If the <i>env_reset</i> flag is enabled, the EDITOR and/or VISUAL
      environment variables must be present in the <i>env_keep</i> list for the
      <i>env_editor</i> flag to function when <b>visudo</b> is invoked via
      <b>sudo</b>. This flag is <i>on</i> by default.</dd>
  <dt>env_reset</dt>
  <dd>If set, <b>sudo</b> will run the command in a minimal environment
      containing the TERM, PATH, HOME, MAIL, SHELL, LOGNAME, USER, USERNAME and
      SUDO_* variables. Any variables in the caller's environment that match the
      env_keep and env_check lists are then added, followed by any variables
      present in the file specified by the <i>env_file</i> option (if any). The
      contents of the env_keep and env_check lists, as modified by global
      Defaults parameters in <i>sudoers</i>, are displayed when <b>sudo</b> is
      run by root with the <b>-V</b> option. If the <i>secure_path</i> option is
      set, its value will be used for the PATH environment variable. This flag
      is <i>on</i> by default.</dd>
  <dt>fast_glob</dt>
  <dd>Normally, <b>sudo</b> uses the glob(3) function to do shell-style globbing
      when matching path names. However, since it accesses the file system,
      glob(3) can take a long time to complete for some patterns, especially
      when the pattern references a network file system that is mounted on
      demand (auto mounted). The <i>fast_glob</i> option causes <b>sudo</b> to
      use the fnmatch(3) function, which does not access the file system to do
      its matching. The disadvantage of <i>fast_glob</i> is that it is unable to
      match relative path names such as <i>./ls</i> or <i>../bin/ls</i>. This
      has security implications when path names that include globbing characters
      are used with the negation operator, &#x2018;!&#x2019;, as such rules can
      be trivially bypassed. As such, this option should not be used when the
      <i>sudoers</i> file contains rules that contain negated path names which
      include globbing characters. This flag is <i>off</i> by default.</dd>
  <dt>fqdn</dt>
  <dd>Set this flag if you want to put fully qualified host names in the
      <i>sudoers</i> file when the local host name (as returned by the hostname
      command) does not contain the domain name. In other words, instead of
      myhost you would use myhost.mydomain.edu. You may still use the short form
      if you wish (and even mix the two). This option is only effective when the
      &#x201C;canonical&#x201D; host name, as returned by the
      <b>getaddrinfo</b>() or <b>gethostbyname</b>() function, is a
      fully-qualified domain name. This is usually the case when the system is
      configured to use DNS for host name resolution.
    <p class="Pp">If the system is configured to use the <i>/etc/hosts</i> file
        in preference to DNS, the &#x201C;canonical&#x201D; host name may not be
        fully-qualified. The order that sources are queried for host name
        resolution is usually specified in the <i>/etc/nsswitch.conf</i>,
        <i>/etc/netsvc.conf</i>, <i>/etc/host.conf</i>, or, in some cases,
        <i>/etc/resolv.conf</i> file. In the <i>/etc/hosts</i> file, the first
        host name of the entry is considered to be the &#x201C;canonical&#x201D;
        name; subsequent names are aliases that are not used by <b>sudoers</b>.
        For example, the following hosts file line for the machine
        &#x201C;xyzzy&#x201D; has the fully-qualified domain name as the
        &#x201C;canonical&#x201D; host name, and the short version as an
      alias.</p>
    <p class="Pp"></p>
  </dd>
</dl>
<div class="Bd-indent">192.168.1.1	xyzzy.sudo.ws xyzzy</div>
<div class="Bd-indent">
<p class="Pp">If the machine's hosts file entry is not formatted properly, the
    <i>fqdn</i> option will not be effective if it is queried before DNS.</p>
<p class="Pp">Beware that when using DNS for host name resolution, turning on
    <i>fqdn</i> requires <b>sudoers</b> to make DNS lookups which renders
    <b>sudo</b> unusable if DNS stops working (for example if the machine is
    disconnected from the network). Also note that just like with the hosts
    file, you must use the &#x201C;canonical&#x201D; name as DNS knows it. That
    is, you may not use a host alias (CNAME entry) due to performance issues and
    the fact that there is no way to get all aliases from DNS.</p>
<p class="Pp">This flag is <i>off</i> by default.</p>
</div>
<dl class="Bl-tag">
  <dt>ignore_dot</dt>
  <dd>If set, <b>sudo</b> will ignore &quot;.&quot; or &quot;&quot; (both
      denoting current directory) in the PATH environment variable; the PATH
      itself is not modified. This flag is <i>off</i> by default.</dd>
  <dt>ignore_local_sudoers</dt>
  <dd>If set via LDAP, parsing of <i>/private/etc/sudoers</i> will be skipped.
      This is intended for Enterprises that wish to prevent the usage of local
      sudoers files so that only LDAP is used. This thwarts the efforts of rogue
      operators who would attempt to add roles to <i>/private/etc/sudoers</i>.
      When this option is present, <i>/private/etc/sudoers</i> does not even
      need to exist. Since this option tells <b>sudo</b> how to behave when no
      specific LDAP entries have been matched, this sudoOption is only
      meaningful for the cn=defaults section. This flag is <i>off</i> by
      default.</dd>
  <dt>insults</dt>
  <dd>If set, <b>sudo</b> will insult users when they enter an incorrect
      password. This flag is <i>off</i> by default.</dd>
  <dt>log_host</dt>
  <dd>If set, the host name will be logged in the (non-syslog) <b>sudo</b> log
      file. This flag is <i>off</i> by default.</dd>
  <dt>log_input</dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-tty and log all user
      input. If the standard input is not connected to the user's tty, due to
      I/O redirection or because the command is part of a pipeline, that input
      is also captured and stored in a separate log file. For more information,
      see the <i>I/O LOG FILES</i> section. This flag is <i>off</i> by
    default.</dd>
  <dt>log_output</dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-tty and log all
      output that is sent to the screen, similar to the script(1) command. For
      more information, see the <i>I/O LOG FILES</i> section. This flag is
      <i>off</i> by default.</dd>
  <dt>log_year</dt>
  <dd>If set, the four-digit year will be logged in the (non-syslog) <b>sudo</b>
      log file. This flag is <i>off</i> by default.</dd>
  <dt>long_otp_prompt</dt>
  <dd>When validating with a One Time Password (OTP) scheme such as <b>S/Key</b>
      or <b>OPIE</b>, a two-line prompt is used to make it easier to cut and
      paste the challenge to a local window. It's not as pretty as the default
      but some people find it more convenient. This flag is <i>off</i> by
      default.</dd>
  <dt>mail_all_cmnds</dt>
  <dd>Send mail to the <i>mailto</i> user every time a user attempts to run a
      command via <b>sudo</b> (this includes <b>sudoedit</b>). No mail will be
      sent if the user runs <b>sudo</b> with the <b>-l</b> or <b>-v</b> option
      unless there is an authentication error and the <i>mail_badpass</i> flag
      is also set. This flag is <i>off</i> by default.</dd>
  <dt>mail_always</dt>
  <dd>Send mail to the <i>mailto</i> user every time a user runs <b>sudo</b>.
      This flag is <i>off</i> by default.</dd>
  <dt>mail_badpass</dt>
  <dd>Send mail to the <i>mailto</i> user if the user running <b>sudo</b> does
      not enter the correct password. If the command the user is attempting to
      run is not permitted by <b>sudoers</b> and one of the
      <i>mail_all_cmnds</i>, <i>mail_always</i>, <i>mail_no_host</i>,
      <i>mail_no_perms</i> or <i>mail_no_user</i> flags are set, this flag will
      have no effect. This flag is <i>off</i> by default.</dd>
  <dt>mail_no_host</dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      exists in the <i>sudoers</i> file, but is not allowed to run commands on
      the current host. This flag is <i>off</i> by default.</dd>
  <dt>mail_no_perms</dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      is allowed to use <b>sudo</b> but the command they are trying is not
      listed in their <i>sudoers</i> file entry or is explicitly denied. This
      flag is <i>off</i> by default.</dd>
  <dt>mail_no_user</dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      is not in the <i>sudoers</i> file. This flag is <i>on</i> by default.</dd>
  <dt>netgroup_tuple</dt>
  <dd>If set, netgroup lookups will be performed using the full netgroup tuple:
      host name, user name and domain (if one is set). Historically, <b>sudo</b>
      only matched the user name and domain for netgroups used in a User_List
      and only matched the host name and domain for netgroups used in a
      Host_List. This flag is <i>off</i> by default.</dd>
  <dt>noexec</dt>
  <dd>If set, all commands run via <b>sudo</b> will behave as if the NOEXEC tag
      has been set, unless overridden by an EXEC tag. See the description of
      <i>EXEC and NOEXEC</i> above as well as the <i>Preventing shell
      escapes</i> section at the end of this manual. This flag is <i>off</i> by
      default.</dd>
  <dt>pam_session</dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will create a new
      PAM session for the command to be run in. Disabling <i>pam_session</i> may
      be needed on older PAM implementations or on operating systems where
      opening a PAM session changes the utmp or wtmp files. If PAM session
      support is disabled, resource limits may not be updated for the command
      being run. If <i>pam_session</i>, <i>pam_setcred</i>, and <i>use_pty</i>
      are disabled and I/O logging has not been configured, <b>sudo</b> will
      execute the command directly instead of running it as a child process.
      This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt>pam_setcred</dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will attempt to
      establish credentials for the target user by default, if supported by the
      underlying authentication system. One example of a credential is a
      Kerberos ticket. If <i>pam_session</i>, <i>pam_setcred</i>, and
      <i>use_pty</i> are disabled and I/O logging has not been configured,
      <b>sudo</b> will execute the command directly instead of running it as a
      child process. This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt>passprompt_override</dt>
  <dd>The password prompt specified by <i>passprompt</i> will normally only be
      used if the password prompt provided by systems such as PAM matches the
      string &#x201C;Password:&#x201D;. If <i>passprompt_override</i> is set,
      <i>passprompt</i> will always be used. This flag is <i>off</i> by
    default.</dd>
  <dt>path_info</dt>
  <dd>Normally, <b>sudo</b> will tell the user when a command could not be found
      in their PATH environment variable. Some sites may wish to disable this as
      it could be used to gather information on the location of executables that
      the normal user does not have access to. The disadvantage is that if the
      executable is simply not in the user's PATH, <b>sudo</b> will tell the
      user that they are not allowed to run it, which can be confusing. This
      flag is <i>on</i> by default.</dd>
  <dt>preserve_groups</dt>
  <dd>By default, <b>sudo</b> will initialize the group vector to the list of
      groups the target user is in. When <i>preserve_groups</i> is set, the
      user's existing group vector is left unaltered. The real and effective
      group IDs, however, are still set to match the target user. This flag is
      <i>off</i> by default.</dd>
  <dt>pwfeedback</dt>
  <dd>By default, <b>sudo</b> reads the password like most other Unix programs,
      by turning off echo until the user hits the return (or enter) key. Some
      users become confused by this as it appears to them that <b>sudo</b> has
      hung at this point. When <i>pwfeedback</i> is set, <b>sudo</b> will
      provide visual feedback when the user presses a key. Note that this does
      have a security impact as an onlooker may be able to determine the length
      of the password being entered. This flag is <i>off</i> by default.</dd>
  <dt>requiretty</dt>
  <dd>If set, <b>sudo</b> will only run when the user is logged in to a real
      tty. When this flag is set, <b>sudo</b> can only be run from a login
      session and not via other means such as cron(8) or cgi-bin scripts. This
      flag is <i>off</i> by default.</dd>
  <dt>root_sudo</dt>
  <dd>If set, root is allowed to run <b>sudo</b> too. Disabling this prevents
      users from &#x201C;chaining&#x201D; <b>sudo</b> commands to get a root
      shell by doing something like &#x201C;sudo sudo /bin/sh&#x201D;. Note,
      however, that turning off <i>root_sudo</i> will also prevent root from
      running <b>sudoedit</b>. Disabling <i>root_sudo</i> provides no real
      additional security; it exists purely for historical reasons. This flag is
      <i>on</i> by default.</dd>
  <dt>rootpw</dt>
  <dd>If set, <b>sudo</b> will prompt for the root password instead of the
      password of the invoking user when running a command or editing a file.
      This flag is <i>off</i> by default.</dd>
  <dt>runaspw</dt>
  <dd>If set, <b>sudo</b> will prompt for the password of the user defined by
      the <i>runas_default</i> option (defaults to root) instead of the password
      of the invoking user when running a command or editing a file. This flag
      is <i>off</i> by default.</dd>
  <dt>set_home</dt>
  <dd>If enabled and <b>sudo</b> is invoked with the <b>-s</b> option the HOME
      environment variable will be set to the home directory of the target user
      (which is root unless the <b>-u</b> option is used). This effectively
      makes the <b>-s</b> option imply <b>-H</b>. Note that HOME is already set
      when the <i>env_reset</i> option is enabled, so <i>set_home</i> is only
      effective for configurations where either <i>env_reset</i> is disabled or
      HOME is present in the <i>env_keep</i> list. This flag is <i>off</i> by
      default.</dd>
  <dt>set_logname</dt>
  <dd>Normally, <b>sudo</b> will set the LOGNAME, USER and USERNAME environment
      variables to the name of the target user (usually root unless the
      <b>-u</b> option is given). However, since some programs (including the
      RCS revision control system) use LOGNAME to determine the real identity of
      the user, it may be desirable to change this behavior. This can be done by
      negating the set_logname option. Note that <i>set_logname</i> will have no
      effect if the <i>env_reset</i> option has not been disabled and the
      <i>env_keep</i> list contains LOGNAME, USER or USERNAME. This flag is
      <i>on</i> by default.</dd>
  <dt>set_utmp</dt>
  <dd>When enabled, <b>sudo</b> will create an entry in the utmp (or utmpx) file
      when a pseudo-tty is allocated. A pseudo-tty is allocated by <b>sudo</b>
      when the <i>log_input</i>, <i>log_output</i> or <i>use_pty</i> flags are
      enabled. By default, the new entry will be a copy of the user's existing
      utmp entry (if any), with the tty, time, type and pid fields updated. This
      flag is <i>on</i> by default.</dd>
  <dt>setenv</dt>
  <dd>Allow the user to disable the <i>env_reset</i> option from the command
      line via the <b>-E</b> option. Additionally, environment variables set via
      the command line are not subject to the restrictions imposed by
      <i>env_check</i>, <i>env_delete</i>, or <i>env_keep</i>. As such, only
      trusted users should be allowed to set variables in this manner. This flag
      is <i>off</i> by default.</dd>
  <dt>shell_noargs</dt>
  <dd>If set and <b>sudo</b> is invoked with no arguments it acts as if the
      <b>-s</b> option had been given. That is, it runs a shell as root (the
      shell is determined by the SHELL environment variable if it is set,
      falling back on the shell listed in the invoking user's /etc/passwd entry
      if not). This flag is <i>off</i> by default.</dd>
  <dt>stay_setuid</dt>
  <dd>Normally, when <b>sudo</b> executes a command the real and effective UIDs
      are set to the target user (root by default). This option changes that
      behavior such that the real UID is left as the invoking user's UID. In
      other words, this makes <b>sudo</b> act as a setuid wrapper. This can be
      useful on systems that disable some potentially dangerous functionality
      when a program is run setuid. This option is only effective on systems
      that support either the setreuid(2) or setresuid(2) system call. This flag
      is <i>off</i> by default.</dd>
  <dt>sudoedit_checkdir</dt>
  <dd>
    <br/>
    If set, <b>sudoedit</b> will check all directory components of the path to
      be edited for writability by the invoking user. Symbolic links will not be
      followed in writable directories and <b>sudoedit</b> will refuse to edit a
      file located in a writable directory. These restrictions are not enforced
      when <b>sudoedit</b> is run by root. On some systems, if all directory
      components of the path to be edited are not readable by the target user,
      <b>sudoedit</b> will be unable to edit the file. This flag is <i>on</i> by
      default.
    <p class="Pp">This setting was first introduced in version 1.8.15 but
        initially suffered from a race condition. The check for symbolic links
        in writable intermediate directories was added in version 1.8.16.</p>
  </dd>
  <dt>sudoedit_follow</dt>
  <dd>By default, <b>sudoedit</b> will not follow symbolic links when opening
      files. The <i>sudoedit_follow</i> option can be enabled to allow
      <b>sudoedit</b> to open symbolic links. It may be overridden on a
      per-command basis by the <i>FOLLOW</i> and <i>NOFOLLOW</i> tags. This flag
      is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.15 or
      higher.</p>
  </dd>
  <dt>targetpw</dt>
  <dd>If set, <b>sudo</b> will prompt for the password of the user specified by
      the <b>-u</b> option (defaults to root) instead of the password of the
      invoking user when running a command or editing a file. Note that this
      flag precludes the use of a uid not listed in the passwd database as an
      argument to the <b>-u</b> option. This flag is <i>off</i> by default.</dd>
  <dt>tty_tickets</dt>
  <dd>If set, users must authenticate on a per-tty basis. With this flag
      enabled, <b>sudo</b> will use a separate record in the time stamp file for
      each tty. If disabled, a single record is used for all login sessions.
      This flag is <i>on</i> by default.</dd>
  <dt>umask_override</dt>
  <dd>If set, <b>sudo</b> will set the umask as specified in the <i>sudoers</i>
      file without modification. This makes it possible to specify a umask in
      the <i>sudoers</i> file that is more permissive than the user's own umask
      and matches historical behavior. If <i>umask_override</i> is not set,
      <b>sudo</b> will set the umask to be the union of the user's umask and
      what is specified in <i>sudoers</i>. This flag is <i>off</i> by
    default.</dd>
  <dt>use_netgroups</dt>
  <dd>If set, netgroups (prefixed with &#x2018;+&#x2019;), may be used in place
      of a user or host. For LDAP-based sudoers, netgroup support requires an
      expensive substring match on the server unless the <b>NETGROUP_BASE</b>
      directive is present in the <i>/etc/ldap.conf</i> file. If netgroups are
      not needed, this option can be disabled to reduce the load on the LDAP
      server. This flag is <i>on</i> by default.</dd>
  <dt>use_pty</dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-pty even if no I/O
      logging is being gone. A malicious program run under <b>sudo</b> could
      conceivably fork a background process that retains to the user's terminal
      device after the main program has finished executing. Use of this option
      will make that impossible. This flag is <i>off</i> by default.</dd>
  <dt>utmp_runas</dt>
  <dd>If set, <b>sudo</b> will store the name of the runas user when updating
      the utmp (or utmpx) file. By default, <b>sudo</b> stores the name of the
      invoking user. This flag is <i>off</i> by default.</dd>
  <dt>visiblepw</dt>
  <dd>By default, <b>sudo</b> will refuse to run if the user must enter a
      password but it is not possible to disable echo on the terminal. If the
      <i>visiblepw</i> flag is set, <b>sudo</b> will prompt for a password even
      when it would be visible on the screen. This makes it possible to run
      things like &#x201C;ssh somehost sudo ls&#x201D; since by default, ssh(1)
      does not allocate a tty when running a command. This flag is <i>off</i> by
      default.</dd>
</dl>
<p class="Pp"><b>Integers</b>:</p>
<dl class="Bl-tag">
  <dt>closefrom</dt>
  <dd>Before it executes a command, <b>sudo</b> will close all open file
      descriptors other than standard input, standard output and standard error
      (ie: file descriptors 0-2). The <i>closefrom</i> option can be used to
      specify a different file descriptor at which to start closing. The default
      is 3.</dd>
  <dt>maxseq</dt>
  <dd>The maximum sequence number that will be substituted for the
      &#x201C;%{seq}&#x201D; escape in the I/O log file (see the
      <i>iolog_dir</i> description above for more information). While the value
      substituted for &#x201C;%{seq}&#x201D; is in base 36, <i>maxseq</i> itself
      should be expressed in decimal. Values larger than 2176782336 (which
      corresponds to the base 36 sequence number &#x201C;ZZZZZZ&#x201D;) will be
      silently truncated to 2176782336. The default value is 2176782336.
    <p class="Pp">Once the local sequence number reaches the value of
        <i>maxseq</i>, it will &#x201C;roll over&#x201D; to zero, after which
        <b>sudoers</b> will truncate and re-use any existing I/O log path
      names.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt>passwd_tries</dt>
  <dd>The number of tries a user gets to enter his/her password before
      <b>sudo</b> logs the failure and exits. The default is 3.</dd>
</dl>
<p class="Pp"><b>Integers that can be used in a boolean context</b>:</p>
<dl class="Bl-tag">
  <dt>loglinelen</dt>
  <dd>Number of characters per line for the file log. This value is used to
      decide when to wrap lines for nicer log files. This has no effect on the
      syslog log file, only the file log. The default is 80 (use 0 or negate the
      option to disable word wrap).</dd>
  <dt>passwd_timeout</dt>
  <dd>Number of minutes before the <b>sudo</b> password prompt times out, or 0
      for no timeout. The timeout may include a fractional component if minute
      granularity is insufficient, for example 2.5. The default is 0.</dd>
  <dt>timestamp_timeout</dt>
  <dd>
    <br/>
    Number of minutes that can elapse before <b>sudo</b> will ask for a passwd
      again. The timeout may include a fractional component if minute
      granularity is insufficient, for example 2.5. The default is 5. Set this
      to 0 to always prompt for a password. If set to a value less than 0 the
      user's time stamp will not expire until the system is rebooted. This can
      be used to allow users to create or delete their own time stamps via
      &#x201C;sudo -v&#x201D; and &#x201C;sudo -k&#x201D; respectively.</dd>
  <dt>umask</dt>
  <dd>Umask to use when running the command. Negate this option or set it to
      0777 to preserve the user's umask. The actual umask that is used will be
      the union of the user's umask and the value of the <i>umask</i> option,
      which defaults to 0022. This guarantees that <b>sudo</b> never lowers the
      umask when running a command. Note: on systems that use PAM, the default
      PAM configuration may specify its own umask which will override the value
      set in <i>sudoers</i>.</dd>
</dl>
<p class="Pp"><b>Strings</b>:</p>
<dl class="Bl-tag">
  <dt>badpass_message</dt>
  <dd>Message that is displayed if a user enters an incorrect password. The
      default is Sorry, try again. unless insults are enabled.</dd>
  <dt>editor</dt>
  <dd>A colon (&#x2018;:&#x2019;) separated list of editors allowed to be used
      with <b>visudo</b>. <b>visudo</b> will choose the editor that matches the
      user's EDITOR or VISUAL environment variable if possible, or the first
      editor in the list that exists and is executable. Note that the EDITOR and
      VISUAL environment variables are not preserved by default when the
      <i>env_reset</i> option is enabled. The default is <i>vi</i>.</dd>
  <dt>iolog_dir</dt>
  <dd>The top-level directory to use when constructing the path name for the
      input/output log directory. Only used if the <i>log_input</i> or
      <i>log_output</i> options are enabled or when the LOG_INPUT or LOG_OUTPUT
      tags are present for a command. The session sequence number, if any, is
      stored in the directory. The default is <i>/var/log/sudo-io</i>.
    <p class="Pp">The following percent (&#x2018;%&#x2019;) escape sequences are
        supported:</p>
  </dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>%{seq}</dt>
  <dd>expanded to a monotonically increasing base-36 sequence number, such as
      0100A5, where every two digits are used to form a new directory, e.g.
      <i>01/00/A5</i></dd>
  <dt>%{user}</dt>
  <dd>expanded to the invoking user's login name</dd>
  <dt>%{group}</dt>
  <dd>expanded to the name of the invoking user's real group ID</dd>
  <dt>%{runas_user}</dt>
  <dd>expanded to the login name of the user the command will be run as (e.g.
      root)</dd>
  <dt>%{runas_group}</dt>
  <dd>expanded to the group name of the user the command will be run as (e.g.
      wheel)</dd>
  <dt>%{hostname}</dt>
  <dd>expanded to the local host name without the domain name</dd>
  <dt>%{command}</dt>
  <dd>expanded to the base name of the command being run</dd>
</dl>
<p class="Pp">In addition, any escape sequences supported by the system's
    strftime(3) function will be expanded.</p>
<p class="Pp">To include a literal &#x2018;%&#x2019; character, the string
    &#x2018;%%&#x2019; should be used.</p>
</div>
<dl class="Bl-tag">
  <dt>iolog_file</dt>
  <dd>The path name, relative to <i>iolog_dir</i>, in which to store
      input/output logs when the <i>log_input</i> or <i>log_output</i> options
      are enabled or when the LOG_INPUT or LOG_OUTPUT tags are present for a
      command. Note that <i>iolog_file</i> may contain directory components. The
      default is &#x201C;%{seq}&#x201D;.
    <p class="Pp">See the <i>iolog_dir</i> option above for a list of supported
        percent (&#x2018;%&#x2019;) escape sequences.</p>
    <p class="Pp">In addition to the escape sequences, path names that end in
        six or more Xs will have the Xs replaced with a unique combination of
        digits and letters, similar to the mktemp(3) function.</p>
    <p class="Pp">If the path created by concatenating <i>iolog_dir</i> and
        <i>iolog_file</i> already exists, the existing I/O log file will be
        truncated and overwritten unless <i>iolog_file</i> ends in six or more
        Xs.</p>
  </dd>
  <dt>lecture_status_dir</dt>
  <dd>The directory in which <b>sudo</b> stores per-user lecture status files.
      Once a user has received the lecture, a zero-length file is created in
      this directory so that <b>sudo</b> will not lecture the user again. This
      directory should <i>not</i> be cleared when the system reboots. The
      default is <i>/var/db/sudo/lectured</i>.</dd>
  <dt>mailsub</dt>
  <dd>Subject of the mail sent to the <i>mailto</i> user. The escape %h will
      expand to the host name of the machine. Default is &#x201C;*** SECURITY
      information for %h ***&#x201D;.</dd>
  <dt>noexec_file</dt>
  <dd>As of <b>sudo</b> version 1.8.1 this option is no longer supported. The
      path to the noexec file should now be set in the sudo.conf(5) file.</dd>
  <dt>pam_login_service</dt>
  <dd>
    <br/>
    On systems that use PAM for authentication, this is the service name used
      when the <b>-i</b> option is specified. The default value is
      &#x201C;sudo&#x201D;. See the description of <i>pam_service</i> for more
      information.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt>pam_service</dt>
  <dd>On systems that use PAM for authentication, the service name specifies the
      PAM policy to apply. This usually corresponds to an entry in the
      <i>pam.conf</i> file or a file in the <i>/etc/pam.d</i> directory. The
      default value is &#x201C;sudo&#x201D;.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt>passprompt</dt>
  <dd>The default prompt to use when asking for a password; can be overridden
      via the <b>-p</b> option or the SUDO_PROMPT environment variable. The
      following percent (&#x2018;%&#x2019;) escape sequences are supported:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>%H</dt>
  <dd>expanded to the local host name including the domain name (only if the
      machine's host name is fully qualified or the <i>fqdn</i> option is
    set)</dd>
  <dt>%h</dt>
  <dd>expanded to the local host name without the domain name</dd>
  <dt>%p</dt>
  <dd>expanded to the user whose password is being asked for (respects the
      <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags in
    <i>sudoers</i>)</dd>
  <dt>%U</dt>
  <dd>expanded to the login name of the user the command will be run as
      (defaults to root)</dd>
  <dt>%u</dt>
  <dd>expanded to the invoking user's login name</dd>
  <dt>%%</dt>
  <dd>two consecutive % characters are collapsed into a single % character</dd>
</dl>
<p class="Pp">The default value is &#x201C;Password: &#x201D;.</p>
</div>
<dl class="Bl-tag">
  <dt>runas_default</dt>
  <dd>The default user to run commands as if the <b>-u</b> option is not
      specified on the command line. This defaults to root.</dd>
  <dt>syslog_badpri</dt>
  <dd>Syslog priority to use when user authenticates unsuccessfully. Defaults to
      alert.
    <p class="Pp">The following syslog priorities are supported: <b>alert</b>,
        <b>crit</b>, <b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>,
        <b>notice</b>, and <b>warning</b>.</p>
  </dd>
  <dt>syslog_goodpri</dt>
  <dd>Syslog priority to use when user authenticates successfully. Defaults to
      notice.
    <p class="Pp">See <i>syslog_badpri</i> for the list of supported syslog
        priorities.</p>
  </dd>
  <dt>sudoers_locale</dt>
  <dd>Locale to use when parsing the sudoers file, logging commands, and sending
      email. Note that changing the locale may affect how sudoers is
      interpreted. Defaults to &#x201C;C&#x201D;.</dd>
  <dt>timestampdir</dt>
  <dd>The directory in which <b>sudo</b> stores its time stamp files. This
      directory should be cleared when the system reboots. The default is
      <i>/var/db/sudo/ts</i>.</dd>
  <dt>timestampowner</dt>
  <dd>The owner of the lecture status directory, time stamp directory and all
      files stored therein. The default is root.</dd>
</dl>
<p class="Pp"><b>Strings that can be used in a boolean context</b>:</p>
<dl class="Bl-tag">
  <dt>env_file</dt>
  <dd>The <i>env_file</i> option specifies the fully qualified path to a file
      containing variables to be set in the environment of the program being
      run. Entries in this file should either be of the form
      &#x201C;VARIABLE=value&#x201D; or &#x201C;export VARIABLE=value&#x201D;.
      The value may optionally be surrounded by single or double quotes.
      Variables in this file are subject to other <b>sudo</b> environment
      settings such as <i>env_keep</i> and <i>env_check</i>.</dd>
  <dt>exempt_group</dt>
  <dd>Users in this group are exempt from password and PATH requirements. The
      group name specified should not include a % prefix. This is not set by
      default.</dd>
  <dt>group_plugin</dt>
  <dd>A string containing a <b>sudoers</b> group plugin with optional arguments.
      The string should consist of the plugin path, either fully-qualified or
      relative to the <i>/usr/local/libexec/sudo</i> directory, followed by any
      configuration arguments the plugin requires. These arguments (if any) will
      be passed to the plugin's initialization function. If arguments are
      present, the string must be enclosed in double quotes (&quot;&quot;).
    <p class="Pp">For more information see GROUP PROVIDER PLUGINS.</p>
  </dd>
  <dt>lecture</dt>
  <dd>This option controls when a short lecture will be printed along with the
      password prompt. It has the following possible values:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>always</dt>
  <dd>Always lecture the user.</dd>
  <dt>never</dt>
  <dd>Never lecture the user.</dd>
  <dt>once</dt>
  <dd>Only lecture the user the first time they run <b>sudo</b>.</dd>
</dl>
<p class="Pp">If no value is specified, a value of <i>once</i> is implied.
    Negating the option results in a value of <i>never</i> being used. The
    default value is <i>never</i>.</p>
</div>
<dl class="Bl-tag">
  <dt>lecture_file</dt>
  <dd>Path to a file containing an alternate <b>sudo</b> lecture that will be
      used in place of the standard lecture if the named file exists. By
      default, <b>sudo</b> uses a built-in lecture.</dd>
  <dt>listpw</dt>
  <dd>This option controls when a password will be required when a user runs
      <b>sudo</b> with the <b>-l</b> option. It has the following possible
      values:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>all</dt>
  <dd>All the user's <i>sudoers</i> file entries for the current host must have
      the NOPASSWD flag set to avoid entering a password.</dd>
  <dt>always</dt>
  <dd>The user must always enter a password to use the <b>-l</b> option.</dd>
  <dt>any</dt>
  <dd>At least one of the user's <i>sudoers</i> file entries for the current
      host must have the NOPASSWD flag set to avoid entering a password.</dd>
  <dt>never</dt>
  <dd>The user need never enter a password to use the <b>-l</b> option.</dd>
</dl>
<p class="Pp">If no value is specified, a value of <i>any</i> is implied.
    Negating the option results in a value of <i>never</i> being used. The
    default value is <i>any</i>.</p>
</div>
<dl class="Bl-tag">
  <dt>logfile</dt>
  <dd>Path to the <b>sudo</b> log file (not the syslog log file). Setting a path
      turns on logging to a file; negating this option turns it off. By default,
      <b>sudo</b> logs via syslog.</dd>
  <dt>mailerflags</dt>
  <dd>Flags to use when invoking mailer. Defaults to <b>-t</b>.</dd>
  <dt>mailerpath</dt>
  <dd>Path to mail program used to send warning mail. Defaults to the path to
      sendmail found at configure time.</dd>
  <dt>mailfrom</dt>
  <dd>Address to use for the &#x201C;from&#x201D; address when sending warning
      and error mail. The address should be enclosed in double quotes
      (&quot;&quot;) to protect against <b>sudo</b> interpreting the @ sign.
      Defaults to the name of the user running <b>sudo</b>.</dd>
  <dt>mailto</dt>
  <dd>Address to send warning and error mail to. The address should be enclosed
      in double quotes (&quot;&quot;) to protect against <b>sudo</b>
      interpreting the @ sign. Defaults to root.</dd>
  <dt>secure_path</dt>
  <dd>Path used for every command run from <b>sudo</b>. If you don't trust the
      people running <b>sudo</b> to have a sane PATH environment variable you
      may want to use this. Another use is if you want to have the &#x201C;root
      path&#x201D; be separate from the &#x201C;user path&#x201D;. Users in the
      group specified by the <i>exempt_group</i> option are not affected by
      <i>secure_path</i>. This option is not set by default.</dd>
  <dt>syslog</dt>
  <dd>Syslog facility if syslog is being used for logging (negate to disable
      syslog logging). Defaults to authpriv.
    <p class="Pp">The following syslog facilities are supported: <b>authpriv</b>
        (if your OS supports it), <b>auth</b>, <b>daemon</b>, <b>user</b>,
        <b>local0</b>, <b>local1</b>, <b>local2</b>, <b>local3</b>,
        <b>local4</b>, <b>local5</b>, <b>local6</b>, and <b>local7</b>.</p>
  </dd>
  <dt>verifypw</dt>
  <dd>This option controls when a password will be required when a user runs
      <b>sudo</b> with the <b>-v</b> option. It has the following possible
      values:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>all</dt>
  <dd>All the user's <i>sudoers</i> file entries for the current host must have
      the NOPASSWD flag set to avoid entering a password.</dd>
  <dt>always</dt>
  <dd>The user must always enter a password to use the <b>-v</b> option.</dd>
  <dt>any</dt>
  <dd>At least one of the user's <i>sudoers</i> file entries for the current
      host must have the NOPASSWD flag set to avoid entering a password.</dd>
  <dt>never</dt>
  <dd>The user need never enter a password to use the <b>-v</b> option.</dd>
</dl>
<p class="Pp">If no value is specified, a value of <i>all</i> is implied.
    Negating the option results in a value of <i>never</i> being used. The
    default value is <i>all</i>.</p>
</div>
<p class="Pp"><b>Lists that can be used in a boolean context</b>:</p>
<dl class="Bl-tag">
  <dt>env_check</dt>
  <dd>Environment variables to be removed from the user's environment unless
      they are considered &#x201C;safe&#x201D;. For all variables except TZ,
      &#x201C;safe&#x201D; means that the variable's value does not contain any
      &#x2018;%&#x2019; or &#x2018;/&#x2019; characters. This can be used to
      guard against printf-style format vulnerabilities in poorly-written
      programs. The TZ variable is considered unsafe if any of the following are
      true:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd>It consists of a fully-qualified path name, optionally prefixed with a
      colon (&#x2018;:&#x2019;), that does not match the location of the
      <i>zoneinfo</i> directory.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It contains a <i>..</i> path element.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It contains white space or non-printable characters.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It is longer than the value of PATH_MAX.</dd>
</dl>
<p class="Pp">The argument may be a double-quoted, space-separated list or a
    single value without double-quotes. The list can be replaced, added to,
    deleted from, or disabled by using the =, +=, -=, and ! operators
    respectively. Regardless of whether the env_reset option is enabled or
    disabled, variables specified by env_check will be preserved in the
    environment if they pass the aforementioned check. The global list of
    environment variables to check is displayed when <b>sudo</b> is run by root
    with the <b>-V</b> option.</p>
</div>
<dl class="Bl-tag">
  <dt>env_delete</dt>
  <dd>Environment variables to be removed from the user's environment when the
      <i>env_reset</i> option is not in effect. The argument may be a
      double-quoted, space-separated list or a single value without
      double-quotes. The list can be replaced, added to, deleted from, or
      disabled by using the =, +=, -=, and ! operators respectively. The global
      list of environment variables to remove is displayed when <b>sudo</b> is
      run by root with the <b>-V</b> option. Note that many operating systems
      will remove potentially dangerous variables from the environment of any
      setuid process (such as <b>sudo</b>).</dd>
  <dt>env_keep</dt>
  <dd>Environment variables to be preserved in the user's environment when the
      <i>env_reset</i> option is in effect. This allows fine-grained control
      over the environment <b>sudo</b>-spawned processes will receive. The
      argument may be a double-quoted, space-separated list or a single value
      without double-quotes. The list can be replaced, added to, deleted from,
      or disabled by using the =, +=, -=, and ! operators respectively. The
      global list of variables to keep is displayed when <b>sudo</b> is run by
      root with the <b>-V</b> option.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="GROUP_PROVIDER_PLUGINS"><a class="permalink" href="#GROUP_PROVIDER_PLUGINS">GROUP
  PROVIDER PLUGINS</a></h1>
The <b>sudoers</b> plugin supports its own plugin interface to allow non-Unix
  group lookups which can query a group source other than the standard Unix
  group database. This can be used to implement support for the nonunix_group
  syntax described earlier.
<p class="Pp">Group provider plugins are specified via the <i>group_plugin</i>
    Defaults setting. The argument to <i>group_plugin</i> should consist of the
    plugin path, either fully-qualified or relative to the
    <i>/usr/local/libexec/sudo</i> directory, followed by any configuration
    options the plugin requires. These options (if specified) will be passed to
    the plugin's initialization function. If options are present, the string
    must be enclosed in double quotes (&quot;&quot;).</p>
<p class="Pp">The following group provider plugins are installed by default:</p>
<dl class="Bl-tag">
  <dt>group_file</dt>
  <dd>The <i>group_file</i> plugin supports an alternate group file that uses
      the same syntax as the <i>/etc/group</i> file. The path to the group file
      should be specified as an option to the plugin. For example, if the group
      file to be used is <i>/etc/sudo-group</i>:
    <pre>

    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>
Defaults group_plugin=&quot;group_file.so /etc/sudo-group&quot;
</pre>
</div>
<pre>
</pre>
<dl class="Bl-tag">
  <dt>system_group</dt>
  <dd>The <i>system_group</i> plugin supports group lookups via the standard C
      library functions <b>getgrnam</b>() and <b>getgrid</b>(). This plugin can
      be used in instances where the user belongs to groups not present in the
      user's supplemental group vector. This plugin takes no options:
    <pre>

    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>
Defaults group_plugin=system_group.so
</pre>
</div>
<pre>
</pre>
<p class="Pp">The group provider plugin API is described in detail in
    sudo_plugin(8).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LOG_FORMAT"><a class="permalink" href="#LOG_FORMAT">LOG
  FORMAT</a></h1>
<b>sudoers</b> can log events using either syslog(3) or a simple log file. The
  log format is almost identical in both cases.
<section class="Ss">
<h2 class="Ss" id="Accepted_command_log_entries"><a class="permalink" href="#Accepted_command_log_entries">Accepted
  command log entries</a></h2>
Commands that sudo runs are logged using the following format (split into
  multiple lines for readability):
<pre>

</pre>
<div class="Bd-indent">
<pre>
date hostname progname: username : TTY=ttyname ; PWD=cwd ; \
    USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \
    ENV=env_vars COMMAND=command
</pre>
</div>
<pre>
</pre>
<p class="Pp">Where the fields are as follows:</p>
<dl class="Bl-tag">
  <dt>date</dt>
  <dd>The date the command was run. Typically, this is in the format
      &#x201C;MMM, DD, HH:MM:SS&#x201D;. If logging via syslog(3), the actual
      date format is controlled by the syslog daemon. If logging to a file and
      the <i>log_year</i> option is enabled, the date will also include the
      year.</dd>
  <dt>hostname</dt>
  <dd>The name of the host <b>sudo</b> was run on. This field is only present
      when logging via syslog(3).</dd>
  <dt>progname</dt>
  <dd>The name of the program, usually <i>sudo</i> or <i>sudoedit</i>. This
      field is only present when logging via syslog(3).</dd>
  <dt>username</dt>
  <dd>The login name of the user who ran <b>sudo</b>.</dd>
  <dt>ttyname</dt>
  <dd>The short name of the terminal (e.g. &#x201C;console&#x201D;,
      &#x201C;tty01&#x201D;, or &#x201C;pts/0&#x201D;) <b>sudo</b> was run on,
      or &#x201C;unknown&#x201D; if there was no terminal present.</dd>
  <dt>cwd</dt>
  <dd>The current working directory that <b>sudo</b> was run in.</dd>
  <dt>runasuser</dt>
  <dd>The user the command was run as.</dd>
  <dt>runasgroup</dt>
  <dd>The group the command was run as if one was specified on the command
    line.</dd>
  <dt>logid</dt>
  <dd>An I/O log identifier that can be used to replay the command's output.
      This is only present when the <i>log_input</i> or <i>log_output</i> option
      is enabled.</dd>
  <dt>env_vars</dt>
  <dd>A list of environment variables specified on the command line, if
      specified.</dd>
  <dt>command</dt>
  <dd>The actual command that was executed.</dd>
</dl>
<p class="Pp">Messages are logged using the locale specified by
    <i>sudoers_locale</i>, which defaults to the &#x201C;C&#x201D; locale.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Denied_command_log_entries"><a class="permalink" href="#Denied_command_log_entries">Denied
  command log entries</a></h2>
If the user is not allowed to run the command, the reason for the denial will
  follow the user name. Possible reasons include:
<dl class="Bl-tag">
  <dt>user NOT in sudoers</dt>
  <dd>The user is not listed in the <i>sudoers</i> file.</dd>
  <dt>user NOT authorized on host</dt>
  <dd>The user is listed in the <i>sudoers</i> file but is not allowed to run
      commands on the host.</dd>
  <dt>command not allowed</dt>
  <dd>The user is listed in the <i>sudoers</i> file for the host but they are
      not allowed to run the specified command.</dd>
  <dt>3 incorrect password attempts</dt>
  <dd>The user failed to enter their password after 3 tries. The actual number
      of tries will vary based on the number of failed attempts and the value of
      the <i>passwd_tries</i> option.</dd>
  <dt>a password is required</dt>
  <dd><b>sudo</b>'s <b>-n</b> option was specified but a password was
    required.</dd>
  <dt>sorry, you are not allowed to set the following environment variables</dt>
  <dd>The user specified environment variables on the command line that were not
      allowed by <i>sudoers</i>.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Error_log_entries"><a class="permalink" href="#Error_log_entries">Error
  log entries</a></h2>
If an error occurs, <b>sudoers</b> will log a message and, in most cases, send a
  message to the administrator via email. Possible errors include:
<dl class="Bl-tag">
  <dt>parse error in /private/etc/sudoers near line N</dt>
  <dd><b>sudoers</b> encountered an error when parsing the specified file. In
      some cases, the actual error may be one line above or below the line
      number listed, depending on the type of error.</dd>
  <dt>problem with defaults entries</dt>
  <dd>The <i>sudoers</i> file contains one or more unknown Defaults settings.
      This does not prevent <b>sudo</b> from running, but the <i>sudoers</i>
      file should be checked using <b>visudo</b>.</dd>
  <dt>timestamp owner (username): No such user</dt>
  <dd>The time stamp directory owner, as specified by the <i>timestampowner</i>
      setting, could not be found in the password database.</dd>
  <dt>unable to open/read /private/etc/sudoers</dt>
  <dd>The <i>sudoers</i> file could not be opened for reading. This can happen
      when the <i>sudoers</i> file is located on a remote file system that maps
      user ID 0 to a different value. Normally, <b>sudoers</b> tries to open the
      <i>sudoers</i> file using group permissions to avoid this problem.
      Consider either changing the ownership of <i>/private/etc/sudoers</i> or
      adding an argument like &#x201C;sudoers_uid=N&#x201D; (where
      &#x2018;N&#x2019; is the user ID that owns the <i>sudoers</i> file) to the
      end of the <b>sudoers</b> Plugin line in the sudo.conf(5) file.</dd>
  <dt>unable to stat /private/etc/sudoers</dt>
  <dd>The <i>/private/etc/sudoers</i> file is missing.</dd>
  <dt>/private/etc/sudoers is not a regular file</dt>
  <dd>The <i>/private/etc/sudoers</i> file exists but is not a regular file or
      symbolic link.</dd>
  <dt>/private/etc/sudoers is owned by uid N, should be 0</dt>
  <dd>The <i>sudoers</i> file has the wrong owner. If you wish to change the
      <i>sudoers</i> file owner, please add &#x201C;sudoers_uid=N&#x201D; (where
      &#x2018;N&#x2019; is the user ID that owns the <i>sudoers</i> file) to the
      <b>sudoers</b> Plugin line in the sudo.conf(5) file.</dd>
  <dt>/private/etc/sudoers is world writable</dt>
  <dd>The permissions on the <i>sudoers</i> file allow all users to write to it.
      The <i>sudoers</i> file must not be world-writable, the default file mode
      is 0440 (readable by owner and group, writable by none). The default mode
      may be changed via the &#x201C;sudoers_mode&#x201D; option to the
      <b>sudoers</b> Plugin line in the sudo.conf(5) file.</dd>
  <dt>/private/etc/sudoers is owned by gid N, should be 1</dt>
  <dd>The <i>sudoers</i> file has the wrong group ownership. If you wish to
      change the <i>sudoers</i> file group ownership, please add
      &#x201C;sudoers_gid=N&#x201D; (where &#x2018;N&#x2019; is the group ID
      that owns the <i>sudoers</i> file) to the <b>sudoers</b> Plugin line in
      the sudo.conf(5) file.</dd>
  <dt>unable to open /var/db/sudo/ts/username</dt>
  <dd><b>sudoers</b> was unable to read or create the user's time stamp file.
      This can happen when <i>timestampowner</i> is set to a user other than
      root and the mode on <i>/var/db/sudo</i> is not searchable by group or
      other. The default mode for <i>/var/db/sudo</i> is 0711.</dd>
  <dt>unable to write to /var/db/sudo/ts/username</dt>
  <dd><b>sudoers</b> was unable to write to the user's time stamp file.</dd>
  <dt>/var/db/sudo/ts is owned by uid X, should be Y</dt>
  <dd>The time stamp directory is owned by a user other than
      <i>timestampowner</i>. This can occur when the value of
      <i>timestampowner</i> has been changed. <b>sudoers</b> will ignore the
      time stamp directory until the owner is corrected.</dd>
  <dt>/var/db/sudo/ts is group writable</dt>
  <dd>The time stamp directory is group-writable; it should be writable only by
      <i>timestampowner</i>. The default mode for the time stamp directory is
      0700. <b>sudoers</b> will ignore the time stamp directory until the mode
      is corrected.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Notes_on_logging_via_syslog"><a class="permalink" href="#Notes_on_logging_via_syslog">Notes
  on logging via syslog</a></h2>
By default, <b>sudoers</b> logs messages via syslog(3). The <i>date</i>,
  <i>hostname</i>, and <i>progname</i> fields are added by the syslog daemon,
  not <b>sudoers</b> itself. As such, they may vary in format on different
  systems.
<p class="Pp">On most systems, syslog(3) has a relatively small log buffer. To
    prevent the command line arguments from being truncated, <b>sudoers</b> will
    split up log messages that are larger than 960 characters (not including the
    date, hostname, and the string &#x201C;sudo&#x201D;). When a message is
    split, additional parts will include the string &#x201C;(command
    continued)&#x201D; after the user name and before the continued command line
    arguments.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Notes_on_logging_to_a_file"><a class="permalink" href="#Notes_on_logging_to_a_file">Notes
  on logging to a file</a></h2>
If the <i>logfile</i> option is set, <b>sudoers</b> will log to a local file,
  such as <i>/var/log/sudo</i>. When logging to a file, <b>sudoers</b> uses a
  format similar to syslog(3), with a few important differences:
<dl class="Bl-tag">
  <dt>1.</dt>
  <dd>The <i>progname</i> and <i>hostname</i> fields are not present.</dd>
  <dt>2.</dt>
  <dd>If the <i>log_year</i> option is enabled, the date will also include the
      year.</dd>
  <dt>3.</dt>
  <dd>Lines that are longer than <i>loglinelen</i> characters (80 by default)
      are word-wrapped and continued on the next line with a four character
      indent. This makes entries easier to read for a human being, but makes it
      more difficult to use grep(1) on the log files. If the <i>loglinelen</i>
      option is set to 0 (or negated with a &#x2018;!&#x2019;), word wrap will
      be disabled.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="I/O_LOG_FILES"><a class="permalink" href="#I/O_LOG_FILES">I/O
  LOG FILES</a></h1>
When I/O logging is enabled, <b>sudo</b> will run the command in a pseudo-tty
  and log all user input and/or output. I/O is logged to the directory specified
  by the <i>iolog_dir</i> option (<i>/var/log/sudo-io</i> by default) using a
  unique session ID that is included in the <b>sudo</b> log line, prefixed with
  &#x201C;TSID=&#x201D;. The <i>iolog_file</i> option may be used to control the
  format of the session ID.
<p class="Pp">Each I/O log is stored in a separate directory that contains the
    following files:</p>
<dl class="Bl-tag">
  <dt><i>log</i></dt>
  <dd>a text file containing the time the command was run, the name of the user
      who ran <b>sudo</b>, the name of the target user, the name of the target
      group (optional), the terminal that <b>sudo</b> was run from, the number
      of rows and columns of the terminal, the working directory the command was
      run from and the path name of the command itself (with arguments if
      present)</dd>
  <dt><i>timing</i></dt>
  <dd>a log of the amount of time between, and the number of bytes in, each I/O
      log entry (used for session playback)</dd>
  <dt><i>ttyin</i></dt>
  <dd>input from the user's tty (what the user types)</dd>
  <dt><i>stdin</i></dt>
  <dd>input from a pipe or file</dd>
  <dt><i>ttyout</i></dt>
  <dd>output from the pseudo-tty (what the command writes to the screen)</dd>
  <dt><i>stdout</i></dt>
  <dd>standard output to a pipe or redirected to a file</dd>
  <dt><i>stderr</i></dt>
  <dd>standard error to a pipe or redirected to a file</dd>
</dl>
<p class="Pp">All files other than <i>log</i> are compressed in gzip format
    unless the <i>compress_io</i> option has been disabled. Due to buffering,
    the I/O log data will not be complete until the <b>sudo</b> command has
    completed. The output portion of an I/O log file can be viewed with the
    sudoreplay(8) utility, which can also be used to list or search the
    available logs.</p>
<p class="Pp">Note that user input may contain sensitive information such as
    passwords (even if they are not echoed to the screen), which will be stored
    in the log file unencrypted. In most cases, logging the command output via
    <i>log_output</i> or LOG_OUTPUT is all that is required.</p>
<p class="Pp">Since each session's I/O logs are stored in a separate directory,
    traditional log rotation utilities cannot be used to limit the number of I/O
    logs. The simplest way to limit the number of I/O is by setting the
    <i>maxseq</i> option to the maximum number of logs you wish to store. Once
    the I/O log sequence number reaches <i>maxseq</i>, it will be reset to zero
    and <b>sudoers</b> will truncate and re-use any existing I/O logs.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt><i>/private/etc/sudo.conf</i></dt>
  <dd>Sudo front end configuration</dd>
  <dt><i>/private/etc/sudoers</i></dt>
  <dd>List of who can run what</dd>
  <dt><i>/etc/group</i></dt>
  <dd>Local groups file</dd>
  <dt><i>/etc/netgroup</i></dt>
  <dd>List of network groups</dd>
  <dt><i>/var/log/sudo-io</i></dt>
  <dd>I/O log files</dd>
  <dt><i>/var/db/sudo/ts</i></dt>
  <dd>Directory containing time stamps for the <b>sudoers</b> security
    policy</dd>
  <dt><i>/var/db/sudo/lectured</i></dt>
  <dd>Directory containing lecture status files for the <b>sudoers</b> security
      policy</dd>
  <dt><i>/etc/environment</i></dt>
  <dd>Initial environment for <b>-i</b> mode on AIX and Linux systems</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
Below are example <i>sudoers</i> file entries. Admittedly, some of these are a
  bit contrived. First, we allow a few environment variables to pass and then
  define our <i>aliases</i>:
<pre>

</pre>
<div class="Bd-indent">
<pre>
# Run X applications through sudo; HOME is used to find the
# .Xauthority file.  Note that other programs use HOME to find
# configuration files and this may lead to privilege escalation!
Defaults env_keep += &quot;DISPLAY HOME&quot;
# User alias specification
User_Alias	FULLTIMERS = millert, mikef, dowdy
User_Alias	PARTTIMERS = bostley, jwfox, crawl
User_Alias	WEBMASTERS = will, wendy, wim
# Runas alias specification
Runas_Alias	OP = root, operator
Runas_Alias	DB = oracle, sybase
Runas_Alias	ADMINGRP = adm, oper
# Host alias specification
Host_Alias	SPARC = bigtime, eclipse, moet, anchor :\
		SGI = grolsch, dandelion, black :\
		ALPHA = widget, thalamus, foobar :\
		HPPA = boa, nag, python
Host_Alias	CUNETS = 128.138.0.0/255.255.0.0
Host_Alias	CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
Host_Alias	SERVERS = master, mail, www, ns
Host_Alias	CDROM = orion, perseus, hercules
# Cmnd alias specification
Cmnd_Alias	DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
			/usr/sbin/restore, /usr/sbin/rrestore,\
			sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== \
			/home/operator/bin/start_backups
Cmnd_Alias	KILL = /usr/bin/kill
Cmnd_Alias	PRINTING = /usr/sbin/lpc, /usr/bin/lprm
Cmnd_Alias	SHUTDOWN = /usr/sbin/shutdown
Cmnd_Alias	HALT = /usr/sbin/halt
Cmnd_Alias	REBOOT = /usr/sbin/reboot
Cmnd_Alias	SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh,\
			 /usr/local/bin/tcsh, /usr/bin/rsh,\
			 /usr/local/bin/zsh
Cmnd_Alias	SU = /usr/bin/su
Cmnd_Alias	PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less
</pre>
</div>
<pre>
</pre>
<p class="Pp">Here we override some of the compiled in default values. We want
    <b>sudo</b> to log via syslog(3) using the <i>auth</i> facility in all
    cases. We don't want to subject the full time staff to the <b>sudo</b>
    lecture, user <b>millert</b> need not give a password, and we don't want to
    reset the LOGNAME, USER or USERNAME environment variables when running
    commands as root. Additionally, on the machines in the <i>SERVERS</i>
    Host_Alias, we keep an additional local log file and make sure we log the
    year in each log line since the log entries will be kept around for several
    years. Lastly, we disable shell escapes for the commands in the PAGERS
    Cmnd_Alias (<i>/usr/bin/more</i>, <i>/usr/bin/pg</i> and
    <i>/usr/bin/less</i>) . Note that this will not effectively constrain users
    with <b>sudo</b> <b>ALL</b> privileges.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
# Override built-in defaults
Defaults		syslog=auth
Defaults&gt;root		!set_logname
Defaults:FULLTIMERS	!lecture
Defaults:millert	!authenticate
Defaults@SERVERS	log_year, logfile=/var/log/sudo.log
Defaults!PAGERS		noexec
</pre>
</div>
<pre>
</pre>
<p class="Pp">The <i>User specification</i> is the part that actually determines
    who may run what.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
root		ALL = (ALL) ALL
%wheel		ALL = (ALL) ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">We let <b>root</b> and any user in group <b>wheel</b> run any
    command on any host as any user.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
FULLTIMERS	ALL = NOPASSWD: ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">Full time sysadmins (<b>millert</b>, <b>mikef</b>, and
    <b>dowdy</b>) may run any command on any host without authenticating
    themselves.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
PARTTIMERS	ALL = ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">Part time sysadmins <b>bostley</b>, <b>jwfox</b>, and
    <b>crawl</b>) may run any command on any host but they must authenticate
    themselves first (since the entry lacks the NOPASSWD tag).</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
jack		CSNETS = ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>jack</b> may run any command on the machines in the
    <i>CSNETS</i> alias (the networks 128.138.243.0, 128.138.204.0, and
    128.138.242.0). Of those networks, only 128.138.204.0 has an explicit
    netmask (in CIDR notation) indicating it is a class C network. For the other
    networks in <i>CSNETS</i>, the local machine's netmask will be used during
    matching.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
lisa		CUNETS = ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>lisa</b> may run any command on any host in the
    <i>CUNETS</i> alias (the class B network 128.138.0.0).</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
operator	ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
		sudoedit /etc/printcap, /usr/oper/bin/
</pre>
</div>
<pre>
</pre>
<p class="Pp">The <b>operator</b> user may run commands limited to simple
    maintenance. Here, those are commands related to backups, killing processes,
    the printing system, shutting down the system, and any commands in the
    directory <i>/usr/oper/bin/</i>. Note that one command in the DUMPS
    Cmnd_Alias includes a sha224 digest,
    <i>/home/operator/bin/start_backups</i>. This is because the directory
    containing the script is writable by the operator user. If the script is
    modified (resulting in a digest mismatch) it will no longer be possible to
    run it via <b>sudo</b>.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
joe		ALL = /usr/bin/su operator
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>joe</b> may only su(1) to operator.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
pete		HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd root
%opers		ALL = (: ADMINGRP) /usr/sbin/
</pre>
</div>
<pre>
</pre>
<p class="Pp">Users in the <b>opers</b> group may run commands in
    <i>/usr/sbin/</i> as themselves with any group in the <i>ADMINGRP</i>
    Runas_Alias (the <b>adm</b> and <b>oper</b> groups).</p>
<p class="Pp">The user <b>pete</b> is allowed to change anyone's password except
    for root on the <i>HPPA</i> machines. Because command line arguments are
    matched as a single, concatenated string, the &#x2018;*&#x2019; wildcard
    will match <i>multiple</i> words. This example assumes that passwd(1) does
    not take multiple user names on the command line. Note that on GNU systems,
    options to passwd(1) may be specified after the user argument. As a result,
    this rule will also allow:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
passwd username --expire
</pre>
</div>
<pre>
</pre>
<p class="Pp">which may not be desirable.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
bob		SPARC = (OP) ALL : SGI = (OP) ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>bob</b> may run anything on the <i>SPARC</i> and
    <i>SGI</i> machines as any user listed in the <i>OP</i> Runas_Alias
    (<b>root</b> and <b>operator</b>.)</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
jim		+biglab = ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>jim</b> may run any command on machines in the
    <i>biglab</i> netgroup. <b>sudo</b> knows that &#x201C;biglab&#x201D; is a
    netgroup due to the &#x2018;+&#x2019; prefix.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
+secretaries	ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser
</pre>
</div>
<pre>
</pre>
<p class="Pp">Users in the <b>secretaries</b> netgroup need to help manage the
    printers as well as add and remove users, so they are allowed to run those
    commands on all machines.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
fred		ALL = (DB) NOPASSWD: ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>fred</b> can run commands as any user in the <i>DB</i>
    Runas_Alias (<b>oracle</b> or <b>sybase</b>) without giving a password.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
john		ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*
</pre>
</div>
<pre>
</pre>
<p class="Pp">On the <i>ALPHA</i> machines, user <b>john</b> may su to anyone
    except root but he is not allowed to specify any options to the su(1)
    command.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
jen		ALL, !SERVERS = ALL
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>jen</b> may run any command on any machine except for
    those in the <i>SERVERS</i> Host_Alias (master, mail, www and ns).</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
jill		SERVERS = /usr/bin/, !SU, !SHELLS
</pre>
</div>
<pre>
</pre>
<p class="Pp">For any machine in the <i>SERVERS</i> Host_Alias, <b>jill</b> may
    run any commands in the directory <i>/usr/bin/</i> except for those commands
    belonging to the <i>SU</i> and <i>SHELLS</i> Cmnd_Aliases. While not
    specifically mentioned in the rule, the commands in the <i>PAGERS</i>
    Cmnd_Alias all reside in <i>/usr/bin</i> and have the <i>noexec</i> option
    set.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
steve		CSNETS = (operator) /usr/local/op_commands/
</pre>
</div>
<pre>
</pre>
<p class="Pp">The user <b>steve</b> may run any command in the directory
    /usr/local/op_commands/ but only as user operator.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
matt		valkyrie = KILL
</pre>
</div>
<pre>
</pre>
<p class="Pp">On his personal workstation, valkyrie, <b>matt</b> needs to be
    able to kill hung processes.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
WEBMASTERS	www = (www) ALL, (root) /usr/bin/su www
</pre>
</div>
<pre>
</pre>
<p class="Pp">On the host www, any user in the <i>WEBMASTERS</i> User_Alias
    (will, wendy, and wim), may run any command as user www (which owns the web
    pages) or simply su(1) to www.</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
ALL		CDROM = NOPASSWD: /sbin/umount /CDROM,\
		/sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM
</pre>
</div>
<pre>
</pre>
<p class="Pp">Any user may mount or unmount a CD-ROM on the machines in the
    CDROM Host_Alias (orion, perseus, hercules) without entering a password.
    This is a bit tedious for users to type, so it is a prime candidate for
    encapsulating in a shell script.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SECURITY_NOTES"><a class="permalink" href="#SECURITY_NOTES">SECURITY
  NOTES</a></h1>
<section class="Ss">
<h2 class="Ss" id="Limitations_of_the__(oq!_&amp;_(cq_operator"><a class="permalink" href="#Limitations_of_the__(oq!_&amp;_(cq_operator">Limitations
  of the &#x2018;!&#x2019; operator</a></h2>
It is generally not effective to &#x201C;subtract&#x201D; commands from
  <b>ALL</b> using the &#x2018;!&#x2019; operator. A user can trivially
  circumvent this by copying the desired command to a different name and then
  executing that. For example:
<pre>

</pre>
<div class="Bd-indent">
<pre>
bill	ALL = ALL, !SU, !SHELLS
</pre>
</div>
<pre>
</pre>
<p class="Pp">Doesn't really prevent <b>bill</b> from running the commands
    listed in <i>SU</i> or <i>SHELLS</i> since he can simply copy those commands
    to a different name, or use a shell escape from an editor or other program.
    Therefore, these kind of restrictions should be considered advisory at best
    (and reinforced by policy).</p>
<p class="Pp">In general, if a user has sudo <b>ALL</b> there is nothing to
    prevent them from creating their own program that gives them a root shell
    (or making their own copy of a shell) regardless of any &#x2018;!&#x2019;
    elements in the user specification.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Security_implications_of__fIfast_glob_fR"><a class="permalink" href="#Security_implications_of__fIfast_glob_fR">Security
  implications of <i>fast_glob</i></a></h2>
If the <i>fast_glob</i> option is in use, it is not possible to reliably negate
  commands where the path name includes globbing (aka wildcard) characters. This
  is because the C library's fnmatch(3) function cannot resolve relative paths.
  While this is typically only an inconvenience for rules that grant privileges,
  it can result in a security issue for rules that subtract or revoke
  privileges.
<p class="Pp">For example, given the following <i>sudoers</i> file entry:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
john	ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,\
              /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root
</pre>
</div>
<pre>
</pre>
<p class="Pp">User <b>john</b> can still run /usr/bin/passwd root if
    <i>fast_glob</i> is enabled by changing to <i>/usr/bin</i> and running
    ./passwd root instead.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Preventing_shell_escapes"><a class="permalink" href="#Preventing_shell_escapes">Preventing
  shell escapes</a></h2>
Once <b>sudo</b> executes a program, that program is free to do whatever it
  pleases, including run other programs. This can be a security issue since it
  is not uncommon for a program to allow shell escapes, which lets a user bypass
  <b>sudo</b>'s access control and logging. Common programs that permit shell
  escapes include shells (obviously), editors, paginators, mail and terminal
  programs.
<p class="Pp">There are two basic approaches to this problem:</p>
<dl class="Bl-tag">
  <dt>restrict</dt>
  <dd>Avoid giving users access to commands that allow the user to run arbitrary
      commands. Many editors have a restricted mode where shell escapes are
      disabled, though <b>sudoedit</b> is a better solution to running editors
      via <b>sudo</b>. Due to the large number of programs that offer shell
      escapes, restricting users to the set of programs that do not is often
      unworkable.</dd>
  <dt>noexec</dt>
  <dd>Many systems that support shared libraries have the ability to override
      default library functions by pointing an environment variable (usually
      LD_PRELOAD) to an alternate shared library. On such systems, <b>sudo</b>'s
      <i>noexec</i> functionality can be used to prevent a program run by
      <b>sudo</b> from executing any other programs. Note, however, that this
      applies only to native dynamically-linked executables. Statically-linked
      executables and foreign executables running under binary emulation are not
      affected.
    <p class="Pp">The <i>noexec</i> feature is known to work on SunOS, Solaris,
        *BSD, Linux, IRIX, Tru64 UNIX, MacOS X, HP-UX 11.x and AIX 5.3 and
        above. It should be supported on most operating systems that support the
        LD_PRELOAD environment variable. Check your operating system's manual
        pages for the dynamic linker (usually ld.so, ld.so.1, dyld, dld.sl, rld,
        or loader) to see if LD_PRELOAD is supported.</p>
    <p class="Pp">To enable <i>noexec</i> for a command, use the NOEXEC tag as
        documented in the User Specification section above. Here is that example
        again:</p>
    <pre>

    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>
aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi
</pre>
</div>
<pre>
</pre>
<div class="Bd-indent">
<p class="Pp">This allows user <b>aaron</b> to run <i>/usr/bin/more</i> and
    <i>/usr/bin/vi</i> with <i>noexec</i> enabled. This will prevent those two
    commands from executing other commands (such as a shell). If you are unsure
    whether or not your system is capable of supporting <i>noexec</i> you can
    always just try it out and check whether shell escapes work when
    <i>noexec</i> is enabled.</p>
</div>
<p class="Pp">Note that restricting shell escapes is not a panacea. Programs
    running as root are still capable of many potentially hazardous operations
    (such as changing or overwriting files) that could lead to unintended
    privilege escalation. In the specific case of an editor, a safer approach is
    to give the user permission to run <b>sudoedit</b> (see below).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Secure_editing"><a class="permalink" href="#Secure_editing">Secure
  editing</a></h2>
The <b>sudoers</b> plugin includes <b>sudoedit</b> support which allows users to
  securely edit files with the editor of their choice. As <b>sudoedit</b> is a
  built-in command, it must be specified in the <i>sudoers</i> file without a
  leading path. However, it may take command line arguments just as a normal
  command does. Wildcards used in <i>sudoedit</i> command line arguments are
  expected to be path names, so a forward slash (&#x2018;/&#x2019;) will not be
  matched by a wildcard.
<p class="Pp">Unlike other <b>sudo</b> commands, the editor is run with the
    permissions of the invoking user and with the environment unmodified. More
    information may be found in the description of the <b>-e</b> option in
    sudo(8).</p>
<p class="Pp">For example, to allow user operator to edit the &#x201C;message of
    the day&#x201D; file:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
operator	sudoedit /etc/motd
</pre>
</div>
<pre>
</pre>
<p class="Pp">The operator user then runs <b>sudoedit</b> as follows:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
$ sudoedit /etc/motd
</pre>
</div>
<pre>
</pre>
<p class="Pp">The editor will run as the operator user, not root, on a temporary
    copy of <i>/etc/motd</i>. After the file has been edited, <i>/etc/motd</i>
    will be updated with the contents of the temporary copy.</p>
<p class="Pp">Users should <i>never</i> be granted <b>sudoedit</b> permission to
    edit a file that resides in a directory the user has write access to, either
    directly or via a wildcard. If the user has write access to the directory it
    is possible to replace the legitimate file with a link to another file,
    allowing the editing of arbitrary files. To prevent this, starting with
    version 1.8.16, symbolic links will not be followed in writable directories
    and <b>sudoedit</b> will refuse to edit a file located in a writable
    directory unless the <i>sudoedit_checkdir</i> option has been disabled or
    the invoking user is root. Additionally, in version 1.8.15 and higher,
    <b>sudoedit</b> will refuse to open a symbolic link unless either the
    <i>sudoedit_follow</i> option is enabled or the <i>sudoedit</i> command is
    prefixed with the FOLLOW tag in the <i>sudoers</i> file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Time_stamp_file_checks"><a class="permalink" href="#Time_stamp_file_checks">Time
  stamp file checks</a></h2>
<b>sudoers</b> will check the ownership of its time stamp directory
  (<i>/var/db/sudo/ts</i> by default) and ignore the directory's contents if it
  is not owned by root or if it is writable by a user other than root. Older
  versions of <b>sudo</b> stored time stamp files in <i>/tmp</i>; this is no
  longer recommended as it may be possible for a user to create the time stamp
  themselves on systems that allow unprivileged users to change the ownership of
  files they create.
<p class="Pp">While the time stamp directory <i>should</i> be cleared at reboot
    time, not all systems contain a <i>/var/run</i> directory. To avoid
    potential problems, <b>sudoers</b> will ignore time stamp files that date
    from before the machine booted on systems where the boot time is
  available.</p>
<p class="Pp">Some systems with graphical desktop environments allow
    unprivileged users to change the system clock. Since <b>sudoers</b> relies
    on the system clock for time stamp validation, it may be possible on such
    systems for a user to run <b>sudo</b> for longer than
    <i>timestamp_timeout</i> by setting the clock back. To combat this,
    <b>sudoers</b> uses a monotonic clock (which never moves backwards) for its
    time stamps if the system supports it.</p>
<p class="Pp"><b>sudoers</b> will not honor time stamps set far in the future.
    Time stamps with a date greater than current_time + 2 * TIMEOUT will be
    ignored and <b>sudoers</b> will log and complain.</p>
<p class="Pp">Since time stamp files live in the file system, they can outlive a
    user's login session. As a result, a user may be able to login, run a
    command with <b>sudo</b> after authenticating, logout, login again, and run
    <b>sudo</b> without authenticating so long as the record's time stamp is
    within 5 minutes (or whatever value the timeout is set to in the
    <i>sudoers</i> file). When the <i>tty_tickets</i> option is enabled, the
    time stamp record includes the device number of the terminal the user
    authenticated with. This provides per-tty granularity but time stamp records
    still may outlive the user's session. The time stamp record also includes
    the session ID of the process that last authenticated. This prevents
    processes in different terminal sessions from using the same time stamp
    record. It also helps reduce the chance that a user will be able to run
    <b>sudo</b> without entering a password when logging out and back in again
    on the same terminal.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DEBUGGING"><a class="permalink" href="#DEBUGGING">DEBUGGING</a></h1>
Versions 1.8.4 and higher of the <b>sudoers</b> plugin support a flexible
  debugging framework that can help track down what the plugin is doing
  internally if there is a problem. This can be configured in the sudo.conf(5)
  file.
<p class="Pp">The <b>sudoers</b> plugin uses the same debug flag format as the
    <b>sudo</b> front-end: <i>subsystem</i>@<i>priority</i>.</p>
<p class="Pp">The priorities used by <b>sudoers</b>, in order of decreasing
    severity, are: <i>crit</i>, <i>err</i>, <i>warn</i>, <i>notice</i>,
    <i>diag</i>, <i>info</i>, <i>trace</i> and <i>debug</i>. Each priority, when
    specified, also includes all priorities higher than it. For example, a
    priority of <i>notice</i> would include debug messages logged at
    <i>notice</i> and higher.</p>
<p class="Pp">The following subsystems are used by the <b>sudoers</b>
  plugin:</p>
<dl class="Bl-tag">
  <dt><i>alias</i></dt>
  <dd>User_Alias, Runas_Alias, Host_Alias and Cmnd_Alias processing</dd>
  <dt><i>all</i></dt>
  <dd>matches every subsystem</dd>
  <dt><i>audit</i></dt>
  <dd>BSM and Linux audit code</dd>
  <dt><i>auth</i></dt>
  <dd>user authentication</dd>
  <dt><i>defaults</i></dt>
  <dd><i>sudoers</i> file <i>Defaults</i> settings</dd>
  <dt><i>env</i></dt>
  <dd>environment handling</dd>
  <dt><i>ldap</i></dt>
  <dd>LDAP-based sudoers</dd>
  <dt><i>logging</i></dt>
  <dd>logging support</dd>
  <dt><i>match</i></dt>
  <dd>matching of users, groups, hosts and netgroups in the <i>sudoers</i>
    file</dd>
  <dt><i>netif</i></dt>
  <dd>network interface handling</dd>
  <dt><i>nss</i></dt>
  <dd>network service switch handling in <b>sudoers</b></dd>
  <dt><i>parser</i></dt>
  <dd><i>sudoers</i> file parsing</dd>
  <dt><i>perms</i></dt>
  <dd>permission setting</dd>
  <dt><i>plugin</i></dt>
  <dd>The equivalent of <i>main</i> for the plugin.</dd>
  <dt><i>pty</i></dt>
  <dd>pseudo-tty related code</dd>
  <dt><i>rbtree</i></dt>
  <dd>redblack tree internals</dd>
  <dt><i>sssd</i></dt>
  <dd>SSSD-based sudoers</dd>
  <dt><i>util</i></dt>
  <dd>utility functions</dd>
</dl>
<p class="Pp">For example:</p>
<pre>

</pre>
<div class="Bd-indent">
<pre>
Debug sudo /var/log/sudo_debug match@info,nss@info
</pre>
</div>
<pre>
</pre>
<p class="Pp">For more information, see the sudo.conf(5) manual.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
ssh(1), su(1), fnmatch(3), glob(3), mktemp(3), strftime(3), sudo.conf(5),
  sudoers.ldap(5), sudo(8), sudo_plugin(8), visudo(8)
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
Many people have worked on <b>sudo</b> over the years; this version consists of
  code written primarily by:
<p class="Pp"></p>
<div class="Bd-indent">Todd C. Miller</div>
<p class="Pp">See the CONTRIBUTORS file in the <b>sudo</b> distribution
    (https://www.sudo.ws/contributors.html) for an exhaustive list of people who
    have contributed to <b>sudo</b>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
The <i>sudoers</i> file should <b>always</b> be edited by the <b>visudo</b>
  command which locks the file and does grammatical checking. It is imperative
  that the <i>sudoers</i> file be free of syntax errors since <b>sudo</b> will
  not run with a syntactically incorrect <i>sudoers</i> file.
<p class="Pp">When using netgroups of machines (as opposed to users), if you
    store fully qualified host name in the netgroup (as is usually the case),
    you either need to have the machine's host name be fully qualified as
    returned by the hostname command or use the <i>fqdn</i> option in
    <i>sudoers</i>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
If you feel you have found a bug in <b>sudo</b>, please submit a bug report at
  https://bugzilla.sudo.ws/
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
Limited free support is available via the sudo-users mailing list, see
  https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the
  archives.
</section>
<section class="Sh">
<h1 class="Sh" id="DISCLAIMER"><a class="permalink" href="#DISCLAIMER">DISCLAIMER</a></h1>
<b>sudo</b> is provided &#x201C;AS IS&#x201D; and any express or implied
  warranties, including, but not limited to, the implied warranties of
  merchantability and fitness for a particular purpose are disclaimed. See the
  LICENSE file distributed with <b>sudo</b> or https://www.sudo.ws/license.html
  for complete details.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 20, 2016</td>
    <td class="foot-os">Sudo 1.8.17p1</td>
  </tr>
</table>
</body>
</html>
