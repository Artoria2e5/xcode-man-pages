<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2000-2019 Apple Inc. All rights reserved.
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>leaks(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">leaks(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">leaks(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">leaks</code> &#x2014;
<div class="Nd">Search a process's memory for unreferenced malloc buffers</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">leaks</code></td>
    <td>[options] <var class="Ar">pid</var> |
      <var class="Ar">partial-executable-name</var> |
      <var class="Ar">memory-graph-file</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">leaks</code></td>
    <td>[options] <code class="Fl">-atExit</code> <code class="Fl">--</code>
      <var class="Ar">command</var></td>
  </tr>
</table>
<section class="Ss">
<h2 class="Ss" id="Options:"><a class="permalink" href="#Options:">Options:</a></h2>
[<code class="Fl">-list</code>] [<code class="Fl">-groupByType</code>]
  [<code class="Fl">-nocontext</code>] [<code class="Fl">-nostacks</code>]
  [<code class="Fl">-nosources</code>] [<code class="Fl">-quiet</code>]
  [<code class="Fl">-exclude</code> <var class="Ar">symbol</var>]
  [<code class="Fl">-traceTree</code> <var class="Ar">address</var>]
  [<code class="Fl">-outputGraph</code> <var class="Ar">path</var>]
  [<code class="Fl">-fullContent</code>]
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<code class="Nm">leaks</code> identifies leaked memory -- memory that the
  application has allocated, but has been lost and cannot be freed.
  Specifically, <code class="Nm">leaks</code> examines a specified process's
  memory for values that may be pointers to malloc-allocated buffers. Any buffer
  reachable from a pointer in writable global memory (e.g., __DATA segments), a
  register, or on the stack is assumed to be memory in use. Any buffer reachable
  from a pointer in a reachable malloc-allocated buffer is also assumed to be in
  use. The buffers which are not reachable are leaks; the buffers could never be
  freed because no pointer exists in memory to the buffer, and thus free() could
  never be called for these buffers. Such buffers waste memory; removing them
  can reduce swapping and memory usage. Leaks are particularly dangerous for
  long-running programs, for eventually the leaks could fill memory and cause
  the application to crash.
<p class="Pp"><code class="Nm">leaks</code> requires one argument -- either the
    process ID or the full or partial executable name of the process to examine,
    or the pathname of a memory graph file generated by
    <code class="Nm">leaks</code> or the Xcode Memory Graph Debugger. (Unless
    the <code class="Fl">-atExit</code> <code class="Fl">--</code>
    <var class="Ar">command</var> argument is given, see below for more
    details.)</p>
<p class="Pp">Once the leaked buffers have been identified,
    <code class="Nm">leaks</code> analyzes them to find &quot;root leaks&quot;
    (those which are not referenced by any other buffer) and &quot;root
    cycles&quot; (cycles of objects which reference or retain each other, but
    which are not referenced by any other buffer outside the cycle). Then, it
    identifies the tree of buffers which are referenced by those root leaks and
    root cycles, if any. <code class="Nm">leaks</code> then prints each such
    &quot;leak tree&quot;.</p>
<p class="Pp">If the MallocStackLogging environment variable was set when the
    application was launched, <code class="Nm">leaks</code> also prints a stack
    trace describing where the buffer was allocated.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="MEMORY_GRAPH_FILES"><a class="permalink" href="#MEMORY_GRAPH_FILES">MEMORY
  GRAPH FILES</a></h1>
A memory graph file archives the memory state of a process for further analysis
  at a later time, on a different machine, or by other people. It includes
  information about all VM and malloc nodes in the process, and the references
  between them. Memory graph files can be generated by
  <code class="Nm">leaks</code> using the <code class="Fl">-outputGraph</code>
  option (and the <code class="Fl">-fullContent</code> option if desired), or by
  examining a live process with the Xcode Memory Graph Debugger then using the
  Export Memory Graph menu item from the File menu. The standard filename suffix
  for memory graph files is &quot;.memgraph&quot;. These files can be used as
  input to various commands including <code class="Nm">leaks,</code>
  <code class="Nm">heap,</code> <code class="Nm">stringdups,</code>
  <code class="Nm">vmmap,</code> <code class="Nm">malloc_history,</code>
  <code class="Nm">footprint,</code> and the Xcode Memory Graph Debugger.
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt><a class="permalink" href="#list"><code class="Fl" id="list">-list</code></a></dt>
  <dd>Print the leaks as a list (&quot;classic&quot;-style) rather than as a
      tree. Warning: this option may be removed in the future.</dd>
  <dt><a class="permalink" href="#groupByType"><code class="Fl" id="groupByType">-groupByType</code></a></dt>
  <dd>When printing a tree of leaked objects, group the children of a node in
      the tree by type, rather than showing individual instances.</dd>
  <dt><a class="permalink" href="#nocontext"><code class="Fl" id="nocontext">-nocontext</code></a></dt>
  <dd>Do not print the string or hex representation of leaked memory. Although
      that information can be useful for recognizing the contents of the buffer
      and understanding why it might be leaked, it can also provide overwhelming
      detail, and could expose confidential information from your process if
      you, for example, file bug reports with that output included.</dd>
  <dt><a class="permalink" href="#nostacks"><code class="Fl" id="nostacks">-nostacks</code></a></dt>
  <dd>Do not print backtraces of leaked blocks even if the target process has
      the MallocStackLogging environment variable set.</dd>
  <dt><a class="permalink" href="#nosources"><code class="Fl" id="nosources">-nosources</code></a></dt>
  <dd>Do not print sourceFile:lineNumber in backtraces. This can improve
      performance when examining a process with a huge number of debug
    symbols.</dd>
  <dt><a class="permalink" href="#quiet"><code class="Fl" id="quiet">-quiet</code></a></dt>
  <dd>Do not print process description header or binary image list.</dd>
  <dt><a class="permalink" href="#exclude"><code class="Fl" id="exclude">-exclude</code></a>
    <var class="Ar">symbol</var></dt>
  <dd>Exclude leaked blocks whose backtraces include the specified symbol. This
      option can be repeated for multiple symbols. This allows ignoring leaks
      that, for example, are allocated in libraries for which you do not have
      source code.</dd>
  <dt><a class="permalink" href="#traceTree"><code class="Fl" id="traceTree">-traceTree</code></a>
    <var class="Ar">address</var></dt>
  <dd>Print a reverse tree of references, from the given block up to the process
      'roots' (e.g., global data, registers, or locations on stacks) to the
      given block. This is useful for determining what is holding onto a buffer
      such that it has not been freed, and is similar to the information shown
      in the Xcode Memory Graph Debugger.</dd>
  <dt><a class="permalink" href="#outputGraph"><code class="Fl" id="outputGraph">-outputGraph</code></a>
    <var class="Ar">path</var></dt>
  <dd>Generate a memory graph file containing information about all VM and
      malloc nodes, and the references between them. <var class="Ar">path</var>
      can be a path to a file, or just a directory name; in the latter case a
      filename with the &quot;.memgraph&quot; suffix will be generated.</dd>
  <dt><a class="permalink" href="#fullContent"><code class="Fl" id="fullContent">-fullContent</code></a></dt>
  <dd>When generating a memory graph file, include descriptions of the content
      of various objects, as would be shown by &quot;heap &lt;pid&gt; -addresses
      all&quot;, and as needed by &quot;stringdups &lt;pid&gt;&quot;.</dd>
  <dt><a class="permalink" href="#atExit"><code class="Fl" id="atExit">-atExit</code></a>
    <code class="Fl">--</code> <var class="Ar">command</var></dt>
  <dd>Launches the specified command and runs <code class="Nm">leaks</code> when
      that process exits. The <code class="Fl">-atExit</code> argument should be
      the last argument, followed by -- and the command to launch. For example:
    <div class="Bd Pp">
    <pre>
% leaks -quiet -atExit -- /bin/ls -lt /tmp/
    </pre>
    </div>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
The <code class="Nm">leaks</code> command may detect more leaks if the target
  process is run with the MallocScribble environment variable. If this variable
  is set then when malloc blocks are deallocated they are filled with 0x55
  bytes, thus overwriting any &quot;stale&quot; data such as pointers remaining
  in those blocks. This reduces the number of false pointers remaining in the
  process memory.
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_STATUS"><a class="permalink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
The <code class="Nm">leaks</code> command exits with one of the following
  values:
<p class="Pp"></p>
<dl class="Bl-tag Bl-compact">
  <dt><a class="permalink" href="#0"><code class="Li" id="0">0</code></a></dt>
  <dd>No leaks were detected.</dd>
  <dt><a class="permalink" href="#1"><code class="Li" id="1">1</code></a></dt>
  <dd>One or more leaks were detected.</dd>
  <dt><a class="permalink" href="#_1"><code class="Li" id="_1">&gt;1</code></a></dt>
  <dd>An error occurred.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr">malloc(3)</a>, <a class="Xr">heap(1)</a>,
  <a class="Xr">malloc_history(1)</a>, <a class="Xr">stringdups(1)</a>,
  <a class="Xr">vmmap(1)</a>, <a class="Xr">footprint(1)</a>,
  <a class="Xr">DevToolsSecurity(1)</a>
<p class="Pp">The Xcode Memory Graph Debuggger graphically shows malloc blocks
    and VM regions (both leaked and non-leaked), and the references between
    them.</p>
<p class="Pp">The Xcode developer tools also include Instruments, a graphical
    application that can give information similar to that provided by
    <code class="Nm">leaks.</code> The Allocations instrument graphically
    displays dynamic, real-time information about the object and memory use in
    an application, including backtraces of where the allocations occurred. The
    Leaks instrument performs memory leak analysis.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">June 9, 2019</td>
    <td class="foot-os">Mac OS X 10.15</td>
  </tr>
</table>
</body>
</html>
