<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   t
   @(#)tnameserv.1 1.6 00/06/13 SMI;
   Copyright 2004 Sun Microsystems, Inc. All rights reserved.
   Copyright 2004 Sun Microsystems, Inc. Tous droits r\[u00E9]serv\[u00E9]s.
   -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>tnameserv(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">tnameserv(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">tnameserv(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
tnameserv - Java IDL name server starter script
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>tnameserv</b> <b>-ORBInitialPort</b><i> portNumber</i>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <small>CORBA COS</small> (Common Object Services) Naming Service provides a
  tree-like directory for object references much like a filesystem provides a
  directory structure for files. The Naming Service provided with Java
  <small>IDL</small> is a simple implementation of the <small>COS</small> Naming
  Service specification.
<p class="Pp">Object references are stored in the namespace by name and each
    object reference-name pair is called a name binding. Name bindings may be
    organized under naming contexts. Naming contexts are themselves name
    bindings and serve the same organizational function as a file system
    subdirectory. All bindings are stored under the initial naming context. The
    initial naming context is the only persistent binding in the namespace; the
    rest of the namespace is lost if the Java <small>IDL</small> name server
    process halts and restarts.</p>
<p class="Pp">For an applet or application to use <small>COS</small> naming, its
    <small>ORB</small> must know the name and port of a host running a naming
    service or have access to a stringified initial naming context for that name
    server. The naming service can either be the Java <small>IDL</small> name
    server or another <small>COS-compliant</small> name service.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="USAGE"><a class="permalink" href="#USAGE">USAGE</a></h1>
<section class="Ss">
<h2 class="Ss" id="Starting_the_Java_IDL_Name_Server"><a class="permalink" href="#Starting_the_Java_IDL_Name_Server">Starting
  the Java IDL Name Server</a></h2>
You must start the Java <small>IDL</small> name server before an application or
  applet that uses its naming service. Installation of the Java
  <small>IDL</small> product creates a script named tnameserv that starts the
  Java <small>IDL</small> name server. Start the name server so it runs in the
  background.
<p class="Pp">If you do not specify otherwise, the Java <small>IDL</small> name
    server listens on port 900 for the bootstrap protocol used to implement the
    <small>ORB</small> <b>resolve_initial_references()</b> and
    <b>list_initial_references()</b> methods. Specify a different port, for
    example, <b>1050</b>, as follows:</p>
<p class="Pp"></p>
<div class="Bd-indent"><b>example% tnameserv -ORBInitialPort 1050</b></div>
<p class="Pp">Clients of the name server must be made aware of the new port
    number. Do this by setting the <b>org.omg.CORBA.ORBInitialPort</b> property
    to the new port number when creating the <small>ORB</small> object.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Stopping_the_Java_IDL_Name_Server"><a class="permalink" href="#Stopping_the_Java_IDL_Name_Server">Stopping
  the Java IDL Name Server</a></h2>
To stop the Java <small>IDL</small> name server, use the relevant operating
  system command, such as <b>kill</b>(1). Note that names registered with the
  Java <small>IDL</small> name service disappear when the server is terminated.
</section>
<section class="Ss">
<h2 class="Ss" id="Sample_Client:_Adding_Objects"><a class="permalink" href="#Sample_Client:_Adding_Objects">Sample
  Client: Adding Objects</a></h2>
The following sample program illustrates how to add names to the namespace. It
  is a self-contained Name Server client that creates the following simple tree.
<br/>
<b></b>
<pre>
        Initial
     Naming Context
       /      \
      /        \
   plans      personal
                /\
               /  \
        calendar   schedule
</pre>
In this example, &quot;plans&quot; is an object reference and
  &quot;personal&quot; is a naming context that contains two object references:
  &quot;calendar&quot; and &quot;schedule&quot;. <b></b>
<pre>
import java.util.Properties;
import org.omg.CORBA.*;
import org.omg.CosNaming.*;
public class NameClient
{
   public static void main(String args[])
   {
      try {
</pre>
In the above section, <b>Starting the Java IDL Name Server</b>, the nameserver
  was started on port <b>1050</b>. The following code ensures that the client
  program is aware of this port number. <b></b>
<pre>
        Properties props = new Properties();
        props.put(&quot;org.omg.CORBA.ORBInitialPort&quot;, &quot;1050&quot;);
        ORB orb = ORB.init(args, props);
</pre>
The following code obtains the initial naming context and assigns it to
  <b>ctx</b>. The second line copies <b>ctx</b> into a dummy object reference,
  <b>objref</b>, that we will attach to various names and add into the
  namespace. <b></b>
<pre>
        NamingContext ctx = NamingContextHelper.narrow
            (orb.resolve_initial_references(&quot;NameService&quot;));
        NamingContext objref = ctx;
</pre>
The following code creates a name &quot;plans&quot; of type &quot;text&quot; and
  binds it to our dummy object reference. &quot;plans&quot; is then added under
  the initial naming context using <b>rebind</b>. The <b>rebind</b> method
  allows us to run this program over and over again without getting the
  exceptions we would get from using <b>bind</b>. <b></b>
<pre>
        NameComponent nc1 = new NameComponent(&quot;plans&quot;, &quot;text&quot;);
        NameComponent[] name1 = {nc1};
        ctx.rebind(name1, objref);
        System.out.println(&quot;plans rebind sucessful!&quot;);
</pre>
The following code creates a naming context called &quot;Personal&quot; of type
  &quot;directory&quot;. The resulting object reference, <b>ctx2</b>, is bound
  to the name and added under the initial naming context. <b></b>
<pre>
        NameComponent nc2 = new NameComponent(&quot;Personal&quot;, &quot;directory&quot;);
        NameComponent[] name2 = {nc2};
        NamingContext ctx2 = ctx.bind_new_context(name2);
        System.out.println(&quot;new naming context added..&quot;);
</pre>
The remainder of the code binds the dummy object reference using the names
  &quot;schedule&quot; and &quot;calendar&quot; under the &quot;Personal&quot;
  naming context (<b>ctx2</b>). <b></b>
<pre>
        NameComponent nc3 = new NameComponent(&quot;schedule&quot;, &quot;text&quot;);
        NameComponent[] name3 = {nc3};
        ctx2.rebind(name3, objref);
        System.out.println(&quot;schedule rebind sucessful!&quot;);
        NameComponent nc4 = new NameComponent(&quot;calender&quot;, &quot;text&quot;);
        NameComponent[] name4 = {nc4};
        ctx2.rebind(name4, objref);
        System.out.println(&quot;calender rebind sucessful!&quot;);
    } catch (Exception e) {
        e.printStackTrace(System.err);
    }
  }
}
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Sample_Client:_Browsing_the_Namespace"><a class="permalink" href="#Sample_Client:_Browsing_the_Namespace">Sample
  Client: Browsing the Namespace</a></h2>
The following sample program illustrates how to browse the namespace. <b></b>
<pre>
import java.util.Properties;
import org.omg.CORBA.*;
import org.omg.CosNaming.*;
public class NameClientList
{
   public static void main(String args[])
   {
      try {
</pre>
In the above section, <b>Starting the Java IDL Name Server</b>, the nameserver
  was started on port <b>1050</b>. The following code ensures that the client
  program is aware of this port number. <b></b>
<pre>
        Properties props = new Properties();
        props.put(&quot;org.omg.CORBA.ORBInitialPort&quot;, &quot;1050&quot;);
        ORB orb = ORB.init(args, props);
</pre>
The following code obtains the initial naming context. <b></b>
<pre>
        NamingContext nc = NamingContextHelper.narrow
           (orb.resolve_initial_references(&quot;NameService&quot;));
</pre>
The list method lists the bindings in the naming context. In this case, up to
  1000 bindings from the initial naming context will be returned in the
  <b>BindingListHolder</b>; any remaining bindings are returned in the
  <b>BindingIteratorHolder</b>. <b></b>
<pre>
        BindingListHolder bl = new BindingListHolder();
        BindingIteratorHolder blIt= new BindingIteratorHolder();
        nc.list(1000, bl, blIt);
</pre>
The following code gets the array of bindings out of the returned
  <b>BindingListHolder</b>. If there are no bindings, the program ends. <b></b>
<pre>
        Binding bindings[] = bl.value;
        if (bindings.length == 0) return;
</pre>
The remainder of the code loops through the bindings and prints the names out.
  <b></b>
<pre>
        for (int i=0; i &lt; bindings.length; i++) {
            // get the object reference for each binding
            org.omg.CORBA.Object obj = nc.resolve
				 (bindings[i].binding_name);
            String objStr = orb.object_to_string(obj);
            int lastIx = bindings[i].binding_name.length-1;
            // check to see if this is a naming context
            if (bindings[i].binding_type == BindingType.ncontext) {
              System.out.println
				 (&quot;Context: &quot; + bindings[i].binding_name[lastIx].id);
            } else {
                System.out.println
				   (&quot;Object: &quot; + bindings[i].binding_name[lastIx].id);
            }
        }
       } catch (Exception e) {
        e.printStackTrace(System.err);
       }
   }
}
</pre>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>kill</b>(1)
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">13 June 2000</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
