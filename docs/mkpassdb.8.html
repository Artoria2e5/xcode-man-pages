<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
       $Id: mkpassdb.8,v 1.18 2006/03/15 20:07:43 snsimon Exp $
  
   Copyright (c) 2002 Apple Computer, Inc., all rights reserved.
   Distributed only as part of Mac OS X Server
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>mkpassdb(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">mkpassdb(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">mkpassdb(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">mkpassdb</code> &#x2014;
<div class="Nd">Mac OS X Server Password Server database creation tool</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-deleteslot</code> <var class="Ar">slot-ID</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-dump</code> [-v]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-dump</code> [slot-ID]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-header</code></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-kerberize</code></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-key</code></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-list</code></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-mergedb</code> <var class="Ar">path</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-mergeparent</code> <var class="Ar">path</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setadmin</code> <var class="Ar">slot-ID</var>
      [admin-class (0-7)]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setglobalpolicy</code> &quot;policy1=value1
      policy2=value2 etc.&quot;</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setkerberos</code> <var class="Ar">slot-ID</var>
      <var class="Ar">KerberosRealm</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setkeyagent</code> <var class="Ar">slot-ID</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setcomputeraccount</code> [off]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setrealm</code> <var class="Ar">realm</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-getreplicationinterval</code></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-setreplicationinterval</code>
      <var class="Ar">seconds</var> [policy]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td><code class="Fl">-rekeydb</code> [key-size-in-bits]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">mkpassdb</code></td>
    <td>[<code class="Fl">-u</code> <var class="Ar">user</var>]
      [<code class="Fl">-m</code> <var class="Ar">mech</var>]
      [<code class="Fl">-a</code>] [<code class="Fl">-b</code>]
      [<code class="Fl">-e</code> <var class="Ar">count</var>]
      [<code class="Fl">-n</code> <var class="Ar">replica-name</var>]
      [<code class="Fl">-o</code>] [<code class="Fl">-p</code>]
      [<code class="Fl">-q</code>]</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<code class="Nm">mkpassdb</code> creates or modifies the password server
  database directly.
<p class="Pp"><code class="Nm">mkpassdb</code> must be run as root; it will exit
    otherwise. The <code class="Fl">-list</code> command is the only
  exception.</p>
<p class="Pp">This tool's purpose is to create and manage the password server
    database. It performs operations that are not supported by the password
    server protocol because of security concerns. These operations include the
    creation and destruction of the database itself, the creation of the RSA
    security keys that establish the identity of the password server, the
    trusted mechanism list, and the genesis of administrator accounts. It also
    allows the root account to make some password server changes on the local
    system.</p>
<p class="Pp"></p>
<dl class="Bl-tag Bl-compact">
  <dt><a class="permalink" href="#deleteslot"><code class="Fl" id="deleteslot">-deleteslot</code></a></dt>
  <dd>Invalidates a slot ID in the database.</dd>
  <dt><a class="permalink" href="#dump"><code class="Fl" id="dump">-dump</code></a></dt>
  <dd>Outputs all of the User IDs and their corresponding user names. If a
      slot-ID is specified, it prints out more detailed information for a single
      slot. If the [-v] option is used, additional columns are included.</dd>
  <dt><a class="permalink" href="#header"><code class="Fl" id="header">-header</code></a></dt>
  <dd>Outputs the database header information.</dd>
  <dt><a class="permalink" href="#kerberize"><code class="Fl" id="kerberize">-kerberize</code></a></dt>
  <dd>Attempts to add kerberos principals for all non-kerberos accounts in
      password server.</dd>
  <dt><a class="permalink" href="#key"><code class="Fl" id="key">-key</code></a></dt>
  <dd>Outputs the RSA public key stored in the database.</dd>
  <dt><a class="permalink" href="#list"><code class="Fl" id="list">-list</code></a></dt>
  <dd>Outputs all of the SASL mechanisms available to the password server.</dd>
  <dt><a class="permalink" href="#mergedb"><code class="Fl" id="mergedb">-mergedb</code></a></dt>
  <dd>This command is a low-level command that is invoked by a higher-level tool
      in normal usage. Refer to the restoredb command in the slapconfig man
      page. This command merges a snapshot of the password server database into
      the current database whether or not the daemon is running. This command
      takes existing LDAP users, looks for their data in the specified db file,
      and merges their db information. If there is data in the db without a
      corresponding LDAP user or computer, it is not merged. The identity
      elements of the password server, including RSA keys and replica name, are
      changed to the snapshot's contents.</dd>
  <dt><a class="permalink" href="#mergeparent"><code class="Fl" id="mergeparent">-mergeparent</code></a></dt>
  <dd>This command is a low-level command that is invoked by a higher-level tool
      in normal usage. Refer to the mergedb command in the slapconfig man page.
      This command merges a snapshot of the password server database into the
      current database whether or not the daemon is running. This command takes
      existing LDAP
    <br/>
     users, looks for their data in the specified db file, and merges their db
      information. If there is data in the db without a corresponding LDAP user
      or compute r, it is not merged. The current identity of the password
      server is preserved.</dd>
  <dt><a class="permalink" href="#setadmin"><code class="Fl" id="setadmin">-setadmin</code></a></dt>
  <dd>Promotes a slot-ID to have administrator privileges for the password
      server. By default, administrators set with mkpassdb receive the most
      priveleged rank (0).</dd>
  <dt><a class="permalink" href="#setglobalpolicy"><code class="Fl" id="setglobalpolicy">-setglobalpolicy</code></a></dt>
  <dd>Sets the default policies for all users.</dd>
  <dt><a class="permalink" href="#setkerberos"><code class="Fl" id="setkerberos">-setkerberos</code></a></dt>
  <dd>Assigns a Kerberos realm to a password server account.</dd>
  <dt><a class="permalink" href="#setkeyagent"><code class="Fl" id="setkeyagent">-setkeyagent</code></a></dt>
  <dd>Promotes a slot-ID to have enough administrator privileges to retrieve
      session keys on behalf of other accounts.</dd>
  <dt><a class="permalink" href="#setcomputeraccount"><code class="Fl" id="setcomputeraccount">-setcomputeraccount</code></a></dt>
  <dd>Informs the password server that the account belongs to a computer rather
      than a user. Computer accounts are not subject to policies and do not
      expire. Using the optional &quot;off&quot; argument changes the state back
      to a user account.</dd>
  <dt><a class="permalink" href="#setrealm"><code class="Fl" id="setrealm">-setrealm</code></a></dt>
  <dd>Sets the password server's SASL realm.</dd>
  <dt><a class="permalink" href="#getreplicationinterval"><code class="Fl" id="getreplicationinterval">-getreplicationinterval</code></a></dt>
  <dd>Gets the number of seconds between replication attempts.</dd>
  <dt><a class="permalink" href="#setreplicationinterval"><code class="Fl" id="setreplicationinterval">-setreplicationinterval</code></a></dt>
  <dd>Sets the number of seconds between replication attempts.</dd>
  <dt><a class="permalink" href="#rekeydb"><code class="Fl" id="rekeydb">-rekeydb</code></a></dt>
  <dd>Generates a new RSA public/private key pair for the database. Valid sizes
      are 1024, 2048, or 3072. This command should be invoked by a higher-level
      tool. If run from the command line, existing users will not be able to
      authenticate. The PasswordService daemon must be turned off with,
      &quot;NeST -stoppasswordserver&quot; before this command can be used.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
The following options are available:
<dl class="Bl-tag">
  <dt><a class="permalink" href="#a"><code class="Fl" id="a">-a</code></a></dt>
  <dd>add a new administrator to an existing database.</dd>
  <dt><a class="permalink" href="#b"><code class="Fl" id="b">-b</code></a></dt>
  <dd>add a new non-administrative user to an existing database.</dd>
  <dt><a class="permalink" href="#e"><code class="Fl" id="e">-e</code></a></dt>
  <dd>expand the database to a fixed number of records. If the number is greater
      than the current size of the database, then the database is expanded;
      otherwise, no action is performed. This option is used by other setup
      tools when establishing a replica database. There is no reason to use it
      from the command line.</dd>
  <dt><a class="permalink" href="#m"><code class="Fl" id="m">-m</code></a>
    <var class="Ar">mech</var></dt>
  <dd>establishes a mechanism as weak. If a mechanism is considered weak, then
      it can be used to verify passwords but the password server will not allow
      write operations to its database. The mechanisms SMB-NT, SMB-LAN-MANAGER,
      CRYPT, and APOP are always in the weak list. Directory Services uses DHX
      to perform write operations to the password server.</dd>
  <dt><a class="permalink" href="#n"><code class="Fl" id="n">-n</code></a>
    <var class="Ar">name</var></dt>
  <dd>Assign a name to a replica</dd>
  <dt><a class="permalink" href="#o"><code class="Fl" id="o">-o</code></a></dt>
  <dd>overwrite an existing database. Replacing an existing database is
      extremely destructive and should not be done unless all password server
      users have been removed from the directory system.</dd>
  <dt><a class="permalink" href="#p"><code class="Fl" id="p">-p</code></a></dt>
  <dd>prompt for a password</dd>
  <dt><a class="permalink" href="#q"><code class="Fl" id="q">-q</code></a></dt>
  <dd>quiet</dd>
  <dt><a class="permalink" href="#u"><code class="Fl" id="u">-u</code></a>
    <var class="Ar">user</var></dt>
  <dd>Add this user name to the database.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="USAGE"><a class="permalink" href="#USAGE">USAGE</a></h1>
In typical usage, <code class="Nm">mkpassdb</code> is invoked by another tool.
  It is used directly on rare occasion.
</section>
<section class="Sh">
<h1 class="Sh" id="FILES_&amp;_FOLDERS"><a class="permalink" href="#FILES_&amp;_FOLDERS">FILES
  &amp; FOLDERS</a></h1>
<pre>
/Library/Preferences/com.apple.passwordserver.plist - the PasswordService preferences file
/usr/sbin/PasswordService - the password service daemon
/var/db/authserver/authservermain - password database (guard this)
/var/db/authserver/authserverfree - list of free (reusable) slots in the database
/var/db/authserver/authserverreplicas - table of password server replicas
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr">NeST(8)</a> <a class="Xr">PasswordService(8)</a>
  <a class="Xr">slapconfig(8)</a>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">21 February 2002</td>
    <td class="foot-os">Mac OS X Server</td>
  </tr>
</table>
</body>
</html>
