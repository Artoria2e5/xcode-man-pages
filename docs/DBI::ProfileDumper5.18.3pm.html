<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>DBI::ProfileDumper(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBI::ProfileDumper(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBI::ProfileDumper(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
DBI::ProfileDumper - profile DBI usage and output data to a file
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
To profile an existing program using DBI::ProfileDumper, set the DBI_PROFILE
  environment variable and run your program as usual. For example, using bash:
<p class="Pp"><span class="Li"></span></p>
<pre>
  DBI_PROFILE=2/DBI::ProfileDumper program.pl
</pre>
<p class="Pp">Then analyze the generated file (<i>dbi.prof</i>) with
  dbiprof:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  dbiprof
</pre>
<p class="Pp">You can also activate DBI::ProfileDumper from within your
  code:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  use DBI;

  # profile with default path (2) and output file (dbi.prof)
  $dbh-&gt;{Profile} = &quot;!Statement/DBI::ProfileDumper&quot;;

  # same thing, spelled out
  $dbh-&gt;{Profile} = &quot;!Statement/DBI::ProfileDumper/File:dbi.prof&quot;;

  # another way to say it
  use DBI::ProfileDumper;
  $dbh-&gt;{Profile} = DBI::ProfileDumper-&gt;new(
                        Path =&gt; [ '!Statement' ],
                        File =&gt; 'dbi.prof' );

  # using a custom path
  $dbh-&gt;{Profile} = DBI::ProfileDumper-&gt;new(
      Path =&gt; [ &quot;foo&quot;, &quot;bar&quot; ],
      File =&gt; 'dbi.prof',
  );
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
DBI::ProfileDumper is a subclass of DBI::Profile which dumps profile data to
  disk instead of printing a summary to your screen. You can then use dbiprof to
  analyze the data in a number of interesting ways, or you can roll your own
  analysis using DBI::ProfileData.
<p class="Pp"><b>NOTE:</b> For Apache/mod_perl applications, use
    DBI::ProfileDumper::Apache.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="USAGE"><a class="permalink" href="#USAGE">USAGE</a></h1>
One way to use this module is just to enable it in your
  <span class="Li">$dbh</span>:
<p class="Pp"><span class="Li"></span></p>
<pre>
  $dbh-&gt;{Profile} = &quot;1/DBI::ProfileDumper&quot;;
</pre>
<p class="Pp">This will write out profile data by statement into a file called
    <i>dbi.prof</i>. If you want to modify either of these properties, you can
    construct the DBI::ProfileDumper object yourself:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  use DBI::ProfileDumper;
  $dbh-&gt;{Profile} = DBI::ProfileDumper-&gt;new(
      Path =&gt; [ '!Statement' ],
      File =&gt; 'dbi.prof'
  );
</pre>
<p class="Pp">The <span class="Li">&quot;Path&quot;</span> option takes the same
    values as in DBI::Profile. The <span class="Li">&quot;File&quot;</span>
    option gives the name of the file where results will be collected. If it
    already exists it will be overwritten.</p>
<p class="Pp">You can also activate this module by setting the DBI_PROFILE
    environment variable:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  $ENV{DBI_PROFILE} = &quot;!Statement/DBI::ProfileDumper&quot;;
</pre>
<p class="Pp">This will cause all DBI handles to share the same profiling
    object.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
The following methods are available to be called using the profile object. You
  can get access to the profile object from the Profile key in any DBI handle:
<p class="Pp"><span class="Li"></span></p>
<pre>
  my $profile = $dbh-&gt;{Profile};
</pre>
<section class="Ss">
<h2 class="Ss" id="flush_to_disk"><a class="permalink" href="#flush_to_disk">flush_to_disk</a></h2>
<span class="Li"></span>
<pre>
  $profile-&gt;flush_to_disk()
</pre>
<p class="Pp">Flushes all collected profile data to disk and empties the Data
    hash. Returns the filename written to. If no profile data has been collected
    then the file is not written and <i>flush_to_disk()</i> returns undef.</p>
<p class="Pp">The file is locked while it's being written. A process 'consuming'
    the files while they're being written to, should rename the file first, then
    lock it, then read it, then close and delete it. The
    <span class="Li">&quot;DeleteFiles&quot;</span> option to DBI::ProfileData
    does the right thing.</p>
<p class="Pp">This method may be called multiple times during a program run.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="empty"><a class="permalink" href="#empty">empty</a></h2>
<span class="Li"></span>
<pre>
  $profile-&gt;empty()
</pre>
<p class="Pp">Clears the Data hash without writing to disk.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="filename"><a class="permalink" href="#filename">filename</a></h2>
<span class="Li"></span>
<pre>
  $filename = $profile-&gt;filename();
</pre>
<p class="Pp">Get or set the filename.</p>
<p class="Pp">The filename can be specified as a CODE reference, in which case
    the referenced code should return the filename to be used. The code will be
    called with the profile object as its first argument.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DATA_FORMAT"><a class="permalink" href="#DATA_FORMAT">DATA
  FORMAT</a></h1>
The data format written by DBI::ProfileDumper starts with a header containing
  the version number of the module used to generate it. Then a block of variable
  declarations describes the profile. After two newlines, the profile data forms
  the body of the file. For example:
<p class="Pp"><span class="Li"></span></p>
<pre>
  DBI::ProfileDumper 2.003762
  Path = [ '!Statement', '!MethodName' ]
  Program = t/42profile_data.t

  + 1 SELECT name FROM users WHERE id = ?
  + 2 prepare
  = 1 0.0312958955764771 0.000490069389343262 0.000176072120666504 0.00140702724456787 1023115819.83019 1023115819.86576
  + 2 execute
  1 0.0312958955764771 0.000490069389343262 0.000176072120666504 0.00140702724456787 1023115819.83019 1023115819.86576
  + 2 fetchrow_hashref
  = 1 0.0312958955764771 0.000490069389343262 0.000176072120666504 0.00140702724456787 1023115819.83019 1023115819.86576
  + 1 UPDATE users SET name = ? WHERE id = ?
  + 2 prepare
  = 1 0.0312958955764771 0.000490069389343262 0.000176072120666504 0.00140702724456787 1023115819.83019 1023115819.86576
  + 2 execute
  = 1 0.0312958955764771 0.000490069389343262 0.000176072120666504 0.00140702724456787 1023115819.83019 1023115819.86576
</pre>
<p class="Pp">The lines beginning with <span class="Li">&quot;+&quot;</span>
    signs signify keys. The number after the
    <span class="Li">&quot;+&quot;</span> sign shows the nesting level of the
    key. Lines beginning with <span class="Li">&quot;=&quot;</span> are the
    actual profile data, in the same order as in DBI::Profile.</p>
<p class="Pp">Note that the same path may be present multiple times in the data
    file since <span class="Li">&quot;format()&quot;</span> may be called more
    than once. When read by DBI::ProfileData the data points will be merged to
    produce a single data set for each distinct path.</p>
<p class="Pp">The key strings are transformed in three ways. First, all
    backslashes are doubled. Then all newlines and carriage-returns are
    transformed into <span class="Li">&quot;\n&quot;</span> and
    <span class="Li">&quot;\r&quot;</span> respectively. Finally, any NULL bytes
    (<span class="Li">&quot;\0&quot;</span>) are entirely removed. When
    DBI::ProfileData reads the file the first two transformations will be
    reversed, but NULL bytes will not be restored.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Sam Tregar &lt;sam@tregar.com&gt;
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
Copyright (C) 2002 Sam Tregar
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl 5 itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-06-24</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
