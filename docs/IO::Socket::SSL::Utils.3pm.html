<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>IO::Socket::SSL::Utils(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IO::Socket::SSL::Utils(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">IO::Socket::SSL::Utils(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
IO::Socket::SSL::Utils -- loading, storing, creating certificates and keys
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use IO::Socket::SSL::Utils;
    my $cert = PEM_file2cert('cert.pem');  # load certificate from file
    my $string = PEM_cert2string($cert);   # convert certificate to PEM string
    CERT_free($cert);                      # free memory within OpenSSL

    my $key = KEY_create_rsa(2048);        # create new 2048-bit RSA key
    PEM_string2file($key,&quot;key.pem&quot;);       # and write it to file
    KEY_free($key);                        # free memory within OpenSSL
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This module provides various utility functions to work with certificates and
  private keys, shielding some of the complexity of the underlying Net::SSLeay
  and OpenSSL.
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Functions converting between string or file and certificates and keys.
      They croak if the operation cannot be completed.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>PEM_file2cert(file) -&gt; cert</dt>
  <dd></dd>
  <dt>PEM_cert2file(cert,file)</dt>
  <dd></dd>
  <dt>PEM_string2cert(string) -&gt; cert</dt>
  <dd></dd>
  <dt>PEM_cert2string(cert) -&gt; string</dt>
  <dd></dd>
  <dt>PEM_file2key(file) -&gt; key</dt>
  <dd></dd>
  <dt>PEM_key2file(key,file)</dt>
  <dd></dd>
  <dt>PEM_string2key(string) -&gt; key</dt>
  <dd></dd>
  <dt>PEM_key2string(key) -&gt; string</dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Functions for cleaning up. Each loaded or created cert and key must be
      freed to not leak memory.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>CERT_free(cert)</dt>
  <dd></dd>
  <dt>KEY_free(key)</dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent"></div>
<ul class="Bl-bullet">
  <li>KEY_create_rsa(bits) -&gt; key
    <p class="Pp">Creates an RSA key pair, bits defaults to 2048.</p>
  </li>
  <li>KEY_create_ec(curve) -&gt; key
    <p class="Pp">Creates an EC key, curve defaults to
        <span class="Li">&quot;prime256v1&quot;</span>.</p>
  </li>
  <li>CERT_asHash(cert,[digest_algo]) -&gt; hash
    <p class="Pp">Extracts the information from the certificate into a hash and
        uses the given digest_algo (default: SHA-256) to determine digest of
        pubkey and cert. The resulting hash contains:</p>
  </li>
</ul>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>subject</dt>
  <dd>Hash with the parts of the subject, e.g. commonName, countryName,
      organizationName, stateOrProvinceName, localityName.</dd>
  <dt>subjectAltNames</dt>
  <dd>Array with list of alternative names. Each entry in the list is of
      <span class="Li">&quot;[type,value]&quot;</span>, where
      <span class="Li">&quot;type&quot;</span> can be OTHERNAME, EMAIL, DNS,
      X400, DIRNAME, EDIPARTY, URI, IP or RID.</dd>
  <dt>issuer</dt>
  <dd>Hash with the parts of the issuer, e.g. commonName, countryName,
      organizationName, stateOrProvinceName, localityName.</dd>
  <dt>not_before, not_after</dt>
  <dd>The time frame, where the certificate is valid, as time_t, e.g. can be
      converted with localtime or similar functions.</dd>
  <dt>serial</dt>
  <dd>The serial number</dd>
  <dt>crl_uri</dt>
  <dd>List of URIs for CRL distribution.</dd>
  <dt>ocsp_uri</dt>
  <dd>List of URIs for revocation checking using OCSP.</dd>
  <dt>keyusage</dt>
  <dd>List of keyUsage information in the certificate.</dd>
  <dt>extkeyusage</dt>
  <dd>List of extended key usage information from the certificate. Each entry in
      this list consists of a hash with oid, nid, ln and sn.</dd>
  <dt>pubkey_digest_xxx</dt>
  <dd>Binary digest of the pubkey using the given digest algorithm, e.g.
      pubkey_digest_sha256 if (the default) SHA-256 was used.</dd>
  <dt>x509_digest_xxx</dt>
  <dd>Binary digest of the X.509 certificate using the given digest algorithm,
      e.g. x509_digest_sha256 if (the default) SHA-256 was used.</dd>
  <dt>fingerprint_xxx</dt>
  <dd>Fingerprint of the certificate using the given digest algorithm, e.g.
      fingerprint_sha256 if (the default) SHA-256 was used. Contrary to digest_*
      this is an ASCII string with a list if hexadecimal numbers, e.g.
      &quot;73:59:75:5C:6D...&quot;.</dd>
  <dt>signature_alg</dt>
  <dd>Algorithm used to sign certificate, e.g.
      <span class="Li">&quot;sha256WithRSAEncryption&quot;</span>.</dd>
  <dt>ext</dt>
  <dd>List of extensions. Each entry in the list is a hash with oid, nid, sn,
      critical flag (boolean) and data (string representation given by
      X509V3_EXT_print).</dd>
  <dt>version</dt>
  <dd>Certificate version, usually 2 (x509v3)</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>CERT_create(hash) -&gt; (cert,key)
    <p class="Pp">Creates a certificate based on the given hash. If the issuer
        is not specified the certificate will be self-signed. The following keys
        can be given:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>subject</dt>
  <dd>Hash with the parts of the subject, e.g. commonName, countryName, ... as
      described in <span class="Li">&quot;CERT_asHash&quot;</span>. Default
      points to IO::Socket::SSL.</dd>
  <dt>not_before</dt>
  <dd>A time_t value when the certificate starts to be valid. Defaults to
      current time.</dd>
  <dt>not_after</dt>
  <dd>A time_t value when the certificate ends to be valid. Defaults to current
      time plus one 365 days.</dd>
  <dt>serial</dt>
  <dd>The serial number. If not given a random number will be used.</dd>
  <dt>version</dt>
  <dd>The version of the certificate, default 2 (x509v3).</dd>
  <dt>CA true|false</dt>
  <dd>If true declare certificate as CA, defaults to false.</dd>
  <dt>purpose string|array|hash</dt>
  <dd>Set the purpose of the certificate. The different purposes can be given as
      a string separated by non-word character, as array or hash. With string or
      array each purpose can be prefixed with '+' (enable) or '-' (disable) and
      same can be done with the value when given as a hash. By default enabling
      the purpose is assumed.
    <p class="Pp">If the CA option is given and true the defaults
        &quot;ca,sslca,emailca,objca&quot; are assumed, but can be overridden
        with explicit purpose. If the CA option is given and false the defaults
        &quot;server,client&quot; are assumed. If no CA option and no purpose is
        given it defaults to &quot;server,client&quot;.</p>
    <p class="Pp">Purpose affects basicConstraints, keyUsage, extKeyUsage and
        netscapeCertType. The following purposes are defined (case is not
        important):</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    client
    server
    email
    objsign

    CA
    sslCA
    emailCA
    objCA

    emailProtection
    codeSigning
    timeStamping

    digitalSignature
    nonRepudiation
    keyEncipherment
    dataEncipherment
    keyAgreement
    keyCertSign
    cRLSign
    encipherOnly
    decipherOnly
    </pre>
    <p class="Pp">Examples:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
     # root-CA for SSL certificates
     purpose =&gt; 'sslCA'   # or CA =&gt; 1

     # server certificate and CA (typically self-signed)
     purpose =&gt; 'sslCA,server'

     # client certificate
     purpose =&gt; 'client',
    </pre>
  </dd>
  <dt>ext [{ sn =&gt; .., data =&gt; ... }, ... ]</dt>
  <dd>List of extensions. The type of the extension can be specified as name
      with <span class="Li">&quot;sn&quot;</span> or as NID with
      <span class="Li">&quot;nid&quot;</span> and the data with
      <span class="Li">&quot;data&quot;</span>. These data must be in the same
      syntax as expected within openssl.cnf, e.g. something like
      <span class="Li">&quot;OCSP;URI=http://...&quot;</span>. Additionally the
      critical flag can be set with <span class="Li">&quot;critical
      =&quot;</span> 1&gt;.</dd>
  <dt>key key</dt>
  <dd>use given key as key for certificate, otherwise a new one will be
      generated and returned</dd>
  <dt>issuer_cert cert</dt>
  <dd>set issuer for new certificate</dd>
  <dt>issuer_key key</dt>
  <dd>sign new certificate with given key</dd>
  <dt>issuer [ cert, key ]</dt>
  <dd>Instead of giving issuer_key and issuer_cert as separate arguments they
      can be given both together.</dd>
  <dt>digest algorithm</dt>
  <dd>specify the algorithm used to sign the certificate, default SHA-256.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Steffen Ullrich
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-02-14</td>
    <td class="foot-os">perl v5.28.2</td>
  </tr>
</table>
</body>
</html>
