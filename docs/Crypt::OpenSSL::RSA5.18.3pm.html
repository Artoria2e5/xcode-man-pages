<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>RSA(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">RSA(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">RSA(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Crypt::OpenSSL::RSA - RSA encoding and decoding, using the openSSL libraries
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
  use Crypt::OpenSSL::Random;
  use Crypt::OpenSSL::RSA;

  # not necessary if we have /dev/random:
  Crypt::OpenSSL::Random::random_seed($good_entropy);
  Crypt::OpenSSL::RSA-&gt;import_random_seed();
  $rsa_pub = Crypt::OpenSSL::RSA-&gt;new_public_key($key_string);
  $rsa_pub-&gt;use_sslv23_padding(); # use_pkcs1_oaep_padding is the default
  $ciphertext = $rsa-&gt;encrypt($plaintext);

  $rsa_priv = Crypt::OpenSSL::RSA-&gt;new_private_key($key_string);
  $plaintext = $rsa-&gt;encrypt($ciphertext);

  $rsa = Crypt::OpenSSL::RSA-&gt;generate_key(1024); # or
  $rsa = Crypt::OpenSSL::RSA-&gt;generate_key(1024, $prime);

  print &quot;private key is:\n&quot;, $rsa-&gt;get_private_key_string();
  print &quot;public key (in PKCS1 format) is:\n&quot;,
        $rsa-&gt;get_public_key_string();
  print &quot;public key (in X509 format) is:\n&quot;,
        $rsa-&gt;get_public_key_x509_string();

  $rsa_priv-&gt;use_md5_hash(); # use_sha1_hash is the default
  $signature = $rsa_priv-&gt;sign($plaintext);
  print &quot;Signed correctly\n&quot; if ($rsa-&gt;verify($plaintext, $signature));
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Crypt::OpenSSL::RSA provides the ability to RSA encrypt strings which are
  somewhat shorter than the block size of a key. It also allows for decryption,
  signatures and signature verification.
<p class="Pp"><i>NOTE</i>: Many of the methods in this package can croak, so use
    eval, or Error.pm's try/catch mechanism to capture errors. Also, while some
    methods from earlier versions of this package return true on success, this
    (never documented) behavior is no longer the case.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Class_Methods"><a class="permalink" href="#Class_Methods">Class
  Methods</a></h1>
<dl class="Bl-tag">
  <dt>new_public_key</dt>
  <dd>Create a new Crypt::OpenSSL::RSA object by loading a public key in from a
      string containing Base64/DER-encoding of either the PKCS1 or X.509
      representation of the key. The string should include the
      -----BEGIN...----- and -----END...----- lines.
    <p class="Pp">The padding is set to PKCS1_OAEP, but can be changed with the
        use_xxx_padding methods</p>
  </dd>
  <dt>new_private_key</dt>
  <dd>Create a new Crypt::OpenSSL::RSA object by loading a private key in from
      an string containing the Base64/DER encoding of the PKCS1 representation
      of the key. The string should include the -----BEGIN...----- and
      -----END...----- lines. The padding is set to PKCS1_OAEP, but can be
      changed with use_xxx_padding.</dd>
  <dt>generate_key</dt>
  <dd>Create a new Crypt::OpenSSL::RSA object by constructing a private/public
      key pair. The first (mandetory) argument is the key size, while the second
      optional argument specifies the public exponent (the default public
      exponent is 65537). The padding is set to PKCS1_OAEP, but can be changed
      with use_xxx_padding methods.</dd>
  <dt>new_key_from_parameters</dt>
  <dd>Given Crypt::OpenSSL::Bignum objects for n, e, and optionally d, p, and q,
      where p and q are the prime factors of n, e is the public exponent and d
      is the private exponent, create a new Crypt::OpenSSL::RSA object using
      these values. If p and q are provided and d is undef, d is computed. Note
      that while p and q are not necessary for a private key, their presence
      will speed up computation.</dd>
  <dt>import_random_seed</dt>
  <dd>Import a random seed from Crypt::OpenSSL::Random, since the OpenSSL
      libraries won't allow sharing of random structures across perl XS
    modules.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="Instance_Methods"><a class="permalink" href="#Instance_Methods">Instance
  Methods</a></h1>
<dl class="Bl-tag">
  <dt>DESTROY</dt>
  <dd>Clean up after ourselves. In particular, erase and free the memory
      occupied by the RSA key structure.</dd>
  <dt>get_public_key_string</dt>
  <dd>Return the Base64/DER-encoded PKCS1 representation of the public key. This
      string has header and footer lines:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  -----BEGIN RSA PUBLIC KEY------
  -----END RSA PUBLIC KEY------
    </pre>
  </dd>
  <dt>get_public_key_x509_string</dt>
  <dd>Return the Base64/DER-encoded representation of the &quot;subject public
      key&quot;, suitable for use in X509 certificates. This string has header
      and footer lines:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  -----BEGIN PUBLIC KEY------
  -----END PUBLIC KEY------
    </pre>
    <p class="Pp">and is the format that is produced by running
        <span class="Li">&quot;openssl rsa -pubout&quot;</span>.</p>
  </dd>
  <dt>get_private_key_string</dt>
  <dd>Return the DER-encoded PKCS1 representation of the private key.</dd>
  <dt>encrypt</dt>
  <dd>Encrypt a binary &quot;string&quot; using the public (portion of the)
    key.</dd>
  <dt>decrypt</dt>
  <dd>Decrypt a binary &quot;string&quot;. Croaks if the key is public
    only.</dd>
  <dt>private_encrypt</dt>
  <dd>Encrypt a binary &quot;string&quot; using the private key. Croaks if the
      key is public only.</dd>
  <dt>public_decrypt</dt>
  <dd>Decrypt a binary &quot;string&quot; using the public (portion of the)
    key.</dd>
  <dt>sign</dt>
  <dd>Sign a string using the secret (portion of the) key.</dd>
  <dt>verify</dt>
  <dd>Check the signature on a text.</dd>
  <dt>use_no_padding</dt>
  <dd>Use raw RSA encryption. This mode should only be used to implement
      cryptographically sound padding modes in the application code. Encrypting
      user data directly with RSA is insecure.</dd>
  <dt>use_pkcs1_padding</dt>
  <dd>Use PKCS #1 v1.5 padding. This currently is the most widely used mode of
      padding.</dd>
  <dt>use_pkcs1_oaep_padding</dt>
  <dd>Use EME-OAEP padding as defined in PKCS #1 v2.0 with SHA-1, MGF1 and an
      empty encoding parameter. This mode of padding is recommended for all new
      applications. It is the default mode used by Crypt::OpenSSL::RSA.</dd>
  <dt>use_sslv23_padding</dt>
  <dd>Use PKCS #1 v1.5 padding with an SSL-specific modification that denotes
      that the server is SSL3 capable.</dd>
  <dt>use_md5_hash</dt>
  <dd>Use the RFC 1321 MD5 hashing algorithm by Ron Rivest when signing and
      verifying messages.</dd>
  <dt>use_sha1_hash</dt>
  <dd>Use the RFC 3174 Secure Hashing Algorithm (FIPS 180-1) when signing and
      verifying messages. This is the default.</dd>
  <dt>use_sha224_hash, use_sha256_hash, use_sha384_hash, use_sha512_hash</dt>
  <dd>These FIPS 180-2 hash algorithms, for use when signing and verifying
      messages, are only available with newer openssl versions (&gt;=
    0.9.8).</dd>
  <dt>use_ripemd160_hash</dt>
  <dd>Dobbertin, Bosselaers and Preneel's RIPEMD hashing algorithm when signing
      and verifying messages.</dd>
  <dt>size</dt>
  <dd>Returns the size, in bytes, of the key. All encrypted text will be of this
      size, and depending on the padding mode used, the length of the text to be
      encrypted should be:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>pkcs1_oaep_padding</dt>
  <dd>at most 42 bytes less than this size.</dd>
  <dt>pkcs1_padding or sslv23_padding</dt>
  <dd>at most 11 bytes less than this size.</dd>
  <dt>no_padding</dt>
  <dd>exactly this size.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>check_key</dt>
  <dd>This function validates the RSA key, returning a true value if the key is
      valid, and a false value otherwise. Croaks if the key is public only.</dd>
  <dt>get_key_parameters</dt>
  <dd>Return Crypt::OpenSSL::Bignum objects representing the values of n, e, d,
      p, q, d mod (p-1), d mod (q-1), and 1/q mod p, where p and q are the prime
      factors of n, e is the public exponent and d is the private exponent. Some
      of these values may return as undef; only n and e will be defined for a
      public key. The Crypt::OpenSSL::Bignum module must be installed for this
      to work.</dd>
  <dt>is_private</dt>
  <dd>Return true if this is a private key, and false if it is private
    only.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
There is a small memory leak when generating new keys of more than 512 bits.
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Ian Robertson, iroberts@cpan.org. For support, please email
  perl-openssl-users@lists.sourceforge.net.
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>perl</i>(1), <i>Crypt::OpenSSL::Random</i>(3),
  <i>Crypt::OpenSSL::Bignum</i>(3), <i>rsa</i>(3), <i>RSA_new</i>(3),
  <i>RSA_public_encrypt</i>(3), <i>RSA_size</i>(3), <i>RSA_generate_key</i>(3),
  <i>RSA_check_key</i>(3)
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2011-08-24</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
